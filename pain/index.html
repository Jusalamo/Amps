<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <title>Amps | Amplify Your Connections at Live Events</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Chart.js for Analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" id="manifest">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Amps">
    
    <style>
        /* ===== BASE STYLES ===== */
        :root {
            /* Colors */
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-tertiary: #161616;
            --bg-card: rgba(30, 30, 30, 0.7);
            --bg-glass: rgba(255, 255, 255, 0.05);
            
            /* Primary Colors */
            --purple-primary: #8B5CF6;
            --purple-light: #A78BFA;
            --purple-dark: #7C3AED;
            
            /* Accent Colors */
            --pink: #EC4899;
            --orange: #F97316;
            --blue: #3B82F6;
            --green: #10B981;
            --yellow: #F59E0B;
            --red: #EF4444;
            --gold: #F5DEB3;
            
            /* Gradients */
            --gradient-pro: linear-gradient(135deg, #8B5CF6, #EC4899, #F59E0B);
            --gradient-pro-plus: linear-gradient(135deg, #F59E0B, #8B5CF6, #EC4899);
            --gradient-purple: linear-gradient(135deg, #8B5CF6, #7C3AED);
            --gradient-hero: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(236, 72, 153, 0.05));
            
            /* Text Colors */
            --white: #FFFFFF;
            --gray-light: #9CA3AF;
            --gray-medium: #6B7280;
            --gray-dark: #1F2937;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.5);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.6), 0 10px 10px -5px rgba(0, 0, 0, 0.4);
            --shadow-glow: 0 0 30px rgba(139, 92, 246, 0.4);
            --shadow-card-stack: 0 20px 60px rgba(0, 0, 0, 0.4), 0 8px 24px rgba(0, 0, 0, 0.3);
            --shadow-gold: 0 8px 24px rgba(245, 222, 179, 0.3);
            
            /* Border Radius */
            --radius-sm: 8px;
            --radius: 12px;
            --radius-md: 16px;
            --radius-lg: 20px;
            --radius-xl: 24px;
            --radius-2xl: 32px;
            --radius-full: 9999px;
            
            /* Notched Corners */
            --notch-tl: 32px 32px 8px 8px;
            --notch-tr: 8px 32px 32px 8px;
            --notch-bl: 8px 8px 32px 32px;
            --notch-br: 32px 8px 8px 32px;
            
            /* Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Spacing */
            --space-xs: 0.5rem;
            --space-sm: 1rem;
            --space-md: 1.5rem;
            --space-lg: 2rem;
            --space-xl: 3rem;
            
            /* Layout */
            --header-height: 64px;
            --bottom-nav-height: 65px;
            --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--white);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
            min-height: 100vh;
            padding-bottom: calc(var(--bottom-nav-height) + var(--safe-area-inset-bottom));
        }
        
        .app {
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--bg-primary);
            position: relative;
            overflow: hidden;
        }
        
        /* ===== TYPOGRAPHY ===== */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
        }
        
        h1 { font-size: 2.5rem; }
        h2 { font-size: 2rem; }
        h3 { font-size: 1.5rem; }
        h4 { font-size: 1.25rem; }
        
        .text-gradient {
            background: var(--gradient-purple);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .pro-gradient {
            background: var(--gradient-pro);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .pro-plus-gradient {
            background: var(--gradient-pro-plus);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .text-muted {
            color: var(--gray-light);
        }
        
        .text-center { text-align: center; }
        
        /* ===== BUTTONS ===== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-xs);
            padding: var(--space-sm) var(--space-lg);
            border-radius: var(--radius-full);
            font-weight: 600;
            font-size: 0.875rem;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all var(--transition);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .btn-primary {
            background: var(--purple-primary);
            color: var(--white);
            box-shadow: var(--shadow-glow);
        }
        
        .btn-primary:hover {
            background: var(--purple-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow), 0 8px 25px rgba(139, 92, 246, 0.3);
        }
        
        .btn-pro {
            background: var(--gradient-pro);
            color: var(--white);
            background-size: 200% 200%;
            animation: gradientMove 3s ease infinite;
            box-shadow: 0 0 30px rgba(236, 72, 153, 0.3);
        }
        
        .btn-pro:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 40px rgba(236, 72, 153, 0.4);
        }
        
        .btn-pro-plus {
            background: var(--gradient-pro-plus);
            color: var(--white);
            box-shadow: 0 0 30px rgba(245, 158, 11, 0.3);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--white);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--purple-primary);
            transform: translateY(-2px);
        }
        
        .btn-glass {
            background: var(--bg-glass);
            color: var(--white);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
        }
        
        .btn-glass:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .btn-large {
            padding: var(--space-md) var(--space-xl);
            font-size: 1rem;
        }
        
        .btn-small {
            padding: var(--space-xs) var(--space-md);
            font-size: 0.75rem;
        }
        
        .btn-block {
            width: 100%;
        }
        
        .btn-icon {
            width: 48px;
            height: 48px;
            padding: 0;
            border-radius: var(--radius-full);
            font-size: 1.25rem;
        }
        
        /* ===== NAVIGATION ===== */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            height: var(--header-height);
            background: rgba(0, 0, 0, 0.9);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--space-md);
            backdrop-filter: blur(20px);
            max-width: 480px;
            margin: 0 auto;
        }
        
        .nav-brand {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            font-size: 1.5rem;
            font-weight: 800;
            cursor: pointer;
            text-decoration: none;
            color: var(--white);
        }
        
        .nav-brand span {
            background: var(--gradient-pro);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .nav-actions {
            display: flex;
            gap: var(--space-xs);
            align-items: center;
        }
        
        .back-btn {
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.25rem;
            cursor: pointer;
            padding: var(--space-xs);
            border-radius: var(--radius-full);
            transition: background var(--transition-fast);
        }
        
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* ===== BOTTOM NAVIGATION ===== */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: calc(var(--bottom-nav-height) + var(--safe-area-inset-bottom));
            background: rgba(0, 0, 0, 0.98);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding-bottom: var(--safe-area-inset-bottom);
            z-index: 999;
            max-width: 480px;
            margin: 0 auto;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            padding: var(--space-xs);
            background: none;
            border: none;
            color: var(--gray-light);
            font-size: 0.75rem;
            transition: all var(--transition-fast);
            flex: 1;
            height: 100%;
        }
        
        .nav-item.active {
            color: var(--purple-primary);
        }
        
        .nav-item i {
            font-size: 1.25rem;
        }
        
        /* ===== CONTENT CONTAINER ===== */
        .content {
            padding: calc(var(--header-height) + var(--space-md)) var(--space-md) var(--space-md);
            min-height: 100vh;
        }
        
        /* ===== HERO BACKGROUND ===== */
        .hero-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100vh;
            background: var(--gradient-hero);
            overflow: hidden;
            z-index: 0;
        }
        
        .hero-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(236, 72, 153, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            animation: gradientMove 15s ease infinite;
        }
        
        /* ===== BADGES ===== */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 600;
            gap: 4px;
        }
        
        .pro-badge {
            background: var(--gradient-pro);
            color: var(--white);
        }
        
        .pro-plus-badge {
            background: var(--gradient-pro-plus);
            color: var(--white);
        }
        
        .free-badge {
            background: var(--bg-tertiary);
            color: var(--gray-light);
        }
        
        .live-badge {
            background: var(--green);
            color: var(--white);
            animation: pulse 2s infinite;
        }
        
        /* ===== CARDS ===== */
        .card {
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-2xl);
            padding: var(--space-lg);
            backdrop-filter: blur(20px);
            transition: all var(--transition);
        }
        
        .card:hover {
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-glass {
            background: var(--bg-glass);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-2xl);
            padding: var(--space-lg);
            backdrop-filter: blur(20px);
        }
        
        /* ===== LANDING PAGE ===== */
        .hero-section {
            position: relative;
            z-index: 1;
            text-align: center;
            padding: var(--space-xl) 0;
        }
        
        .hero-title {
            font-size: 3rem;
            margin-bottom: var(--space-md);
            background: linear-gradient(135deg, var(--white) 30%, var(--purple-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero-subtitle {
            font-size: 1.25rem;
            color: var(--gray-light);
            margin-bottom: var(--space-xl);
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .hero-cta {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
            max-width: 300px;
            margin: 0 auto;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin: var(--space-xl) 0;
        }
        
        .feature {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-2xl);
            padding: var(--space-lg);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all var(--transition);
        }
        
        .feature:hover {
            border-color: var(--purple-primary);
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow);
        }
        
        .feature-icon {
            width: 56px;
            height: 56px;
            background: rgba(139, 92, 246, 0.2);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-md);
            font-size: 1.5rem;
            color: var(--purple-light);
        }
        
        /* ===== DASHBOARD ===== */
        .dashboard-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-lg);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }
        
        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--purple-primary), var(--pink));
            position: relative;
            overflow: hidden;
            background-size: cover;
            background-position: center;
        }
        
        .user-avatar.pro {
            border: 3px solid transparent;
            border-image: var(--gradient-pro) 1;
        }
        
        .user-avatar.pro-plus {
            border: 3px solid transparent;
            border-image: var(--gradient-pro-plus) 1;
        }
        
        .user-details h2 {
            font-size: 1.25rem;
            margin-bottom: 4px;
        }
        
        .user-details p {
            color: var(--gray-light);
            font-size: 0.875rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
        }
        
        .stat-card {
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--gray-light);
        }
        
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin: var(--space-lg) 0;
        }
        
        .action-card {
            background: var(--bg-card);
            border-radius: var(--radius-2xl);
            padding: var(--space-md);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all var(--transition);
        }
        
        .action-card:hover {
            border-color: var(--purple-primary);
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow);
        }
        
        .action-card i {
            font-size: 2rem;
            margin-bottom: var(--space-sm);
        }
        
        .action-card.primary i { color: var(--purple-primary); }
        .action-card.blue i { color: var(--blue); }
        .action-card.pink i { color: var(--pink); }
        .action-card.gold i { color: var(--gold); }
        
        .active-events {
            margin-bottom: var(--space-xl);
        }
        
        .event-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }
        
        .event-item {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
        }
        
        .event-item-icon {
            width: 50px;
            height: 50px;
            border-radius: var(--radius-md);
            background: linear-gradient(135deg, var(--purple-primary), var(--pink));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .event-item-content {
            flex: 1;
        }
        
        .event-item-title {
            font-size: 1rem;
            margin-bottom: 4px;
        }
        
        .event-item-meta {
            font-size: 0.875rem;
            color: var(--gray-light);
            margin-bottom: var(--space-xs);
        }
        
        .progress-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin-top: var(--space-xs);
        }
        
        .progress-fill {
            height: 100%;
            background: var(--purple-primary);
            border-radius: 2px;
            transition: width 0.3s ease;
        }
        
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-md);
        }
        
        .achievement-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .achievement-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(139, 92, 246, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-sm);
            font-size: 1.5rem;
            color: var(--purple-primary);
        }
        
        /* ===== EVENTS PAGE ===== */
        .events-grid {
            display: grid;
            gap: var(--space-md);
            margin: var(--space-lg) 0;
        }
        
        .event-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--notch-tl);
            padding: var(--space-md);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all var(--transition);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }
        
        .event-card:hover {
            border-color: var(--purple-primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }
        
        .event-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 60px;
            height: 60px;
            background: var(--purple-primary);
            border-radius: 0 0 32px 0;
            opacity: 0.1;
        }
        
        .event-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-md);
        }
        
        .event-card-header h3 {
            margin-bottom: var(--space-xs);
        }
        
        .event-info {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            color: var(--gray-light);
            font-size: 0.875rem;
            margin: var(--space-xs) 0;
        }
        
        .event-info i {
            margin-right: 4px;
        }
        
        .bookmark-button {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.6);
            border: none;
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.25rem;
            transition: all var(--transition);
            z-index: 2;
        }
        
        .bookmark-button.active {
            color: var(--yellow);
        }
        
        .bookmark-button:hover {
            background: rgba(0, 0, 0, 0.8);
            transform: scale(1.1);
        }
        
        .event-tags {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-xs);
            margin-top: var(--space-md);
        }
        
        .event-tag {
            background: rgba(139, 92, 246, 0.1);
            color: var(--purple-light);
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .filters-bar {
            display: flex;
            gap: var(--space-sm);
            overflow-x: auto;
            padding: var(--space-md) 0;
            margin-bottom: var(--space-lg);
            -webkit-overflow-scrolling: touch;
        }
        
        .filter-btn {
            padding: var(--space-xs) var(--space-md);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-full);
            color: var(--white);
            font-size: 0.875rem;
            cursor: pointer;
            transition: all var(--transition);
            white-space: nowrap;
        }
        
        .filter-btn.active {
            background: var(--purple-primary);
            border-color: var(--purple-primary);
        }
        
        .filter-btn:hover:not(.active) {
            border-color: var(--purple-primary);
        }
        
        /* ===== SWIPE INTERFACE ===== */
        .swipe-container {
            height: calc(100vh - 160px);
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        .swipe-header {
            text-align: center;
            padding: var(--space-md);
            background: rgba(0, 0, 0, 0.9);
            z-index: 100;
        }
        
        .event-badge {
            display: inline-block;
            background: rgba(139, 92, 246, 0.2);
            color: var(--purple-light);
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: var(--space-sm);
        }
        
        .card-stack {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            padding: var(--space-md);
        }
        
        .card-container {
            width: 100%;
            max-width: 280px;
            aspect-ratio: 3/4;
            position: relative;
        }
        
        .profile-card {
            position: absolute;
            width: 100%;
            height: 100%;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s;
            cursor: grab;
            z-index: 1;
            border-radius: var(--radius-xl);
            overflow: hidden;
        }
        
        .profile-card:active {
            cursor: grabbing;
        }
        
        .card-content {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-card-stack);
        }
        
        .card-frame {
            position: absolute;
            width: 110%;
            height: 110%;
            top: -8%;
            left: -5%;
            background: var(--gold);
            border-radius: var(--radius-xl);
            transform: rotate(-3deg);
            z-index: -1;
            box-shadow: var(--shadow-gold);
        }
        
        .profile-image {
            width: 85%;
            aspect-ratio: 1/1;
            margin: var(--space-lg) auto 0;
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .profile-info {
            padding: var(--space-md) var(--space-lg);
            text-align: center;
        }
        
        .profile-info h2 {
            font-size: 1.5rem;
            margin-bottom: 4px;
            color: var(--gray-dark);
            font-weight: 700;
        }
        
        .profile-info p {
            font-size: 0.875rem;
            color: var(--gray-medium);
            margin-bottom: var(--space-md);
            line-height: 1.5;
        }
        
        .interests {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-xs);
            justify-content: center;
            margin-bottom: var(--space-md);
        }
        
        .interest-tag {
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 12px;
            background: rgba(28, 28, 30, 0.08);
            color: var(--gray-medium);
            font-weight: 600;
        }
        
        .swipe-overlay {
            position: absolute;
            top: 50px;
            right: -40px;
            width: 120px;
            height: 50px;
            border: 4px solid var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.5rem;
            border-radius: var(--radius-sm);
            z-index: 100;
            transform: rotate(12deg);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .swipe-overlay.like {
            background: var(--green);
            left: -40px;
            right: auto;
            transform: rotate(-12deg);
        }
        
        .swipe-overlay.nope {
            background: var(--red);
            transform: rotate(12deg);
        }
        
        .swipe-overlay.super {
            background: var(--blue);
            top: 80px;
            transform: rotate(0deg);
        }
        
        .swipe-actions {
            padding: var(--space-lg);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-md);
            background: rgba(0, 0, 0, 0.9);
            z-index: 50;
        }
        
        .action-button {
            width: 72px;
            height: 72px;
            border-radius: var(--radius-full);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.2s;
            background: var(--gray-dark);
            color: var(--white);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }
        
        .action-button:hover {
            transform: scale(1.05);
        }
        
        .action-button:active {
            transform: scale(0.95);
        }
        
        .action-button.undo {
            width: 64px;
            height: 64px;
            font-size: 1.25rem;
            background: var(--gray-medium);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
        }
        
        .action-button.like {
            width: 80px;
            height: 80px;
            background: var(--pink);
            color: var(--white);
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(236, 72, 153, 0.5);
        }
        
        .action-button.like:hover {
            transform: scale(1.1);
        }
        
        /* ===== CHAT ===== */
        .chat-container {
            height: calc(100vh - var(--header-height) - var(--bottom-nav-height));
            display: flex;
            flex-direction: column;
        }
        
        .chat-header {
            padding: var(--space-md);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            background: var(--bg-secondary);
        }
        
        .chat-avatar {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--purple-primary), var(--purple-light));
            background-size: cover;
            background-position: center;
        }
        
        .chat-messages {
            flex: 1;
            padding: var(--space-md);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }
        
        .message {
            max-width: 70%;
            padding: var(--space-sm) var(--space-md);
            border-radius: 18px;
            position: relative;
            animation: messageAppear 0.3s ease;
        }
        
        .message.sent {
            background: var(--purple-primary);
            color: var(--white);
            align-self: flex-end;
            border-bottom-right-radius: 4px;
            border-radius: 18px 18px 4px 18px;
        }
        
        .message.received {
            background: var(--bg-tertiary);
            color: var(--white);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
            border-radius: 18px 18px 18px 4px;
        }
        
        .message-time {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 4px;
            text-align: right;
        }
        
        .chat-input {
            padding: var(--space-md);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            gap: var(--space-sm);
            background: var(--bg-secondary);
        }
        
        /* ===== MATCHES PAGE ===== */
        .attendee-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            margin-top: var(--space-md);
        }
        
        .attendee-item {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-md);
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
        }
        
        .attendee-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-size: cover;
            background-position: center;
            border: 2px solid var(--purple-primary);
        }
        
        .attendee-info {
            flex: 1;
        }
        
        .attendee-status {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.75rem;
        }
        
        .status-online {
            color: var(--green);
        }
        
        .status-away {
            color: var(--yellow);
        }
        
        /* ===== PROFILE PAGE ===== */
        .profile-header {
            text-align: center;
            margin-bottom: var(--space-lg);
        }
        
        .profile-header .user-avatar {
            width: 100px;
            height: 100px;
            margin: 0 auto var(--space-md);
        }
        
        /* ===== AUTH PAGE ===== */
        .auth-container {
            max-width: 400px;
            margin: 0 auto;
            padding: var(--space-xl) 0;
        }
        
        .auth-tabs {
            display: flex;
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            padding: 4px;
            margin-bottom: var(--space-lg);
        }
        
        .auth-tab {
            flex: 1;
            padding: var(--space-sm);
            text-align: center;
            background: none;
            border: none;
            color: var(--gray-light);
            font-weight: 600;
            cursor: pointer;
            border-radius: var(--radius-sm);
            transition: all var(--transition-fast);
        }
        
        .auth-tab.active {
            background: var(--purple-primary);
            color: var(--white);
        }
        
        .form-group {
            margin-bottom: var(--space-lg);
        }
        
        .form-label {
            display: block;
            margin-bottom: var(--space-xs);
            color: var(--gray-light);
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: var(--space-md);
            background: var(--bg-tertiary);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-xl);
            color: var(--white);
            font-size: 1rem;
            transition: all var(--transition-fast);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--purple-primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }
        
        /* ===== ONBOARDING ===== */
        .onboarding-steps {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-xl);
        }
        
        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-xs);
        }
        
        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            transition: all var(--transition);
        }
        
        .step-circle.active {
            background: var(--purple-primary);
            color: var(--white);
        }
        
        .step-circle.completed {
            background: var(--green);
            color: var(--white);
        }
        
        .step-circle.inactive {
            background: rgba(255, 255, 255, 0.1);
            color: var(--gray-light);
        }
        
        .step-label {
            font-size: 0.75rem;
            color: var(--gray-light);
        }
        
        /* ===== SCANNER ===== */
        .scanner-container {
            text-align: center;
            padding: var(--space-md) 0;
        }
        
        .qr-scanner {
            width: 100%;
            height: 300px;
            background: var(--bg-secondary);
            border-radius: var(--radius-2xl);
            margin: var(--space-lg) 0;
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .scanner-overlay {
            position: absolute;
            inset: 20px;
            border: 2px solid var(--purple-primary);
            border-radius: var(--radius);
            animation: pulse 2s infinite;
        }
        
        .scanner-line {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            height: 2px;
            background: var(--purple-primary);
            box-shadow: 0 0 10px var(--purple-primary);
            animation: scan 3s infinite linear;
        }
        
        /* ===== CAMERA MODAL ===== */
        .camera-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
        }
        
        .camera-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            background: #000;
        }
        
        .camera-preview {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        .camera-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .camera-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 250px;
            height: 250px;
            border: 3px solid var(--white);
            border-radius: var(--radius-lg);
            box-shadow: 0 0 0 1000px rgba(0, 0, 0, 0.7);
        }
        
        .camera-controls {
            padding: var(--space-md);
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
        }
        
        .camera-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: var(--white);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--black);
        }
        
        /* ===== MODALS ===== */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: var(--space-md);
        }
        
        .modal-content {
            background: rgba(30, 30, 30, 0.95);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            max-width: 400px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 0.3s ease;
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: var(--space-lg);
        }
        
        .modal-close {
            position: absolute;
            top: var(--space-md);
            right: var(--space-md);
            background: none;
            border: none;
            color: var(--gray-light);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .match-modal .modal-content {
            text-align: center;
        }
        
        .match-images {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }
        
        .match-avatar {
            width: 96px;
            height: 96px;
            border-radius: var(--radius-full);
            border: 4px solid var(--purple-primary);
            box-shadow: var(--shadow-lg);
            background-size: cover;
            background-position: center;
        }
        
        /* ===== PRICING CARDS ===== */
        .pricing-grid {
            display: grid;
            gap: var(--space-md);
            margin: var(--space-xl) 0;
        }
        
        .pricing-card {
            background: var(--bg-card);
            border-radius: var(--radius-2xl);
            padding: var(--space-xl) var(--space-lg);
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
            transition: all var(--transition);
        }
        
        .pricing-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        
        .pricing-card.featured {
            border: 2px solid var(--purple-primary);
            transform: scale(1.05);
            box-shadow: var(--shadow-glow);
        }
        
        .pricing-card.featured:hover {
            transform: scale(1.05) translateY(-4px);
        }
        
        .pricing-badge {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            padding: 6px 20px;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
        }
        
        /* ===== TOAST NOTIFICATIONS ===== */
        .toast-container {
            position: fixed;
            top: 80px;
            right: var(--space-md);
            z-index: 3000;
            max-width: 480px;
            margin: 0 auto;
            left: var(--space-md);
            right: var(--space-md);
        }
        
        .toast {
            background: rgba(30, 30, 30, 0.95);
            border-left: 4px solid var(--purple-primary);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-sm);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            animation: slideIn 0.3s ease;
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(10px);
        }
        
        .toast.success {
            border-left-color: var(--green);
        }
        
        .toast.error {
            border-left-color: var(--red);
        }
        
        .toast.warning {
            border-left-color: var(--yellow);
        }
        
        .toast.info {
            border-left-color: var(--blue);
        }
        
        .toast-icon {
            font-size: 1.25rem;
        }
        
        .toast.success .toast-icon { color: var(--green); }
        .toast.error .toast-icon { color: var(--red); }
        .toast.warning .toast-icon { color: var(--yellow); }
        .toast.info .toast-icon { color: var(--blue); }
        
        .toast-content {
            flex: 1;
        }
        
        .toast-title {
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .toast-message {
            font-size: 0.75rem;
            color: var(--gray-light);
        }
        
        .toast-close {
            background: none;
            border: none;
            color: var(--gray-light);
            cursor: pointer;
        }
        
        /* ===== EVENT CREATION ===== */
        .create-form {
            max-width: 400px;
            margin: 0 auto;
        }
        
        .qr-code-display {
            width: 200px;
            height: 200px;
            background: var(--white);
            border-radius: var(--radius);
            margin: var(--space-lg) auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            color: var(--bg-primary);
            font-weight: bold;
            text-align: center;
            padding: var(--space-md);
        }
        
        /* ===== EVENT DETAIL ===== */
        .event-detail-header {
            position: relative;
            height: 200px;
            background: linear-gradient(135deg, var(--purple-primary), var(--pink));
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-md);
            overflow: hidden;
        }
        
        .event-detail-content {
            padding: var(--space-md);
        }
        
        .rsvp-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-sm);
            margin-top: var(--space-md);
        }
        
        .rsvp-button {
            padding: var(--space-sm);
            border-radius: var(--radius-lg);
            background: var(--bg-tertiary);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--white);
            cursor: pointer;
            transition: all var(--transition);
            text-align: center;
        }
        
        .rsvp-button.active {
            background: var(--purple-primary);
            border-color: var(--purple-primary);
        }
        
        .rsvp-button:hover:not(.active) {
            border-color: var(--purple-primary);
        }
        
        /* ===== GEO-FENCING ===== */
        .geo-fencing-badge {
            background: rgba(59, 130, 246, 0.2);
            color: var(--blue);
            border: 1px solid rgba(59, 130, 246, 0.3);
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        /* ===== SAFETY OPTIONS ===== */
        .safety-options {
            display: flex;
            gap: var(--space-sm);
            margin-top: var(--space-sm);
        }
        
        .safety-btn {
            flex: 1;
            padding: var(--space-xs) var(--space-md);
            border-radius: var(--radius);
            background: var(--bg-tertiary);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--white);
            font-size: 0.75rem;
            cursor: pointer;
            transition: all var(--transition);
        }
        
        .safety-btn:hover {
            border-color: var(--red);
            color: var(--red);
        }
        
        /* ===== ANALYTICS ===== */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-sm);
            margin: var(--space-md) 0;
        }
        
        .analytics-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            text-align: center;
        }
        
        .analytics-value {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .analytics-label {
            font-size: 0.75rem;
            color: var(--gray-light);
        }
        
        .analytics-chart {
            width: 100%;
            height: 200px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            margin: var(--space-md) 0;
            display: flex;
            align-items: flex-end;
            padding: var(--space-md);
            gap: 4px;
        }
        
        .chart-bar {
            flex: 1;
            background: var(--purple-primary);
            border-radius: 4px 4px 0 0;
            min-height: 20px;
            transition: height 0.3s ease;
        }
        
        /* ===== PAGINATION ===== */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-xs);
            margin-top: var(--space-lg);
            padding: var(--space-md) 0;
        }
        
        .page-button {
            width: 40px;
            height: 40px;
            border-radius: var(--radius);
            background: var(--bg-tertiary);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition);
        }
        
        .page-button.active {
            background: var(--purple-primary);
            border-color: var(--purple-primary);
        }
        
        .page-button:hover:not(.active) {
            border-color: var(--purple-primary);
        }
        
        /* ===== CUSTOMIZATION ===== */
        .customization-preview {
            width: 100%;
            height: 150px;
            border-radius: var(--radius-lg);
            margin: var(--space-md) 0;
            background: linear-gradient(135deg, var(--purple-primary), var(--purple-light));
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: bold;
            font-size: 1.5rem;
        }
        
        .color-picker {
            display: flex;
            gap: var(--space-xs);
            margin: var(--space-md) 0;
        }
        
        .color-option {
            width: 40px;
            height: 40px;
            border-radius: var(--radius);
            cursor: pointer;
            border: 2px solid transparent;
            transition: all var(--transition);
        }
        
        .color-option.active {
            border-color: var(--white);
            transform: scale(1.1);
        }
        
        /* ===== TAB SYSTEM ===== */
        .tab-container {
            width: 100%;
        }
        
        .tab-header {
            display: flex;
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            padding: 4px;
            margin-bottom: var(--space-lg);
        }
        
        .tab-button {
            flex: 1;
            padding: var(--space-sm);
            text-align: center;
            background: none;
            border: none;
            color: var(--gray-light);
            font-weight: 600;
            cursor: pointer;
            border-radius: var(--radius-sm);
            transition: all var(--transition-fast);
        }
        
        .tab-button.active {
            background: var(--purple-primary);
            color: var(--white);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* ===== PHOTO GALLERY ===== */
        .photo-gallery {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-sm);
            margin: var(--space-md) 0;
        }
        
        .photo-item {
            aspect-ratio: 1/1;
            border-radius: var(--radius);
            overflow: hidden;
            position: relative;
            cursor: pointer;
            background-size: cover;
            background-position: center;
        }
        
        .photo-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity var(--transition);
        }
        
        .photo-item:hover .photo-overlay {
            opacity: 1;
        }
        
        /* ===== ADMIN/HOST DASHBOARD ===== */
        .admin-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin: var(--space-lg) 0;
        }
        
        .admin-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition);
        }
        
        .admin-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow);
        }
        
        .admin-card i {
            font-size: 2rem;
            margin-bottom: var(--space-sm);
            color: var(--purple-primary);
        }
        
        /* ===== CHECKOUT PAGE ===== */
        .checkout-container {
            max-width: 400px;
            margin: 0 auto;
        }
        
        .payment-methods {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            margin: var(--space-lg) 0;
        }
        
        .payment-method {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-md);
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all var(--transition);
        }
        
        .payment-method:hover {
            border-color: var(--purple-primary);
        }
        
        .payment-method.active {
            border-color: var(--purple-primary);
            background: rgba(139, 92, 246, 0.1);
        }
        
        /* ===== HELP CENTER ===== */
        .help-categories {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
            margin: var(--space-lg) 0;
        }
        
        .help-category {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition);
        }
        
        .help-category:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow);
        }
        
        /* ===== SAFETY CENTER ===== */
        .safety-tips {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
            margin: var(--space-lg) 0;
        }
        
        .safety-tip {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }
        
        .safety-tip i {
            font-size: 1.5rem;
            color: var(--purple-primary);
        }
        
        /* ===== SCROLLABLE CONTENT ===== */
        .scrollable-content {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 8px;
        }
        
        .scrollable-content::-webkit-scrollbar {
            width: 6px;
        }
        
        .scrollable-content::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: 3px;
        }
        
        .scrollable-content::-webkit-scrollbar-thumb {
            background: var(--purple-primary);
            border-radius: 3px;
        }
        
        /* ===== ANIMATIONS ===== */
        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        @keyframes scan {
            0% { top: 20px; }
            50% { top: calc(100% - 22px); }
            100% { top: 20px; }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        @keyframes messageAppear {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes confettiFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* ===== UTILITY CLASSES ===== */
        .hidden { display: none !important; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: var(--space-sm); }
        .gap-3 { gap: var(--space-md); }
        .gap-4 { gap: var(--space-lg); }
        .gap-5 { gap: var(--space-xl); }
        .w-full { width: 100%; }
        .cursor-pointer { cursor: pointer; }
        .relative { position: relative; }
        
        .mb-1 { margin-bottom: var(--space-xs); }
        .mb-2 { margin-bottom: var(--space-sm); }
        .mb-3 { margin-bottom: var(--space-md); }
        .mb-4 { margin-bottom: var(--space-lg); }
        .mb-5 { margin-bottom: var(--space-xl); }
        
        .mt-1 { margin-top: var(--space-xs); }
        .mt-2 { margin-top: var(--space-sm); }
        .mt-3 { margin-top: var(--space-md); }
        .mt-4 { margin-top: var(--space-lg); }
        .mt-5 { margin-top: var(--space-xl); }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 480px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.125rem;
            }
            
            .content {
                padding: calc(var(--header-height) + var(--space-sm)) var(--space-sm) var(--space-sm);
            }
            
            .navbar {
                padding: 0 var(--space-sm);
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
            
            .achievements-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 375px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .achievements-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @supports (padding: max(0px)) {
            .bottom-nav {
                padding-bottom: max(var(--safe-area-inset-bottom), 20px);
            }
        }
    </style>
</head>
<body>
    <div class="app" id="app">
        <!-- Hero Background -->
        <div class="hero-bg">
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div>
        </div>
        
        <!-- Toast Notifications Container -->
        <div class="toast-container" id="toastContainer"></div>
        
        <!-- Navigation -->
        <nav class="navbar" id="navbar">
            <div class="nav-brand" onclick="navigateTo('home')">
                <i class="fas fa-bolt"></i>
                <span>Amps</span>
            </div>
            <div class="nav-actions" id="navActions">
                <!-- Filled dynamically -->
            </div>
        </nav>
        
        <!-- Main Content -->
        <main class="content" id="content">
            <!-- Pages will be rendered here -->
        </main>
        
        <!-- Bottom Navigation -->
        <div class="bottom-nav" id="bottomNav">
            <!-- Filled dynamically -->
        </div>
        
        <!-- ===== ALL MODALS ===== -->
        
        <!-- Camera Modal -->
        <div class="camera-modal" id="cameraModal">
            <div class="camera-container">
                <div class="camera-preview">
                    <video class="camera-video" id="cameraVideo" autoplay playsinline></video>
                    <div class="camera-overlay"></div>
                    <div class="live-badge" style="position: absolute; top: 16px; right: 16px;">
                        <i class="fas fa-camera"></i>
                        <span>LIVE PHOTO</span>
                    </div>
                </div>
                <div class="camera-controls">
                    <button class="btn btn-outline" onclick="closeCamera()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button class="camera-btn" onclick="takePhoto()">
                        <i class="fas fa-camera"></i>
                    </button>
                    <button class="btn btn-outline" onclick="switchCamera()">
                        <i class="fas fa-sync-alt"></i> Flip
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Pro Upgrade Modal -->
        <div class="modal-overlay" id="proModal">
            <div class="modal-content">
                <button class="modal-close" onclick="hideModal('proModal')">
                    <i class="fas fa-times"></i>
                </button>
                <div class="modal-header">
                    <div class="pro-badge mb-3">
                        <i class="fas fa-crown"></i>
                        <span>UPGRADE TO PRO</span>
                    </div>
                    <h2 class="pro-gradient">Unlock Premium Features</h2>
                    <p class="text-muted mt-2">Get unlimited swipes, create events, and more!</p>
                </div>

                <div class="flex flex-col gap-3 mb-4">
                    <div class="card-glass">
                        <h4 class="mb-2">Unlimited Daily Swipes</h4>
                        <p class="text-muted">Free users limited to 30 swipes/day per event</p>
                    </div>
                    
                    <div class="card-glass">
                        <h4 class="mb-2">Create Unlimited Events</h4>
                        <p class="text-muted">Free users can create 3 events/month</p>
                    </div>
                    
                    <div class="card-glass">
                        <h4 class="mb-2">See Who Liked You</h4>
                        <p class="text-muted">Free users can't see who liked them</p>
                    </div>
                    
                    <div class="card-glass">
                        <h4 class="mb-2">Video Calls & Read Receipts</h4>
                        <p class="text-muted">Pro-exclusive features</p>
                    </div>
                </div>

                <div class="mb-4">
                    <h4 class="mb-3 text-center">Choose Plan</h4>
                    <div class="flex flex-col gap-3">
                        <div class="pricing-card">
                            <div class="pro-badge mb-3">PRO</div>
                            <h3 class="text-center mb-2">$14.99/month</h3>
                            <p class="text-center text-muted mb-3">or $99.99/year (save 44%)</p>
                            <div class="flex flex-col gap-2 mb-3">
                                <div class="flex items-center gap-2">
                                    <i class="fas fa-check" style="color: var(--green);"></i>
                                    <span>Unlimited likes</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <i class="fas fa-check" style="color: var(--green);"></i>
                                    <span>5 super likes/day</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <i class="fas fa-check" style="color: var(--green);"></i>
                                    <span>See who liked you</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <i class="fas fa-check" style="color: var(--green);"></i>
                                    <span>Video calls</span>
                                </div>
                            </div>
                            <button class="btn btn-pro btn-block" onclick="upgradeToPro()">
                                <i class="fas fa-crown"></i> Upgrade Now
                            </button>
                        </div>
                    </div>
                </div>
                
                <button class="btn btn-glass btn-block mt-3" onclick="hideModal('proModal')">
                    Maybe Later
                </button>
            </div>
        </div>
        
        <!-- Match Modal -->
        <div class="modal-overlay" id="matchModal">
            <div class="modal-content">
                <div class="match-modal">
                    <div class="match-images">
                        <div class="match-avatar" id="userMatchAvatar"></div>
                        <div style="font-size: 3rem; color: var(--purple-primary);"></div>
                        <div class="match-avatar" id="matchMatchAvatar"></div>
                    </div>
                    <h2 class="mb-2">It's a Match!</h2>
                    <p class="text-muted mb-4" id="matchMessage">You and <span id="matchName"></span> liked each other!</p>
                    <div class="flex flex-col gap-2">
                        <button class="btn btn-primary" onclick="startChat()">
                            <i class="fas fa-comment"></i> Send Message
                        </button>
                        <button class="btn btn-outline" onclick="hideModal('matchModal')">
                            Keep Swiping
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Privacy Modal -->
        <div class="modal-overlay" id="privacyModal">
            <div class="modal-content">
                <h3 class="mb-3">Choose Your Privacy Mode</h3>
                <p class="text-muted mb-4">Select how you want to interact at this event</p>
                
                <div class="flex flex-col gap-3 mb-4">
                    <div class="privacy-option card cursor-pointer" onclick="selectPrivacyMode('public')">
                        <div class="flex items-center gap-3">
                            <div class="privacy-icon" style="width: 40px; height: 40px; border-radius: 50%; background: rgba(139, 92, 246, 0.2); display: flex; align-items: center; justify-content: center; font-size: 1.25rem; color: var(--purple-primary);">
                                <i class="fas fa-users"></i>
                            </div>
                            <div>
                                <h4>Public Mode</h4>
                                <p class="text-muted text-sm">Visible in swiping pool, can swipe others, appears in attendee list</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="privacy-option card cursor-pointer" onclick="selectPrivacyMode('private')">
                        <div class="flex items-center gap-3">
                            <div class="privacy-icon" style="width: 40px; height: 40px; border-radius: 50%; background: rgba(139, 92, 246, 0.2); display: flex; align-items: center; justify-content: center; font-size: 1.25rem; color: var(--purple-primary);">
                                <i class="fas fa-user-shield"></i>
                            </div>
                            <div>
                                <h4>Private Mode</h4>
                                <p class="text-muted text-sm">Hidden from swiping, cannot swipe others, view-only experience</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group mb-4">
                    <label class="form-label flex items-center gap-2">
                        <input type="checkbox" id="rememberPrivacy">
                        <span>Remember my choice for future events</span>
                    </label>
                </div>
                
                <button class="btn btn-primary btn-block" onclick="continueToEvent()">
                    Continue
                </button>
            </div>
        </div>
        
        <!-- Filters Modal -->
        <div class="modal-overlay" id="filtersModal">
            <div class="modal-content">
                <h3 class="mb-3">Event Filters</h3>
                
                <div class="form-group mb-4">
                    <label class="form-label">What are you looking for?</label>
                    <div class="flex gap-2">
                        <button class="btn btn-outline btn-small filter-option" onclick="toggleFilterOption(this, 'lookingFor', 'dating')">Dating</button>
                        <button class="btn btn-outline btn-small filter-option" onclick="toggleFilterOption(this, 'lookingFor', 'networking')">Networking</button>
                        <button class="btn btn-outline btn-small filter-option" onclick="toggleFilterOption(this, 'lookingFor', 'friends')">Friends</button>
                    </div>
                </div>
                
                <div class="form-group mb-4">
                    <label class="form-label">Gender Preference</label>
                    <div class="flex gap-2">
                        <button class="btn btn-outline btn-small filter-option" onclick="toggleFilterOption(this, 'gender', 'all')">All</button>
                        <button class="btn btn-outline btn-small filter-option" onclick="toggleFilterOption(this, 'gender', 'male')">Men</button>
                        <button class="btn btn-outline btn-small filter-option" onclick="toggleFilterOption(this, 'gender', 'female')">Women</button>
                    </div>
                </div>
                
                <div class="form-group mb-4">
                    <label class="form-label">Age Range</label>
                    <div class="flex items-center gap-3">
                        <input type="number" class="form-control" id="ageMin" placeholder="18" min="18" max="60" value="18">
                        <span>to</span>
                        <input type="number" class="form-control" id="ageMax" placeholder="35" min="18" max="60" value="35">
                    </div>
                </div>
                
                <div class="form-group mb-4">
                    <label class="form-label">
                        <input type="checkbox" id="askEachTime">
                        Ask these questions for every event
                    </label>
                </div>
                
                <div class="flex gap-2">
                    <button class="btn btn-outline flex-1" onclick="hideModal('filtersModal')">
                        Cancel
                    </button>
                    <button class="btn btn-primary flex-1" onclick="applyEventFilters()">
                        Apply Filters
                    </button>
                </div>
            </div>
        </div>
        
        <!-- QR Scanner Modal -->
        <div class="modal-overlay" id="qrScannerModal">
            <div class="modal-content">
                <h3 class="mb-3">Scan Event QR Code</h3>
                <p class="text-muted mb-4">Point your camera at the event QR code to join</p>
                
                <div class="qr-scanner" id="qrScanner">
                    <div class="scanner-overlay"></div>
                    <div class="scanner-line"></div>
                </div>
                
                <div class="flex flex-col gap-2">
                    <button class="btn btn-primary" onclick="startCameraScanning()">
                        <i class="fas fa-camera"></i> Start Scanner
                    </button>
                    <button class="btn btn-outline" onclick="enterEventCode()">
                        <i class="fas fa-keyboard"></i> Enter Code Manually
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Multi-Step Event Creation Wizard -->
        <div class="modal-overlay" id="eventWizardModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="mb-2">Create New Event</h2>
                    <p class="text-muted">Set up your event with custom branding and geo-fencing</p>
                </div>
                
                <div class="onboarding-steps mb-4">
                    <div class="step">
                        <div class="step-circle active" id="step1">1</div>
                        <div class="step-label">Details</div>
                    </div>
                    <div class="step">
                        <div class="step-circle inactive" id="step2">2</div>
                        <div class="step-label">Location</div>
                    </div>
                    <div class="step">
                        <div class="step-circle inactive" id="step3">3</div>
                        <div class="step-label">Settings</div>
                    </div>
                    <div class="step">
                        <div class="step-circle inactive" id="step4">4</div>
                        <div class="step-label">Branding</div>
                    </div>
                    <div class="step">
                        <div class="step-circle inactive" id="step5">5</div>
                        <div class="step-label">QR Code</div>
                    </div>
                </div>
                
                <div id="wizardContent">
                    <!-- Content will be dynamically loaded -->
                </div>
                
                <div class="flex gap-2 mt-4" id="wizardButtons">
                    <button type="button" class="btn btn-outline flex-1" onclick="previousWizardStep()" id="prevBtn" style="display: none;">
                        Previous
                    </button>
                    <button type="button" class="btn btn-primary flex-1" onclick="nextWizardStep()" id="nextBtn">
                        Next
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Payment Modal -->
        <div class="modal-overlay" id="paymentModal">
            <div class="modal-content">
                <h3 class="mb-3">Complete Payment</h3>
                <p class="text-muted mb-4">Select your preferred payment method</p>
                
                <div class="flex flex-col gap-3 mb-4">
                    <div class="payment-option card cursor-pointer" onclick="selectPaymentMethod('dpo')">
                        <div class="flex items-center gap-3">
                            <div class="payment-icon" style="width: 40px; height: 40px; border-radius: 50%; background: rgba(139, 92, 246, 0.2); display: flex; align-items: center; justify-content: center; font-size: 1.25rem; color: var(--purple-primary);">
                                <i class="fas fa-university"></i>
                            </div>
                            <div>
                                <h4>DPO Namibia</h4>
                                <p class="text-muted text-sm">Secure payment through DPO</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="payment-option card cursor-pointer" onclick="selectPaymentMethod('mastercard')">
                        <div class="flex items-center gap-3">
                            <div class="payment-icon" style="width: 40px; height: 40px; border-radius: 50%; background: rgba(139, 92, 246, 0.2); display: flex; align-items: center; justify-content: center; font-size: 1.25rem; color: var(--purple-primary);">
                                <i class="fab fa-cc-mastercard"></i>
                            </div>
                            <div>
                                <h4>Mastercard/Visa</h4>
                                <p class="text-muted text-sm">Credit/Debit card payment</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="payment-option card cursor-pointer" onclick="selectPaymentMethod('mobile')">
                        <div class="flex items-center gap-3">
                            <div class="payment-icon" style="width: 40px; height: 40px; border-radius: 50%; background: rgba(139, 92, 246, 0.2); display: flex; align-items: center; justify-content: center; font-size: 1.25rem; color: var(--purple-primary);">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <div>
                                <h4>Mobile Money</h4>
                                <p class="text-muted text-sm">Pay with mobile money</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="flex justify-between items-center mb-2">
                        <span>Total Amount</span>
                        <span class="font-bold" id="paymentAmount">$0.00</span>
                    </div>
                    <div class="flex justify-between items-center text-sm text-muted">
                        <span>Event: <span id="paymentEventName"></span></span>
                        <span id="paymentType"></span>
                    </div>
                </div>
                
                <button class="btn btn-primary btn-block" onclick="processPayment()">
                    Complete Payment
                </button>
            </div>
        </div>
        
        <!-- Photo Upload Modal -->
        <div class="modal-overlay" id="photoUploadModal">
            <div class="modal-content">
                <h3 class="mb-3">Upload Event Photos</h3>
                <p class="text-muted mb-4">Share your memories from the event</p>
                
                <div class="photo-upload-area" style="border: 2px dashed var(--purple-primary); border-radius: var(--radius); padding: var(--space-xl); text-align: center; margin-bottom: var(--space-md); cursor: pointer;" onclick="triggerFileUpload()">
                    <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--purple-primary); margin-bottom: var(--space-md);"></i>
                    <h4>Drop photos here or click to upload</h4>
                    <p class="text-muted">Supports JPG, PNG, GIF (Max 10MB each)</p>
                </div>
                
                <input type="file" id="photoUploadInput" multiple accept="image/*" style="display: none;" onchange="handlePhotoUpload(event)">
                
                <div class="photo-preview" id="photoPreview" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-sm); margin-bottom: var(--space-md);">
                    <!-- Photo previews will be added here -->
                </div>
                
                <div class="flex gap-2">
                    <button class="btn btn-outline flex-1" onclick="hideModal('photoUploadModal')">
                        Cancel
                    </button>
                    <button class="btn btn-primary flex-1" onclick="submitEventPhotos()">
                        Upload Photos
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Admin Dashboard Modal -->
        <div class="modal-overlay" id="adminDashboardModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="mb-2">Event Management</h2>
                    <p class="text-muted">Manage your event settings and attendees</p>
                </div>
                
                <div class="admin-grid">
                    <div class="admin-card" onclick="navigateTo('manage-guests')">
                        <i class="fas fa-users"></i>
                        <h4>Guest List</h4>
                        <p class="text-muted">Manage attendees</p>
                    </div>
                    
                    <div class="admin-card" onclick="navigateTo('manage-checkins')">
                        <i class="fas fa-qrcode"></i>
                        <h4>Check-in</h4>
                        <p class="text-muted">QR scanner</p>
                    </div>
                    
                    <div class="admin-card" onclick="navigateTo('manage-photos')">
                        <i class="fas fa-images"></i>
                        <h4>Photos</h4>
                        <p class="text-muted">Moderate photos</p>
                    </div>
                    
                    <div class="admin-card" onclick="navigateTo('manage-analytics')">
                        <i class="fas fa-chart-line"></i>
                        <h4>Analytics</h4>
                        <p class="text-muted">View stats</p>
                    </div>
                    
                    <div class="admin-card" onclick="showModal('eventWizardModal')">
                        <i class="fas fa-edit"></i>
                        <h4>Edit Event</h4>
                        <p class="text-muted">Update details</p>
                    </div>
                    
                    <div class="admin-card" onclick="showModal('qrGeneratorModal')">
                        <i class="fas fa-qrcode"></i>
                        <h4>QR Code</h4>
                        <p class="text-muted">Generate QR</p>
                    </div>
                </div>
                
                <button class="btn btn-outline btn-block mt-4" onclick="hideModal('adminDashboardModal')">
                    Close
                </button>
            </div>
        </div>
        
        <!-- QR Generator Modal -->
        <div class="modal-overlay" id="qrGeneratorModal">
            <div class="modal-content">
                <h3 class="mb-3">Event QR Code</h3>
                <p class="text-muted mb-4">Share this QR code for attendees to join</p>
                
                <div class="qr-code-display" id="generatedQRCode">
                    <div style="text-align: center;">
                        <div style="width: 150px; height: 150px; background: #000; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                            QR CODE
                        </div>
                        <div class="text-muted">Scan to join event</div>
                    </div>
                </div>
                
                <div class="flex flex-col gap-2 mt-4">
                    <button class="btn btn-primary" onclick="downloadQRCode()">
                        <i class="fas fa-download"></i> Download QR Code
                    </button>
                    <button class="btn btn-outline" onclick="shareQRCode()">
                        <i class="fas fa-share-alt"></i> Share QR Code
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Safety Report Modal -->
        <div class="modal-overlay" id="safetyReportModal">
            <div class="modal-content">
                <h3 class="mb-3">Report a Safety Concern</h3>
                <p class="text-muted mb-4">Your safety is our priority. All reports are confidential.</p>
                
                <div class="form-group mb-4">
                    <label class="form-label">What type of issue are you reporting?</label>
                    <select class="form-control" id="reportType">
                        <option value="harassment">Harassment</option>
                        <option value="inappropriate_content">Inappropriate Content</option>
                        <option value="fake_profile">Fake Profile</option>
                        <option value="spam">Spam</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div class="form-group mb-4">
                    <label class="form-label">Please describe what happened</label>
                    <textarea class="form-control" id="reportDescription" rows="4" placeholder="Provide details about the incident..."></textarea>
                </div>
                
                <div class="form-group mb-4">
                    <label class="form-label">
                        <input type="checkbox" id="reportAnonymously">
                        Report anonymously
                    </label>
                </div>
                
                <div class="flex gap-2">
                    <button class="btn btn-outline flex-1" onclick="hideModal('safetyReportModal')">
                        Cancel
                    </button>
                    <button class="btn btn-primary flex-1" onclick="submitSafetyReport()">
                        Submit Report
                    </button>
                </div>
                
                <div class="text-center mt-4">
                    <p class="text-sm text-muted">For emergencies, please contact local authorities immediately.</p>
                    <button class="btn btn-outline btn-small mt-2" onclick="showEmergencyContacts()">
                        <i class="fas fa-phone"></i> Emergency Contacts
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== APP STATE =====
        let state = {
            currentUser: null,
            currentPage: 'home',
            currentEvent: null,
            isAuthenticated: false,
            userTier: 'free', // free, pro, max
            dailyLikes: 30,
            dailyLikesUsed: 0,
            superLikes: 1,
            rewindCount: 1,
            matches: [],
            events: [],
            chatMessages: {},
            swipeHistory: [],
            privacyMode: 'public',
            eventFilters: {
                lookingFor: 'dating',
                gender: 'all',
                ageMin: 18,
                ageMax: 35,
                askEachTime: true
            },
            achievements: [],
            notifications: [],
            bookmarkedEvents: [],
            userProfile: {
                name: 'Demo User',
                email: 'demo@amps.com',
                age: 28,
                occupation: 'Software Engineer',
                company: 'Tech Corp',
                bio: 'Passionate about technology and building meaningful connections at events.',
                interests: ['Technology', 'Music', 'Travel', 'Fitness', 'Photography'],
                profilePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%238B5CF6"/><text x="100" y="120" font-size="24" text-anchor="middle" fill="white">User</text></svg>',
                phone: '+264 81 123 4567',
                location: 'San Francisco, CA',
                gender: 'male',
                visibility: 'public'
            },
            cameraStream: null,
            facingMode: 'user',
            pageHistory: [],
            currentProfileIndex: 0,
            livePhoto: null,
            analytics: {
                eventViews: 1245,
                profileViews: 567,
                matchRate: '24%',
                responseRate: '89%',
                monthlyGrowth: '+12%'
            },
            privacySettings: {
                showProfile: 'public',
                showOnlineStatus: true,
                showDistance: true,
                notifications: {
                    matches: true,
                    messages: true,
                    eventUpdates: true,
                    nearbyEvents: true
                }
            },
            currentWizardStep: 1,
            eventCreationData: {
                name: '',
                description: '',
                date: '',
                time: '',
                location: '',
                capacity: 100,
                category: '',
                tags: [],
                geoFencing: true,
                radius: 100,
                price: 0,
                customColors: {
                    primary: '#8B5CF6',
                    secondary: '#EC4899'
                },
                logo: null
            }
        };

        // ===== MOCK DATA =====
        const MOCK_PROFILES = [
            {
                id: 1,
                name: 'Alex',
                age: 28,
                bio: 'Software engineer passionate about AI and blockchain. Love hiking and indie music.',
                interests: ['Tech', 'Hiking', 'Music', 'Blockchain'],
                verified: true,
                cardColor: '#8B5CF6',
                livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23C4B5FD"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">Live Photo</text></svg>',
                distance: '15m away',
                gender: 'male',
                online: true,
                location: 'Main Stage',
                eventId: 1,
                compatibilityScore: 85
            },
            {
                id: 2,
                name: 'Sam',
                age: 26,
                bio: 'Marketing manager who travels frequently. Foodie always looking for the next great restaurant.',
                interests: ['Travel', 'Food', 'Photography', 'Wine'],
                verified: true,
                cardColor: '#EC4899',
                livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23FFC0D9"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">Live Photo</text></svg>',
                distance: '25m away',
                gender: 'female',
                online: true,
                location: 'Bar Area',
                eventId: 1,
                compatibilityScore: 72
            },
            {
                id: 3,
                name: 'Jordan',
                age: 27,
                bio: 'Startup Founder, Always Down For Deep Conversations',
                interests: ['Tech', 'Philosophy', 'Hiking', 'Sustainability'],
                verified: true,
                cardColor: '#3B82F6',
                livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23BAE6FD"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">Live Photo</text></svg>',
                distance: '50m away',
                gender: 'non-binary',
                online: false,
                location: 'Lounge',
                eventId: 1,
                compatibilityScore: 91
            }
        ];

        const MOCK_EVENTS = [
            {
                id: 1,
                name: 'Tech Mixer 2024',
                description: 'The biggest tech networking event of the year. Connect with founders, engineers, designers, and investors in the heart of Silicon Valley.',
                date: 'Tonight',
                time: '7:00 PM - 11:00 PM',
                location: 'The Mill, San Francisco',
                attendees: 156,
                maxAttendees: 200,
                category: 'Tech Networking',
                tags: ['Tech', 'Networking', 'Startups', 'AI', 'Blockchain'],
                host: 'TechCrunch',
                tier: 'max',
                geoFenced: true,
                coordinates: { lat: 37.7749, lng: -122.4194 },
                radius: 100,
                price: 25,
                bookmarked: false,
                rsvp: 'none',
                customTheme: null,
                qrCode: 'AMPS_TECH_2024_001',
                ageRange: '18-45',
                genderPreference: 'Everyone',
                photos: [],
                analytics: {
                    views: 1245,
                    matches: 89,
                    attendanceRate: '78%',
                    revenue: 3250
                }
            },
            {
                id: 2,
                name: 'Art Gallery Opening',
                description: 'Contemporary art exhibition featuring emerging local artists. Wine tasting and artist talks included.',
                date: 'Tomorrow',
                time: '6:00 PM - 10:00 PM',
                location: 'Modern Art Space, SoMa',
                attendees: 89,
                maxAttendees: 150,
                category: 'Art & Culture',
                tags: ['Art', 'Culture', 'Exhibition', 'Wine Tasting'],
                host: 'Art Collective',
                tier: 'max',
                geoFenced: true,
                coordinates: { lat: 37.7833, lng: -122.4167 },
                radius: 80,
                price: 15,
                bookmarked: true,
                rsvp: 'going',
                customTheme: null,
                qrCode: 'AMPS_ART_2024_002',
                ageRange: '21+',
                genderPreference: 'Everyone',
                photos: [],
                analytics: {
                    views: 845,
                    matches: 45,
                    attendanceRate: '59%',
                    revenue: 1335
                }
            },
            {
                id: 3,
                name: 'Music Producers Meetup',
                description: 'Exclusive meetup for music producers, DJs, and sound engineers. Equipment showcase and demo sharing.',
                date: 'Friday',
                time: '9:00 PM - 2:00 AM',
                location: 'SoundBar Lounge',
                attendees: 45,
                maxAttendees: 80,
                category: 'Music',
                tags: ['Music', 'Producers', 'DJs', 'Audio'],
                host: 'SoundLab',
                tier: 'pro',
                geoFenced: false,
                coordinates: { lat: 37.7812, lng: -122.4201 },
                radius: 50,
                price: 10,
                bookmarked: false,
                rsvp: 'interested',
                customTheme: null,
                qrCode: 'AMPS_MUSIC_2024_003',
                ageRange: '21+',
                genderPreference: 'Everyone',
                photos: [],
                analytics: {
                    views: 567,
                    matches: 32,
                    attendanceRate: '56%',
                    revenue: 450
                }
            }
        ];

        const MOCK_ACHIEVEMENTS = [
            {
                id: 1,
                title: 'First Match',
                description: 'Made your first connection',
                icon: 'fa-heart',
                unlocked: true,
                progress: 100,
                reward: 'Profile Boost'
            },
            {
                id: 2,
                title: 'Event Explorer',
                description: 'Attended 5 events',
                icon: 'fa-calendar',
                unlocked: true,
                progress: 100,
                reward: 'Badge'
            },
            {
                id: 3,
                title: 'Social Butterfly',
                description: 'Made 10 matches',
                icon: 'fa-users',
                unlocked: false,
                progress: 40,
                reward: 'Super Likes'
            },
            {
                id: 4,
                title: 'Verified Member',
                description: 'Completed live verification',
                icon: 'fa-shield-alt',
                unlocked: true,
                progress: 100,
                reward: 'Trust Badge'
            },
            {
                id: 5,
                title: 'Weekend Warrior',
                description: 'Attended 3 events in a weekend',
                icon: 'fa-trophy',
                unlocked: false,
                progress: 66,
                reward: 'Free Upgrade'
            },
            {
                id: 6,
                title: 'Super Liker',
                description: 'Used 10 super likes',
                icon: 'fa-star',
                unlocked: false,
                progress: 20,
                reward: 'Profile Highlight'
            }
        ];

        // ===== UTILITY FUNCTIONS =====
        function showToast(message, type = 'info', duration = 3000) {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-icon">
                    ${type === 'success' ? '<i class="fas fa-check-circle"></i>' :
                      type === 'error' ? '<i class="fas fa-exclamation-circle"></i>' :
                      type === 'warning' ? '<i class="fas fa-exclamation-triangle"></i>' : 
                      '<i class="fas fa-info-circle"></i>'}
                </div>
                <div class="toast-content">
                    <div class="toast-title">${type.charAt(0).toUpperCase() + type.slice(1)}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            toastContainer.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, duration);
        }

        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // ===== ROUTER =====
        function navigateTo(page, data = null) {
            console.log('Navigating to:', page);
            state.pageHistory.push(state.currentPage);
            state.currentPage = page;
            
            if (data) {
                if (page === 'swipe') {
                    state.currentEvent = data;
                } else if (page === 'chat') {
                    // Handle chat data
                }
            }
            
            renderPage();
            updateNavigation();
            window.scrollTo(0, 0);
        }

        function goBack() {
            console.log('Going back');
            if (state.pageHistory.length > 1) {
                const previousPage = state.pageHistory.pop();
                state.currentPage = state.pageHistory.pop() || 'home';
                renderPage();
                updateNavigation();
                window.scrollTo(0, 0);
            }
        }

        // ===== PAGE RENDERERS =====
        function renderPage() {
            console.log('Rendering page:', state.currentPage);
            const content = document.getElementById('content');
            
            // Clear content first
            content.innerHTML = '';
            
            switch(state.currentPage) {
                case 'home':
                    renderHomePage(content);
                    break;
                case 'dashboard':
                    renderDashboardPage(content);
                    break;
                case 'events':
                    renderEventsPage(content);
                    break;
                case 'event-detail':
                    renderEventDetailPage(content);
                    break;
                case 'matches':
                    renderMatchesPage(content);
                    break;
                case 'profile':
                    renderProfilePage(content);
                    break;
                case 'swipe':
                    renderSwipePage(content);
                    break;
                case 'chat':
                    renderChatPage(content);
                    break;
                case 'auth':
                    renderAuthPage(content);
                    break;
                case 'pricing':
                    renderPricingPage(content);
                    break;
                case 'create-event':
                    renderCreateEventPage(content);
                    break;
                case 'analytics':
                    renderAnalyticsPage(content);
                    break;
                case 'settings':
                    renderSettingsPage(content);
                    break;
                case 'bookmarks':
                    renderBookmarksPage(content);
                    break;
                case 'achievements':
                    renderAchievementsPage(content);
                    break;
                case 'onboarding':
                    renderOnboardingPage(content);
                    break;
                case 'help':
                    renderHelpPage(content);
                    break;
                case 'safety':
                    renderSafetyPage(content);
                    break;
                case 'subscription':
                    renderSubscriptionPage(content);
                    break;
                case 'billing':
                    renderBillingPage(content);
                    break;
                case 'checkout':
                    renderCheckoutPage(content);
                    break;
                case 'manage':
                    renderManagePage(content);
                    break;
                case 'photos':
                    renderPhotosPage(content);
                    break;
                case 'discover':
                    renderDiscoverPage(content);
                    break;
                default:
                    renderHomePage(content);
            }
        }

        function updateNavigation() {
            const navActions = document.getElementById('navActions');
            const bottomNav = document.getElementById('bottomNav');
            
            // Update top nav actions
            if (state.isAuthenticated) {
                navActions.innerHTML = `
                    <button class="btn btn-outline btn-small" onclick="showMenuModal()">
                        <i class="fas fa-ellipsis-h"></i>
                    </button>
                `;
            } else {
                navActions.innerHTML = `
                    <button class="btn btn-outline btn-small" onclick="navigateTo('auth')">
                        <i class="fas fa-sign-in-alt"></i> Sign In
                    </button>
                `;
            }
            
            // Update bottom navigation
            if (state.isAuthenticated && ['dashboard', 'events', 'swipe', 'matches', 'profile'].includes(state.currentPage)) {
                const unreadCount = state.matches.filter(m => m.unread).length;
                bottomNav.innerHTML = `
                    <button class="nav-item ${state.currentPage === 'dashboard' ? 'active' : ''}" onclick="navigateTo('dashboard')">
                        <i class="fas fa-home"></i>
                        <span>Home</span>
                    </button>
                    <button class="nav-item ${state.currentPage === 'events' ? 'active' : ''}" onclick="navigateTo('events')">
                        <i class="fas fa-calendar"></i>
                        <span>Events</span>
                    </button>
                    <button class="nav-item ${state.currentPage === 'swipe' ? 'active' : ''}" onclick="navigateTo('swipe')">
                        <i class="fas fa-users"></i>
                        <span>Connect</span>
                    </button>
                    <button class="nav-item ${state.currentPage === 'matches' ? 'active' : ''}" onclick="navigateTo('matches')">
                        <i class="fas fa-heart"></i>
                        <span>Matches${unreadCount > 0 ? ` (${unreadCount})` : ''}</span>
                    </button>
                    <button class="nav-item ${state.currentPage === 'profile' ? 'active' : ''}" onclick="navigateTo('profile')">
                        <i class="fas fa-user"></i>
                        <span>Profile</span>
                    </button>
                `;
                bottomNav.style.display = 'flex';
            } else {
                bottomNav.style.display = 'none';
            }
        }

        // ===== EVENT WIZARD IMPLEMENTATION =====
        function startEventWizard() {
            if (state.userTier !== 'max') {
                showToast('Upgrade to Max tier to create events', 'warning');
                navigateTo('pricing');
                return;
            }
            
            state.currentWizardStep = 1;
            showModal('eventWizardModal');
            renderWizardStep(1);
        }

        function renderWizardStep(step) {
            const wizardContent = document.getElementById('wizardContent');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            // Update step indicators
            for (let i = 1; i <= 5; i++) {
                const stepCircle = document.getElementById(`step${i}`);
                if (i < step) {
                    stepCircle.className = 'step-circle completed';
                } else if (i === step) {
                    stepCircle.className = 'step-circle active';
                } else {
                    stepCircle.className = 'step-circle inactive';
                }
            }
            
            // Show/hide previous button
            prevBtn.style.display = step > 1 ? 'block' : 'none';
            
            // Update next button text
            nextBtn.innerHTML = step === 5 ? 'Create Event' : 'Next';
            
            switch(step) {
                case 1:
                    wizardContent.innerHTML = `
                        <h3 class="mb-3">Event Details</h3>
                        <div class="form-group">
                            <label class="form-label">Event Name</label>
                            <input type="text" class="form-control" id="wizardEventName" placeholder="Tech Mixer 2024" value="${state.eventCreationData.name}" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" id="wizardDescription" placeholder="Describe your event..." rows="3" required>${state.eventCreationData.description}</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Date & Time</label>
                            <input type="datetime-local" class="form-control" id="wizardDateTime" value="${state.eventCreationData.date}" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Max Capacity</label>
                            <input type="number" class="form-control" id="wizardCapacity" placeholder="200" min="1" max="1000" value="${state.eventCreationData.capacity}" required>
                        </div>
                    `;
                    break;
                    
                case 2:
                    wizardContent.innerHTML = `
                        <h3 class="mb-3">Location Settings</h3>
                        <div class="form-group">
                            <label class="form-label">Event Location</label>
                            <input type="text" class="form-control" id="wizardLocation" placeholder="Enter venue address" value="${state.eventCreationData.location}" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <input type="checkbox" id="wizardGeoFencing" ${state.eventCreationData.geoFencing ? 'checked' : ''}>
                                Enable Geo-fencing
                            </label>
                        </div>
                        
                        <div class="form-group" id="geoFencingSettings" style="${state.eventCreationData.geoFencing ? '' : 'display: none;'}">
                            <label class="form-label">Geo-fencing Radius (meters)</label>
                            <input type="range" class="form-control" id="wizardRadius" min="10" max="500" value="${state.eventCreationData.radius}" oninput="updateRadiusValue(this.value)">
                            <div class="text-center mt-2">
                                <span id="radiusValue">${state.eventCreationData.radius}m</span>
                            </div>
                        </div>
                        
                        <div class="card mt-3">
                            <div class="text-center">
                                <i class="fas fa-map-marker-alt mb-2" style="font-size: 2rem; color: var(--purple-primary);"></i>
                                <p class="text-muted">Attendees must be within this radius to join the event</p>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 3:
                    wizardContent.innerHTML = `
                        <h3 class="mb-3">Event Settings</h3>
                        <div class="form-group">
                            <label class="form-label">Category</label>
                            <select class="form-control" id="wizardCategory">
                                <option value="tech" ${state.eventCreationData.category === 'tech' ? 'selected' : ''}>Technology</option>
                                <option value="art" ${state.eventCreationData.category === 'art' ? 'selected' : ''}>Art & Culture</option>
                                <option value="music" ${state.eventCreationData.category === 'music' ? 'selected' : ''}>Music</option>
                                <option value="business" ${state.eventCreationData.category === 'business' ? 'selected' : ''}>Business Networking</option>
                                <option value="social" ${state.eventCreationData.category === 'social' ? 'selected' : ''}>Social Mixer</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Tags</label>
                            <div class="flex flex-wrap gap-2 mb-2" id="wizardTags">
                                ${['Tech', 'Networking', 'Startups', 'AI', 'Blockchain'].map(tag => `
                                    <span class="event-tag ${state.eventCreationData.tags.includes(tag) ? 'active' : ''}" onclick="toggleWizardTag('${tag}')">${tag}</span>
                                `).join('')}
                            </div>
                            <input type="text" class="form-control" id="wizardNewTag" placeholder="Add custom tag" onkeypress="addWizardTag(event)">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Ticket Price</label>
                            <input type="number" class="form-control" id="wizardPrice" placeholder="0" min="0" value="${state.eventCreationData.price}">
                            <p class="text-sm text-muted mt-1">Set to 0 for free events</p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Age Range</label>
                            <div class="flex items-center gap-3">
                                <input type="number" class="form-control" id="wizardAgeMin" placeholder="18" min="18" max="60" value="18">
                                <span>to</span>
                                <input type="number" class="form-control" id="wizardAgeMax" placeholder="35" min="18" max="60" value="35">
                            </div>
                        </div>
                    `;
                    break;
                    
                case 4:
                    wizardContent.innerHTML = `
                        <h3 class="mb-3">Custom Branding</h3>
                        
                        <div class="customization-preview" id="brandingPreview" style="background: linear-gradient(135deg, ${state.eventCreationData.customColors.primary}, ${state.eventCreationData.customColors.secondary});">
                            <div style="text-align: center;">
                                <h3 style="color: white; margin-bottom: 10px;">${state.eventCreationData.name || 'Event Name'}</h3>
                                <p style="color: rgba(255,255,255,0.8);">Custom Brand Preview</p>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Primary Color</label>
                            <div class="color-picker">
                                ${['#8B5CF6', '#EC4899', '#3B82F6', '#10B981', '#F59E0B'].map(color => `
                                    <div class="color-option ${state.eventCreationData.customColors.primary === color ? 'active' : ''}" 
                                         style="background: ${color};" 
                                         onclick="selectBrandingColor('primary', '${color}')"></div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Secondary Color</label>
                            <div class="color-picker">
                                ${['#EC4899', '#8B5CF6', '#F59E0B', '#3B82F6', '#10B981'].map(color => `
                                    <div class="color-option ${state.eventCreationData.customColors.secondary === color ? 'active' : ''}" 
                                         style="background: ${color};" 
                                         onclick="selectBrandingColor('secondary', '${color}')"></div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Upload Event Logo (Optional)</label>
                            <div class="photo-upload-area" style="border: 1px dashed var(--gray-light); border-radius: var(--radius); padding: var(--space-md); text-align: center; cursor: pointer;" onclick="triggerLogoUpload()">
                                ${state.eventCreationData.logo ? 
                                    '<img src="' + state.eventCreationData.logo + '" style="max-width: 100px; max-height: 100px; border-radius: var(--radius);">' :
                                    '<i class="fas fa-upload" style="font-size: 2rem; color: var(--gray-light); margin-bottom: var(--space-sm);"></i><p class="text-muted">Click to upload logo</p>'
                                }
                            </div>
                            <input type="file" id="logoUploadInput" accept="image/*" style="display: none;" onchange="handleLogoUpload(event)">
                        </div>
                    `;
                    break;
                    
                case 5:
                    wizardContent.innerHTML = `
                        <h3 class="mb-3">QR Code & Finalize</h3>
                        
                        <div class="qr-code-display" id="finalQRCode">
                            <div style="text-align: center;">
                                <div style="width: 150px; height: 150px; background: linear-gradient(135deg, ${state.eventCreationData.customColors.primary}, ${state.eventCreationData.customColors.secondary}); margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; border-radius: 10px;">
                                    QR CODE
                                </div>
                                <h4>${state.eventCreationData.name || 'Event Name'}</h4>
                                <p class="text-muted">Scan to join</p>
                            </div>
                        </div>
                        
                        <div class="card mt-4">
                            <h4 class="mb-2">Event Summary</h4>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-muted">Date:</span>
                                <span>${state.eventCreationData.date || 'Not set'}</span>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-muted">Location:</span>
                                <span>${state.eventCreationData.location || 'Not set'}</span>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-muted">Capacity:</span>
                                <span>${state.eventCreationData.capacity} attendees</span>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-muted">Price:</span>
                                <span>${state.eventCreationData.price > 0 ? '$' + state.eventCreationData.price : 'Free'}</span>
                            </div>
                            ${state.eventCreationData.geoFencing ? 
                                `<div class="flex justify-between items-center">
                                    <span class="text-muted">Geo-fencing:</span>
                                    <span class="geo-fencing-badge">${state.eventCreationData.radius}m radius</span>
                                </div>` : ''
                            }
                        </div>
                    `;
                    break;
            }
        }

        function updateRadiusValue(value) {
            document.getElementById('radiusValue').textContent = value + 'm';
        }

        function toggleWizardTag(tag) {
            const index = state.eventCreationData.tags.indexOf(tag);
            if (index > -1) {
                state.eventCreationData.tags.splice(index, 1);
            } else {
                state.eventCreationData.tags.push(tag);
            }
            renderWizardStep(state.currentWizardStep);
        }

        function addWizardTag(event) {
            if (event.key === 'Enter') {
                const input = document.getElementById('wizardNewTag');
                const tag = input.value.trim();
                if (tag && !state.eventCreationData.tags.includes(tag)) {
                    state.eventCreationData.tags.push(tag);
                    input.value = '';
                    renderWizardStep(state.currentWizardStep);
                }
            }
        }

        function selectBrandingColor(type, color) {
            state.eventCreationData.customColors[type] = color;
            renderWizardStep(state.currentWizardStep);
        }

        function triggerLogoUpload() {
            document.getElementById('logoUploadInput').click();
        }

        function handleLogoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    state.eventCreationData.logo = e.target.result;
                    renderWizardStep(state.currentWizardStep);
                };
                reader.readAsDataURL(file);
            }
        }

        function previousWizardStep() {
            if (state.currentWizardStep > 1) {
                state.currentWizardStep--;
                renderWizardStep(state.currentWizardStep);
            }
        }

        function nextWizardStep() {
            // Save current step data
            saveWizardStepData();
            
            if (state.currentWizardStep < 5) {
                state.currentWizardStep++;
                renderWizardStep(state.currentWizardStep);
            } else {
                createEventFromWizard();
            }
        }

        function saveWizardStepData() {
            switch(state.currentWizardStep) {
                case 1:
                    state.eventCreationData.name = document.getElementById('wizardEventName').value;
                    state.eventCreationData.description = document.getElementById('wizardDescription').value;
                    state.eventCreationData.date = document.getElementById('wizardDateTime').value;
                    state.eventCreationData.capacity = parseInt(document.getElementById('wizardCapacity').value) || 100;
                    break;
                case 2:
                    state.eventCreationData.location = document.getElementById('wizardLocation').value;
                    state.eventCreationData.geoFencing = document.getElementById('wizardGeoFencing').checked;
                    state.eventCreationData.radius = parseInt(document.getElementById('wizardRadius').value) || 100;
                    break;
                case 3:
                    state.eventCreationData.category = document.getElementById('wizardCategory').value;
                    state.eventCreationData.price = parseFloat(document.getElementById('wizardPrice').value) || 0;
                    state.eventCreationData.ageMin = parseInt(document.getElementById('wizardAgeMin').value) || 18;
                    state.eventCreationData.ageMax = parseInt(document.getElementById('wizardAgeMax').value) || 35;
                    break;
            }
        }

        function createEventFromWizard() {
            // Generate a unique event ID and QR code
            const eventId = MOCK_EVENTS.length + 1;
            const qrCode = `AMPS_${state.eventCreationData.category.toUpperCase()}_${Date.now()}`;
            
            const newEvent = {
                id: eventId,
                name: state.eventCreationData.name,
                description: state.eventCreationData.description,
                date: new Date(state.eventCreationData.date).toLocaleDateString('en-US', { 
                    weekday: 'long',
                    month: 'short',
                    day: 'numeric'
                }),
                time: new Date(state.eventCreationData.date).toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit'
                }),
                location: state.eventCreationData.location,
                attendees: 0,
                maxAttendees: state.eventCreationData.capacity,
                category: state.eventCreationData.category.charAt(0).toUpperCase() + state.eventCreationData.category.slice(1),
                tags: state.eventCreationData.tags,
                host: state.userProfile.name,
                tier: 'max',
                geoFenced: state.eventCreationData.geoFencing,
                coordinates: { lat: 37.7749, lng: -122.4194 }, // Default SF coordinates
                radius: state.eventCreationData.radius,
                price: state.eventCreationData.price,
                bookmarked: false,
                rsvp: 'going', // Creator automatically RSVPs
                customTheme: {
                    colors: state.eventCreationData.customColors,
                    logo: state.eventCreationData.logo
                },
                qrCode: qrCode,
                ageRange: `${state.eventCreationData.ageMin}-${state.eventCreationData.ageMax}`,
                genderPreference: 'Everyone',
                photos: [],
                analytics: {
                    views: 0,
                    matches: 0,
                    attendanceRate: '0%',
                    revenue: 0
                }
            };
            
            MOCK_EVENTS.unshift(newEvent);
            hideModal('eventWizardModal');
            showToast('Event created successfully! ', 'success');
            navigateTo('events');
        }

        // ===== COMMUNITY PHOTO DUMPS =====
        function openEventPhotos(eventId) {
            const event = MOCK_EVENTS.find(e => e.id === eventId);
            if (!event) return;
            
            state.currentEvent = event;
            navigateTo('photos');
        }

        function renderPhotosPage(container) {
            const event = state.currentEvent;
            if (!event) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-images" style="font-size: 4rem; color: var(--gray-light); margin-bottom: var(--space-md);"></i>
                        <h3 class="mb-2">No Event Selected</h3>
                        <p class="text-muted mb-4">Please select an event to view photos</p>
                        <button class="btn btn-primary" onclick="navigateTo('events')">
                            <i class="fas fa-calendar"></i> Browse Events
                        </button>
                    </div>
                `;
                return;
            }
            
            const photos = event.photos || [];
            const isHost = event.host === state.userProfile.name;
            
            container.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h2>${event.name} Photos</h2>
                        <p class="text-muted">${photos.length} photos shared</p>
                    </div>
                    ${isHost ? `
                        <button class="btn btn-outline btn-small" onclick="showPhotoModeration()">
                            <i class="fas fa-shield-alt"></i> Moderate
                        </button>
                    ` : ''}
                </div>
                
                ${photos.length > 0 ? `
                    <div class="photo-gallery">
                        ${photos.map(photo => `
                            <div class="photo-item" style="background-image: url('${photo.url}');" onclick="openPhotoDetail(${photo.id})">
                                <div class="photo-overlay">
                                    <div style="text-align: center;">
                                        <div class="flex items-center justify-center gap-2 mb-2">
                                            <i class="fas fa-heart" style="color: var(--pink);"></i>
                                            <span style="color: white;">${photo.likes}</span>
                                        </div>
                                        <div class="flex items-center justify-center gap-2">
                                            <i class="fas fa-comment" style="color: var(--blue);"></i>
                                            <span style="color: white;">${photo.comments}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="flex justify-center mt-4">
                        <button class="btn btn-primary" onclick="showModal('photoUploadModal')">
                            <i class="fas fa-plus"></i> Add Photos
                        </button>
                    </div>
                ` : `
                    <div class="text-center py-12">
                        <i class="fas fa-camera" style="font-size: 4rem; color: var(--gray-light); margin-bottom: var(--space-md);"></i>
                        <h3 class="mb-2">No Photos Yet</h3>
                        <p class="text-muted mb-4">Be the first to share photos from this event!</p>
                        <button class="btn btn-primary" onclick="showModal('photoUploadModal')">
                            <i class="fas fa-plus"></i> Upload Photos
                        </button>
                    </div>
                `}
                
                ${isHost ? `
                    <div class="card mt-5">
                        <h3 class="mb-3">Photo Moderation Tools</h3>
                        <div class="flex gap-2">
                            <button class="btn btn-outline flex-1" onclick="showUnapprovedPhotos()">
                                <i class="fas fa-eye"></i> Review
                            </button>
                            <button class="btn btn-outline flex-1" onclick="downloadPhotoAlbum()">
                                <i class="fas fa-download"></i> Download All
                            </button>
                        </div>
                    </div>
                ` : ''}
            `;
        }

        function triggerFileUpload() {
            document.getElementById('photoUploadInput').click();
        }

        function handlePhotoUpload(event) {
            const files = event.target.files;
            const preview = document.getElementById('photoPreview');
            preview.innerHTML = '';
            
            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const div = document.createElement('div');
                    div.style.backgroundImage = `url('${e.target.result}')`;
                    div.style.backgroundSize = 'cover';
                    div.style.backgroundPosition = 'center';
                    div.style.aspectRatio = '1/1';
                    div.style.borderRadius = 'var(--radius)';
                    div.style.position = 'relative';
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.innerHTML = '<i class="fas fa-times"></i>';
                    removeBtn.style.position = 'absolute';
                    removeBtn.style.top = '5px';
                    removeBtn.style.right = '5px';
                    removeBtn.style.background = 'var(--red)';
                    removeBtn.style.color = 'white';
                    removeBtn.style.border = 'none';
                    removeBtn.style.borderRadius = '50%';
                    removeBtn.style.width = '24px';
                    removeBtn.style.height = '24px';
                    removeBtn.style.cursor = 'pointer';
                    removeBtn.onclick = function() {
                        div.remove();
                    };
                    
                    div.appendChild(removeBtn);
                    preview.appendChild(div);
                };
                reader.readAsDataURL(file);
            });
        }

        function submitEventPhotos() {
            const preview = document.getElementById('photoPreview');
            const photos = Array.from(preview.children).map(div => {
                const background = div.style.backgroundImage;
                const url = background.slice(5, -2); // Remove "url('" and "')"
                
                return {
                    id: Date.now() + Math.random(),
                    url: url,
                    userId: state.currentUser.id,
                    userName: state.userProfile.name,
                    timestamp: new Date().toISOString(),
                    likes: 0,
                    comments: 0,
                    verified: true,
                    approved: true
                };
            });
            
            if (!state.currentEvent.photos) {
                state.currentEvent.photos = [];
            }
            
            state.currentEvent.photos.push(...photos);
            hideModal('photoUploadModal');
            showToast(`Uploaded ${photos.length} photos successfully!`, 'success');
            renderPhotosPage(document.getElementById('content'));
        }

        // ===== ADVANCED ANALYTICS =====
        function renderAnalyticsPage(container) {
            container.innerHTML = `
                <div class="tab-container">
                    <div class="tab-header">
                        <button class="tab-button active" onclick="switchAnalyticsTab('overview')">Overview</button>
                        <button class="tab-button" onclick="switchAnalyticsTab('events')">Events</button>
                        <button class="tab-button" onclick="switchAnalyticsTab('matches')">Matches</button>
                        <button class="tab-button" onclick="switchAnalyticsTab('revenue')">Revenue</button>
                    </div>
                    
                    <div id="analyticsOverview" class="tab-content active">
                        <div class="analytics-grid mb-4">
                            <div class="analytics-card">
                                <div class="analytics-value">${state.analytics.eventViews}</div>
                                <div class="analytics-label">Event Views</div>
                            </div>
                            <div class="analytics-card">
                                <div class="analytics-value">${state.analytics.profileViews}</div>
                                <div class="analytics-label">Profile Views</div>
                            </div>
                            <div class="analytics-card">
                                <div class="analytics-value">${state.analytics.matchRate}</div>
                                <div class="analytics-label">Match Rate</div>
                            </div>
                            <div class="analytics-card">
                                <div class="analytics-value">${state.analytics.responseRate}</div>
                                <div class="analytics-label">Response Rate</div>
                            </div>
                        </div>
                        
                        <div class="card mb-4">
                            <h4 class="mb-3">Activity Overview</h4>
                            <canvas id="activityChart" style="width: 100%; height: 200px;"></canvas>
                        </div>
                        
                        <div class="card">
                            <h4 class="mb-3">Demographics</h4>
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-muted">Gender Distribution</span>
                                <span>65% Male, 30% Female, 5% Other</span>
                            </div>
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-muted">Average Age</span>
                                <span>27</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-muted">Top Interests</span>
                                <span>Tech, Music, Travel</span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="analyticsEvents" class="tab-content">
                        <h3 class="mb-3">Event Performance</h3>
                        ${MOCK_EVENTS.slice(0, 3).map(event => `
                            <div class="card mb-3">
                                <div class="flex justify-between items-center mb-2">
                                    <h4>${event.name}</h4>
                                    <span class="badge ${event.attendees >= event.maxAttendees * 0.8 ? 'live-badge' : 'free-badge'}">
                                        ${event.analytics.attendanceRate} Attendance
                                    </span>
                                </div>
                                <div class="flex justify-between items-center text-sm">
                                    <span class="text-muted">Views: ${event.analytics.views}</span>
                                    <span class="text-muted">Matches: ${event.analytics.matches}</span>
                                    ${event.price > 0 ? `<span class="text-muted">Revenue: $${event.analytics.revenue}</span>` : ''}
                                </div>
                            </div>
                        `).join('')}
                        <button class="btn btn-outline btn-block mt-3" onclick="exportEventAnalytics()">
                            <i class="fas fa-download"></i> Export as CSV
                        </button>
                    </div>
                    
                    <div id="analyticsMatches" class="tab-content">
                        <h3 class="mb-3">Match Analytics</h3>
                        <div class="card mb-3">
                            <h4 class="mb-2">Compatibility Scores</h4>
                            <p class="text-muted mb-3">Average score: 76%</p>
                            <canvas id="matchChart" style="width: 100%; height: 150px;"></canvas>
                        </div>
                        
                        <div class="card">
                            <h4 class="mb-2">AI-Generated Insights</h4>
                            <p class="text-muted">Based on your matching patterns:</p>
                            <ul class="mt-2" style="padding-left: 20px;">
                                <li class="mb-2">You connect best with people interested in Technology</li>
                                <li class="mb-2">Your response rate is highest in the evening (7-10 PM)</li>
                                <li class="mb-2">Networking events yield 35% more matches than social events</li>
                                <li>Consider attending more tech-focused events for better connections</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div id="analyticsRevenue" class="tab-content">
                        <h3 class="mb-3">Revenue Analytics</h3>
                        <div class="analytics-grid mb-4">
                            <div class="analytics-card">
                                <div class="analytics-value">$${MOCK_EVENTS.reduce((sum, event) => sum + event.analytics.revenue, 0)}</div>
                                <div class="analytics-label">Total Revenue</div>
                            </div>
                            <div class="analytics-card">
                                <div class="analytics-value">${MOCK_EVENTS.filter(e => e.price > 0).length}</div>
                                <div class="analytics-label">Paid Events</div>
                            </div>
                            <div class="analytics-card">
                                <div class="analytics-value">$${Math.round(MOCK_EVENTS.reduce((sum, event) => sum + event.analytics.revenue, 0) / MOCK_EVENTS.filter(e => e.price > 0).length)}</div>
                                <div class="analytics-label">Avg. per Event</div>
                            </div>
                            <div class="analytics-card">
                                <div class="analytics-value">+24%</div>
                                <div class="analytics-label">Growth</div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <h4 class="mb-3">Payment Methods</h4>
                            <canvas id="revenueChart" style="width: 100%; height: 150px;"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="flex gap-2 mt-4">
                    <button class="btn btn-outline flex-1" onclick="exportAnalytics('pdf')">
                        <i class="fas fa-file-pdf"></i> PDF
                    </button>
                    <button class="btn btn-outline flex-1" onclick="exportAnalytics('csv')">
                        <i class="fas fa-file-csv"></i> CSV
                    </button>
                </div>
            `;
            
            // Initialize charts after rendering
            setTimeout(() => {
                initAnalyticsCharts();
            }, 100);
        }

        function switchAnalyticsTab(tab) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab and activate button
            document.getElementById(`analytics${tab.charAt(0).toUpperCase() + tab.slice(1)}`).classList.add('active');
            event.target.classList.add('active');
        }

        function initAnalyticsCharts() {
            // Activity Chart
            const activityCtx = document.getElementById('activityChart')?.getContext('2d');
            if (activityCtx) {
                new Chart(activityCtx, {
                    type: 'line',
                    data: {
                        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        datasets: [{
                            label: 'Matches',
                            data: [12, 19, 8, 15, 22, 18, 25],
                            borderColor: '#8B5CF6',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            tension: 0.4
                        }, {
                            label: 'Messages',
                            data: [45, 52, 38, 49, 55, 62, 70],
                            borderColor: '#EC4899',
                            backgroundColor: 'rgba(236, 72, 153, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#9CA3AF'
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: '#9CA3AF'
                                }
                            },
                            x: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: '#9CA3AF'
                                }
                            }
                        }
                    }
                });
            }
            
            // Match Chart
            const matchCtx = document.getElementById('matchChart')?.getContext('2d');
            if (matchCtx) {
                new Chart(matchCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Tech', 'Art', 'Music', 'Business', 'Social'],
                        datasets: [{
                            label: 'Match Rate',
                            data: [85, 45, 60, 70, 55],
                            backgroundColor: '#8B5CF6'
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: '#9CA3AF'
                                }
                            },
                            x: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                ticks: {
                                    color: '#9CA3AF'
                                }
                            }
                        }
                    }
                });
            }
            
            // Revenue Chart
            const revenueCtx = document.getElementById('revenueChart')?.getContext('2d');
            if (revenueCtx) {
                new Chart(revenueCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Credit Card', 'Mobile Money', 'DPO', 'PayPal'],
                        datasets: [{
                            data: [45, 30, 15, 10],
                            backgroundColor: ['#8B5CF6', '#EC4899', '#3B82F6', '#10B981']
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#9CA3AF'
                                }
                            }
                        }
                    }
                });
            }
        }

        function exportAnalytics(format) {
            showToast(`Exporting analytics as ${format.toUpperCase()}...`, 'info');
            setTimeout(() => {
                showToast('Analytics exported successfully!', 'success');
            }, 1500);
        }

        function exportEventAnalytics() {
            showToast('Exporting event analytics...', 'info');
            setTimeout(() => {
                showToast('Event analytics exported to CSV!', 'success');
            }, 1500);
        }

        // ===== SOCIAL MEDIA INTEGRATION =====
        function connectSocialMedia(platform) {
            showToast(`Connecting to ${platform}...`, 'info');
            
            // Simulate OAuth flow
            setTimeout(() => {
                showToast(`Successfully connected to ${platform}!`, 'success');
                
                // Update user profile with social media info
                if (platform === 'instagram') {
                    state.userProfile.socialMedia = {
                        ...state.userProfile.socialMedia,
                        instagram: '@' + state.userProfile.name.toLowerCase().replace(/\s/g, '')
                    };
                }
                
                // Refresh profile page if needed
                if (state.currentPage === 'profile') {
                    renderPage();
                }
            }, 2000);
        }

        function importSocialPhotos(platform) {
            showToast(`Importing photos from ${platform}...`, 'info');
            
            // Simulate photo import
            setTimeout(() => {
                const photos = [
                    {
                        id: Date.now() + 1,
                        url: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%238B5CF6"/><text x="100" y="100" font-size="16" text-anchor="middle" fill="white">Imported from ' + platform + '</text></svg>',
                        source: platform
                    }
                ];
                
                if (!state.userProfile.photos) {
                    state.userProfile.photos = [];
                }
                
                state.userProfile.photos.push(...photos);
                showToast(`Imported ${photos.length} photos from ${platform}!`, 'success');
                
                // Refresh profile page
                if (state.currentPage === 'profile') {
                    renderPage();
                }
            }, 1500);
        }

        function shareToSocialMedia(platform, content) {
            let shareUrl = '';
            
            switch(platform) {
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(content)}`;
                    break;
                case 'instagram':
                    // Instagram doesn't have a direct share URL, show instructions
                    showToast('Open Instagram to share this moment!', 'info');
                    return;
                case 'tiktok':
                    shareUrl = `https://www.tiktok.com/share?text=${encodeURIComponent(content)}`;
                    break;
            }
            
            if (shareUrl) {
                window.open(shareUrl, '_blank');
            }
        }

        // ===== REAL-TIME FEATURES =====
        function simulateWebSocketConnection() {
            // Simulate real-time updates
            setInterval(() => {
                if (state.isAuthenticated && Math.random() > 0.7) {
                    const notifications = [
                        'New match at Tech Mixer!',
                        'Someone liked your profile',
                        'Event starting in 30 minutes',
                        'New message received'
                    ];
                    
                    const randomNotification = notifications[Math.floor(Math.random() * notifications.length)];
                    showToast(randomNotification, 'info');
                }
            }, 30000); // Every 30 seconds
        }

        function updateLiveAttendeeCount(eventId) {
            const event = MOCK_EVENTS.find(e => e.id === eventId);
            if (event) {
                // Simulate live count updates
                const change = Math.random() > 0.5 ? 1 : -1;
                event.attendees = Math.max(0, Math.min(event.maxAttendees, event.attendees + change));
                
                // Update UI if on event page
                if (state.currentPage === 'event-detail' && state.currentEvent?.id === eventId) {
                    renderPage();
                }
            }
        }

        // ===== PAYMENT PROCESSING =====
        async function processRealPayment(method, amount, details) {
            showToast(`Processing ${method} payment...`, 'info');
            
            // Simulate API call delay
            return new Promise((resolve) => {
                setTimeout(() => {
                    // Simulate payment processing
                    const success = Math.random() > 0.1; // 90% success rate
                    
                    if (success) {
                        showToast('Payment successful!', 'success');
                        resolve({
                            success: true,
                            transactionId: 'TX_' + Date.now(),
                            receipt: `Receipt #${Date.now()} for $${amount}`,
                            timestamp: new Date().toISOString()
                        });
                    } else {
                        showToast('Payment failed. Please try again.', 'error');
                        resolve({
                            success: false,
                            error: 'Payment processing failed'
                        });
                    }
                }, 2000);
            });
        }

        function generateReceipt(transaction) {
            return `
                <div class="card">
                    <h3 class="mb-3">Payment Receipt</h3>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-muted">Transaction ID:</span>
                        <span>${transaction.transactionId}</span>
                    </div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-muted">Date:</span>
                        <span>${new Date(transaction.timestamp).toLocaleDateString()}</span>
                    </div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-muted">Amount:</span>
                        <span>$${transaction.amount}</span>
                    </div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-muted">Method:</span>
                        <span>${transaction.method}</span>
                    </div>
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-muted">Status:</span>
                        <span class="badge live-badge">Completed</span>
                    </div>
                    <button class="btn btn-outline btn-block" onclick="downloadReceipt('${transaction.transactionId}')">
                        <i class="fas fa-download"></i> Download Receipt
                    </button>
                </div>
            `;
        }

        // ===== CAMERA & LOCATION INTEGRATION =====
        async function requestCameraPermission() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: state.facingMode
                    }
                });
                
                const video = document.getElementById('cameraVideo');
                if (video) {
                    video.srcObject = stream;
                }
                
                state.cameraStream = stream;
                return true;
            } catch (error) {
                console.error('Camera access denied:', error);
                showToast('Camera access is required for live photos', 'error');
                return false;
            }
        }

        async function getLocation() {
            return new Promise((resolve, reject) => {
                if (!navigator.geolocation) {
                    reject(new Error('Geolocation not supported'));
                    return;
                }
                
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        resolve({
                            lat: position.coords.latitude,
                            lng: position.coords.longitude,
                            accuracy: position.coords.accuracy
                        });
                    },
                    (error) => {
                        reject(error);
                        // Use mock location for demo
                        resolve({
                            lat: 37.7749,
                            lng: -122.4194,
                            accuracy: 50
                        });
                    },
                    { enableHighAccuracy: true, timeout: 5000 }
                );
            });
        }

        function checkGeoFence(event, userLocation) {
            if (!event.geoFenced) return true;
            
            const distance = calculateDistance(
                userLocation.lat,
                userLocation.lng,
                event.coordinates.lat,
                event.coordinates.lng
            );
            
            return distance <= event.radius;
        }

        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Earth's radius in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c * 1000; // Distance in meters
        }

        // ===== ONBOARDING FLOW =====
        function renderOnboardingPage(container) {
            container.innerHTML = `
                <div class="onboarding-steps mb-5">
                    <div class="step">
                        <div class="step-circle active">1</div>
                        <div class="step-label">Profile</div>
                    </div>
                    <div class="step">
                        <div class="step-circle inactive">2</div>
                        <div class="step-label">Interests</div>
                    </div>
                    <div class="step">
                        <div class="step-circle inactive">3</div>
                        <div class="step-label">Photos</div>
                    </div>
                    <div class="step">
                        <div class="step-circle inactive">4</div>
                        <div class="step-label">Preferences</div>
                    </div>
                    <div class="step">
                        <div class="step-circle inactive">5</div>
                        <div class="step-label">Complete</div>
                    </div>
                </div>
                
                <div class="text-center mb-5">
                    <h2>Welcome to Amps! </h2>
                    <p class="text-muted mt-2">Let's set up your profile to get the best experience</p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Profile Photo</label>
                    <div class="user-avatar" style="width: 100px; height: 100px; margin: 0 auto 20px; cursor: pointer;" onclick="uploadProfilePhoto()">
                        ${state.userProfile.profilePhoto ? 
                            `<img src="${state.userProfile.profilePhoto}" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">` :
                            `<i class="fas fa-user" style="font-size: 3rem; color: white; line-height: 100px;"></i>`
                        }
                    </div>
                    <input type="file" id="profilePhotoInput" accept="image/*" style="display: none;" onchange="handleProfilePhotoUpload(event)">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Bio</label>
                    <textarea class="form-control" id="onboardingBio" placeholder="Tell us about yourself..." rows="3">${state.userProfile.bio}</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Occupation</label>
                    <input type="text" class="form-control" id="onboardingOccupation" value="${state.userProfile.occupation}" placeholder="What do you do?">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Company/School</label>
                    <input type="text" class="form-control" id="onboardingCompany" value="${state.userProfile.company}" placeholder="Where do you work/study?">
                </div>
                
                <button class="btn btn-primary btn-block mt-4" onclick="nextOnboardingStep()">
                    Continue
                </button>
                
                <button class="btn btn-outline btn-block mt-2" onclick="skipOnboarding()">
                    Skip for now
                </button>
            `;
        }

        function uploadProfilePhoto() {
            document.getElementById('profilePhotoInput').click();
        }

        function handleProfilePhotoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    state.userProfile.profilePhoto = e.target.result;
                    renderOnboardingPage(document.getElementById('content'));
                };
                reader.readAsDataURL(file);
            }
        }

        function nextOnboardingStep() {
            // Save current step data
            state.userProfile.bio = document.getElementById('onboardingBio').value;
            state.userProfile.occupation = document.getElementById('onboardingOccupation').value;
            state.userProfile.company = document.getElementById('onboardingCompany').value;
            
            // For demo, skip to dashboard
            showToast('Profile setup complete!', 'success');
            navigateTo('dashboard');
        }

        function skipOnboarding() {
            showToast('You can complete your profile later in settings', 'info');
            navigateTo('dashboard');
        }

        // ===== ADMIN/HOST DASHBOARD =====
        function renderManagePage(container) {
            const hostedEvents = MOCK_EVENTS.filter(event => event.host === state.userProfile.name);
            
            container.innerHTML = `
                <h2 class="mb-4">Manage Your Events</h2>
                
                ${hostedEvents.length > 0 ? `
                    <div class="events-grid mb-4">
                        ${hostedEvents.map(event => `
                            <div class="event-card" onclick="openEventManagement(${event.id})">
                                <div class="event-card-header">
                                    <div>
                                        <h3 class="mb-2">${event.name}</h3>
                                        <p class="text-muted">
                                            <i class="fas fa-map-marker-alt"></i> ${event.location}
                                        </p>
                                    </div>
                                    <span class="badge ${event.attendees >= event.maxAttendees * 0.8 ? 'live-badge' : 'free-badge'}">
                                        ${event.attendees}/${event.maxAttendees}
                                    </span>
                                </div>
                                
                                <div class="event-info">
                                    <i class="fas fa-calendar"></i>
                                    <span>${event.date}  ${event.time}</span>
                                </div>
                                
                                <div class="event-info">
                                    <i class="fas fa-chart-line"></i>
                                    <span>${event.analytics.views} views  ${event.analytics.matches} matches</span>
                                </div>
                                
                                <div class="flex gap-2 mt-3">
                                    <button class="btn btn-primary flex-1" onclick="event.stopPropagation(); openEventManagement(${event.id})">
                                        <i class="fas fa-cog"></i> Manage
                                    </button>
                                    <button class="btn btn-outline btn-icon" onclick="event.stopPropagation(); showModal('qrGeneratorModal')">
                                        <i class="fas fa-qrcode"></i>
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="admin-grid">
                        <div class="admin-card" onclick="showModal('eventWizardModal')">
                            <i class="fas fa-plus-circle"></i>
                            <h4>Create Event</h4>
                            <p class="text-muted">Start a new event</p>
                        </div>
                        
                        <div class="admin-card" onclick="navigateTo('analytics')">
                            <i class="fas fa-chart-line"></i>
                            <h4>Analytics</h4>
                            <p class="text-muted">View all stats</p>
                        </div>
                        
                        <div class="admin-card" onclick="showRevenueReport()">
                            <i class="fas fa-money-bill-wave"></i>
                            <h4>Revenue</h4>
                            <p class="text-muted">Earnings report</p>
                        </div>
                        
                        <div class="admin-card" onclick="exportAllData()">
                            <i class="fas fa-download"></i>
                            <h4>Export Data</h4>
                            <p class="text-muted">Download reports</p>
                        </div>
                    </div>
                ` : `
                    <div class="text-center py-12">
                        <i class="fas fa-calendar-plus" style="font-size: 4rem; color: var(--gray-light); margin-bottom: var(--space-md);"></i>
                        <h3 class="mb-2">No Events Hosted Yet</h3>
                        <p class="text-muted mb-4">Create your first event to start managing</p>
                        <button class="btn btn-primary" onclick="startEventWizard()">
                            <i class="fas fa-plus"></i> Create First Event
                        </button>
                    </div>
                `}
            `;
        }

        function openEventManagement(eventId) {
            const event = MOCK_EVENTS.find(e => e.id === eventId);
            if (event) {
                state.currentEvent = event;
                showModal('adminDashboardModal');
            }
        }

        // ===== SAFETY SYSTEM =====
        function renderSafetyPage(container) {
            container.innerHTML = `
                <h2 class="mb-4">Safety Center</h2>
                
                <div class="card mb-4">
                    <div class="flex items-center gap-3 mb-3">
                        <div style="width: 50px; height: 50px; border-radius: 50%; background: rgba(239, 68, 68, 0.2); display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-shield-alt" style="color: var(--red); font-size: 1.5rem;"></i>
                        </div>
                        <div>
                            <h3>Emergency Button</h3>
                            <p class="text-muted">Quick access in unsafe situations</p>
                        </div>
                    </div>
                    <button class="btn" style="background: var(--red); color: white; width: 100%;" onclick="triggerEmergency()">
                        <i class="fas fa-exclamation-triangle"></i> EMERGENCY
                    </button>
                </div>
                
                <div class="safety-tips">
                    <div class="safety-tip">
                        <i class="fas fa-user-check"></i>
                        <div>
                            <h4>Verify Profiles</h4>
                            <p class="text-muted">Always check for verified badges</p>
                        </div>
                    </div>
                    
                    <div class="safety-tip">
                        <i class="fas fa-map-marker-alt"></i>
                        <div>
                            <h4>Meet in Public</h4>
                            <p class="text-muted">Choose well-lit, public places</p>
                        </div>
                    </div>
                    
                    <div class="safety-tip">
                        <i class="fas fa-phone"></i>
                        <div>
                            <h4>Inform Friends</h4>
                            <p class="text-muted">Share your plans with someone</p>
                        </div>
                    </div>
                    
                    <div class="safety-tip">
                        <i class="fas fa-car"></i>
                        <div>
                            <h4>Arrange Transportation</h4>
                            <p class="text-muted">Plan your ride in advance</p>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-4">
                    <h3 class="mb-3">Report & Block</h3>
                    <div class="flex flex-col gap-2">
                        <button class="btn btn-outline" onclick="showModal('safetyReportModal')">
                            <i class="fas fa-flag"></i> Report a Concern
                        </button>
                        <button class="btn btn-outline" onclick="showBlockedUsers()">
                            <i class="fas fa-ban"></i> Blocked Users
                        </button>
                        <button class="btn btn-outline" onclick="showPrivacyControls()">
                            <i class="fas fa-lock"></i> Privacy Controls
                        </button>
                    </div>
                </div>
                
                <div class="card mt-4">
                    <h3 class="mb-3">Emergency Contacts</h3>
                    <p class="text-muted mb-3">Add trusted contacts for emergencies</p>
                    <button class="btn btn-outline btn-block" onclick="addEmergencyContact()">
                        <i class="fas fa-plus"></i> Add Emergency Contact
                    </button>
                </div>
            `;
        }

        function triggerEmergency() {
            if (confirm('This will share your location and alert authorities. Are you in immediate danger?')) {
                showToast('Emergency alert sent! Authorities notified.', 'success');
                // In a real app, this would send location to emergency services
            }
        }

        function submitSafetyReport() {
            const type = document.getElementById('reportType').value;
            const description = document.getElementById('reportDescription').value;
            const anonymous = document.getElementById('reportAnonymously').checked;
            
            showToast('Safety report submitted. Our team will review it within 24 hours.', 'success');
            hideModal('safetyReportModal');
            
            // In a real app, this would send to backend
            console.log('Safety report:', { type, description, anonymous });
        }

        // ===== OTHER PAGE RENDERERS (simplified for brevity) =====
        function renderHomePage(container) {
            const upcomingEvents = MOCK_EVENTS.slice(0, 2);
            
            container.innerHTML = `
                <div class="hero-section">
                    <h1 class="hero-title">Amplify Your Connections at Live Events</h1>
                    <p class="hero-subtitle">Scan the QR code at any event to see who's there and connect instantly with verified attendees.</p>
                    
                    <div class="hero-cta">
                        ${state.isAuthenticated ? 
                            `<button class="btn btn-primary btn-large" onclick="showModal('qrScannerModal')">
                                <i class="fas fa-qrcode"></i> Scan Event QR Code
                            </button>
                            ${state.userTier === 'free' ? `
                                <button class="btn btn-pro btn-large" onclick="navigateTo('pricing')">
                                    <i class="fas fa-crown"></i> Upgrade to Pro
                                </button>
                            ` : ''}` :
                            `<button class="btn btn-primary btn-large" onclick="navigateTo('auth')">
                                <i class="fas fa-user-plus"></i> Get Started Free
                            </button>
                            <button class="btn btn-glass btn-large" onclick="demoLogin()">
                                <i class="fas fa-play-circle"></i> Try Demo
                            </button>`
                        }
                    </div>
                </div>
                
                <div class="features-grid">
                    <div class="feature">
                        <div class="feature-icon">
                            <i class="fas fa-qrcode"></i>
                        </div>
                        <h3>Scan & Join</h3>
                        <p class="text-muted">Scan QR codes at events to join instantly</p>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">
                            <i class="fas fa-camera"></i>
                        </div>
                        <h3>Live Photos</h3>
                        <p class="text-muted">Real-time verification with live selfies</p>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <h3>Smart Matching</h3>
                        <p class="text-muted">AI-powered connections at events</p>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3>Verified Safety</h3>
                        <p class="text-muted">Secure and verified interactions</p>
                    </div>
                </div>
                
                <div class="section-spacing">
                    <h2 class="mb-3">Featured Events</h2>
                    <p class="text-muted mb-4">Join trending events near you</p>
                    
                    <div class="events-grid">
                        ${upcomingEvents.map(event => `
                            <div class="event-card" onclick="viewEvent(${event.id})">
                                <div class="event-card-header">
                                    <div>
                                        <h3 class="mb-2">${event.name}</h3>
                                        <p class="text-muted">
                                            <i class="fas fa-map-marker-alt"></i> ${event.location}
                                        </p>
                                    </div>
                                    <button class="bookmark-button ${event.bookmarked ? 'active' : ''}" onclick="toggleBookmark(${event.id}); event.stopPropagation()">
                                        <i class="fas fa-bookmark"></i>
                                    </button>
                                </div>
                                
                                <p class="text-muted mb-3">${event.description.substring(0, 80)}...</p>
                                
                                <div class="event-info">
                                    <i class="fas fa-calendar"></i>
                                    <span>${event.date}  ${event.time}</span>
                                </div>
                                <div class="event-info">
                                    <i class="fas fa-users"></i>
                                    <span>${event.attendees} attending</span>
                                </div>
                                
                                ${event.geoFenced ? `
                                    <div class="event-info">
                                        <i class="fas fa-map-pin"></i>
                                        <span class="geo-fencing-badge">Geo-fenced</span>
                                    </div>
                                ` : ''}
                                
                                <button class="btn btn-primary btn-block mt-3">
                                    <i class="fas fa-eye"></i> View Details
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                ${!state.isAuthenticated ? `
                    <div class="card mt-5 text-center">
                        <h3 class="mb-3">Ready to Amplify Your Connections?</h3>
                        <p class="text-muted mb-4">Join thousands who are making meaningful connections at events</p>
                        <button class="btn btn-primary btn-large" onclick="navigateTo('auth')">
                            <i class="fas fa-rocket"></i> Start Free
                        </button>
                    </div>
                ` : ''}
            `;
        }

        function renderDashboardPage(container) {
            const eventsAttended = 12;
            const totalMatches = state.matches.length;
            const responseRate = '89%';
            const remainingLikes = state.userTier === 'free' ? 
                Math.max(0, state.dailyLikes - state.dailyLikesUsed) : '';
            
            container.innerHTML = `
                <div class="dashboard-header">
                    <div class="user-info">
                        <div class="user-avatar ${state.userTier === 'pro' ? 'pro' : state.userTier === 'max' ? 'pro-plus' : ''}" 
                             style="background-image: url('${state.userProfile.profilePhoto}');">
                            ${state.userTier === 'pro' ? 
                                '<div class="pro-badge" style="position: absolute; bottom: -8px; right: -8px; font-size: 0.625rem;"><i class="fas fa-crown"></i></div>' : 
                                state.userTier === 'max' ? 
                                '<div class="pro-plus-badge" style="position: absolute; bottom: -8px; right: -8px; font-size: 0.625rem;"><i class="fas fa-star"></i></div>' : ''}
                        </div>
                        <div class="user-details">
                            <h2>${state.userProfile.name}</h2>
                            <p class="text-gradient">${state.userProfile.occupation} at ${state.userProfile.company}</p>
                            ${state.userTier === 'pro' ? 
                                '<div class="pro-badge mt-1"><i class="fas fa-crown"></i> PRO</div>' : 
                                state.userTier === 'max' ?
                                '<div class="pro-plus-badge mt-1"><i class="fas fa-star"></i> MAX</div>' :
                                '<div class="free-badge mt-1"><i class="fas fa-user"></i> FREE</div>'
                            }
                        </div>
                    </div>
                    <button class="btn btn-outline btn-small" onclick="showNotifications()">
                        <i class="fas fa-bell"></i>
                    </button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${eventsAttended}</div>
                        <div class="stat-label">Events Attended</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${totalMatches}</div>
                        <div class="stat-label">Total Matches</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${responseRate}</div>
                        <div class="stat-label">Response Rate</div>
                    </div>
                </div>
                
                <h3 class="mt-4 mb-3">Quick Actions</h3>
                <div class="quick-actions">
                    <div class="action-card primary" onclick="startEventWizard()">
                        <i class="fas fa-plus-circle"></i>
                        <h4>Create Event</h4>
                        <p class="text-muted">${state.userTier === 'max' ? 'Set up a new event' : 'Upgrade to create events'}</p>
                        ${state.userTier !== 'max' ? '<div class="pro-badge mt-2">MAX</div>' : ''}
                    </div>
                    
                    <div class="action-card blue" onclick="showModal('qrScannerModal')">
                        <i class="fas fa-qrcode"></i>
                        <h4>Scan QR</h4>
                        <p class="text-muted">Join an event</p>
                    </div>
                    
                    <div class="action-card pink" onclick="navigateTo('matches')">
                        <i class="fas fa-heart"></i>
                        <h4>My Matches</h4>
                        <p class="text-muted">${state.matches.length} matches</p>
                    </div>
                    
                    <div class="action-card gold" onclick="navigateTo('bookmarks')">
                        <i class="fas fa-bookmark"></i>
                        <h4>Bookmarks</h4>
                        <p class="text-muted">${state.bookmarkedEvents.length} saved</p>
                    </div>
                </div>
                
                <h3 class="mt-5 mb-3">Active Events Near You</h3>
                <div class="event-list">
                    ${MOCK_EVENTS.slice(0, 2).map(event => `
                        <div class="event-item" onclick="viewEvent(${event.id})">
                            <div class="event-item-icon">
                                <i class="fas fa-calendar"></i>
                            </div>
                            <div class="event-item-content">
                                <h4 class="event-item-title">${event.name}</h4>
                                <p class="event-item-meta">${event.location}  ${event.time}</p>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm">${event.attendees} attending</span>
                                    <span class="text-sm text-muted">${event.date}</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(event.attendees / event.maxAttendees) * 100}%"></div>
                                </div>
                            </div>
                            <button class="btn btn-primary btn-small" onclick="event.stopPropagation(); handleRSVP(${event.id})">
                                ${event.rsvp === 'going' ? 'Joined' : 'Join'}
                            </button>
                        </div>
                    `).join('')}
                </div>
                
                <div class="achievements-section mt-5">
                    <h3 class="mb-3">Recent Achievements</h3>
                    <div class="achievements-grid">
                        ${MOCK_ACHIEVEMENTS.filter(a => a.unlocked).slice(0, 3).map(achievement => `
                            <div class="achievement-card">
                                <div class="achievement-icon">
                                    <i class="fas ${achievement.icon}"></i>
                                </div>
                                <h4 class="achievement-title">${achievement.title}</h4>
                                <p class="achievement-desc">${achievement.description}</p>
                            </div>
                        `).join('')}
                    </div>
                    <button class="btn btn-outline btn-block mt-3" onclick="navigateTo('achievements')">
                        View All Achievements
                    </button>
                </div>
            `;
        }

        function renderEventsPage(container) {
            container.innerHTML = `
                <div class="section-header flex justify-between items-center mb-4">
                    <h2>Events</h2>
                    <button class="btn btn-outline btn-small" onclick="showModal('filtersModal')">
                        <i class="fas fa-filter"></i> Filters
                    </button>
                </div>
                
                <div class="filters-bar">
                    <button class="filter-btn active">All</button>
                    <button class="filter-btn">Today</button>
                    <button class="filter-btn">This Week</button>
                    <button class="filter-btn">Networking</button>
                    <button class="filter-btn">Parties</button>
                    <button class="filter-btn">Free</button>
                </div>
                
                ${state.userTier === 'max' ? `
                    <div class="card mb-4">
                        <div class="flex justify-between items-center">
                            <div>
                                <h3>Create New Event</h3>
                                <p class="text-muted">Set up a new event with QR code</p>
                            </div>
                            <button class="btn btn-primary" onclick="startEventWizard()">
                                <i class="fas fa-plus"></i> Create
                            </button>
                        </div>
                    </div>
                ` : ''}
                
                <div class="events-grid">
                    ${MOCK_EVENTS.map(event => `
                        <div class="event-card" onclick="viewEvent(${event.id})">
                            <div class="event-card-header">
                                <div>
                                    <h3 class="mb-2">${event.name}</h3>
                                    <p class="text-gradient">${event.category}</p>
                                </div>
                                <button class="bookmark-button ${event.bookmarked ? 'active' : ''}" onclick="toggleBookmark(${event.id}); event.stopPropagation()">
                                    <i class="fas fa-bookmark"></i>
                                </button>
                            </div>
                            
                            <div style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(236, 72, 153, 0.2)); padding: 12px; border-radius: 12px; margin-bottom: 12px;">
                                <p class="text-muted">${event.description.substring(0, 120)}...</p>
                            </div>
                            
                            <div class="event-info">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${event.location}</span>
                            </div>
                            <div class="event-info">
                                <i class="fas fa-calendar"></i>
                                <span>${event.date}  ${event.time}</span>
                            </div>
                            <div class="event-info">
                                <i class="fas fa-users"></i>
                                <span>${event.attendees} / ${event.maxAttendees} attending</span>
                            </div>
                            
                            ${event.geoFenced ? `
                                <div class="event-info">
                                    <i class="fas fa-map-pin"></i>
                                    <span class="geo-fencing-badge">Geo-fenced</span>
                                </div>
                            ` : ''}
                            
                            <div class="event-tags mt-3">
                                ${event.tags.slice(0, 3).map(tag => `
                                    <span class="event-tag">${tag}</span>
                                `).join('')}
                            </div>
                            
                            <div class="flex gap-2 mt-3">
                                <button class="btn btn-primary flex-1" onclick="event.stopPropagation(); handleRSVP(${event.id})">
                                    ${event.rsvp === 'going' ? 'Joined' : 'RSVP'}
                                </button>
                                <button class="btn btn-outline btn-icon" onclick="event.stopPropagation(); toggleBookmark(${event.id})">
                                    <i class="fas ${event.bookmarked ? 'fa-bookmark' : 'fa-bookmark'}"></i>
                                </button>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="pagination">
                    <button class="page-button active">1</button>
                    <button class="page-button">2</button>
                    <button class="page-button">3</button>
                </div>
            `;
        }

        // ===== INITIALIZATION =====
        function init() {
            console.log('Initializing app...');
            
            // Load saved state from localStorage
            const savedUser = localStorage.getItem('amps_user');
            const savedTier = localStorage.getItem('amps_userTier');
            const savedUserProfile = localStorage.getItem('amps_userProfile');
            const savedIsAuthenticated = localStorage.getItem('amps_isAuthenticated');
            const savedBookmarks = localStorage.getItem('amps_bookmarkedEvents');
            
            if (savedUser) state.currentUser = JSON.parse(savedUser);
            if (savedTier) state.userTier = savedTier;
            if (savedUserProfile) state.userProfile = JSON.parse(savedUserProfile);
            if (savedIsAuthenticated === 'true') state.isAuthenticated = true;
            if (savedBookmarks) state.bookmarkedEvents = JSON.parse(savedBookmarks);
            
            // Set up event RSVPs from bookmarks
            state.bookmarkedEvents.forEach(eventId => {
                const eventIndex = MOCK_EVENTS.findIndex(e => e.id === eventId);
                if (eventIndex > -1) {
                    MOCK_EVENTS[eventIndex].bookmarked = true;
                }
            });
            
            renderPage();
            updateNavigation();
            
            // Start real-time simulation
            simulateWebSocketConnection();
            
            console.log('App initialized successfully');
        }
        // ===== MISSING FUNCTION IMPLEMENTATIONS =====

        function demoLogin() {
            state.isAuthenticated = true;
            state.userTier = 'free';
            state.userProfile = {
                name: 'Demo User',
                email: 'demo@amps.com',
                age: 28,
                occupation: 'Software Engineer',
                company: 'Tech Corp',
                bio: 'Passionate about technology and building meaningful connections at events.',
                interests: ['Technology', 'Music', 'Travel', 'Fitness', 'Photography'],
                profilePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%238B5CF6"/><text x="100" y="120" font-size="24" text-anchor="middle" fill="white">User</text></svg>',
                phone: '+264 81 123 4567',
                location: 'San Francisco, CA',
                gender: 'male',
                visibility: 'public'
            };
            
            localStorage.setItem('amps_isAuthenticated', 'true');
            localStorage.setItem('amps_userTier', 'free');
            localStorage.setItem('amps_userProfile', JSON.stringify(state.userProfile));
            
            showToast('Demo login successful! Welcome back.', 'success');
            navigateTo('dashboard');
        }
        
        function upgradeToPro() {
            if (state.userTier === 'pro') {
                showToast('You are already a Pro member!', 'info');
                return;
            }
            
            showModal('paymentModal');
            document.getElementById('paymentAmount').textContent = '$14.99';
            document.getElementById('paymentEventName').textContent = 'Pro Upgrade';
            document.getElementById('paymentType').textContent = 'Monthly subscription';
        }
        
        function changeTier(tier) {
            state.userTier = tier;
            localStorage.setItem('amps_userTier', tier);
            
            if (tier === 'max') {
                state.dailyLikes = Infinity;
                state.superLikes = 5;
            } else if (tier === 'pro') {
                state.dailyLikes = 100;
                state.superLikes = 3;
            } else {
                state.dailyLikes = 30;
                state.superLikes = 1;
            }
            
            showToast(`Upgraded to ${tier} tier!`, 'success');
            renderPage();
        }
        
        function logout() {
            state.isAuthenticated = false;
            state.currentUser = null;
            
            localStorage.removeItem('amps_user');
            localStorage.removeItem('amps_isAuthenticated');
            
            showToast('Logged out successfully', 'success');
            navigateTo('home');
        }
        
        function viewEvent(eventId) {
            const event = MOCK_EVENTS.find(e => e.id === eventId);
            if (event) {
                state.currentEvent = event;
                navigateTo('event-detail');
            }
        }
        
        function renderEventDetailPage(container) {
            if (!state.currentEvent) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <h3>Event not found</h3>
                        <button class="btn btn-primary mt-3" onclick="navigateTo('events')">
                            Browse Events
                        </button>
                    </div>
                `;
                return;
            }
            
            const event = state.currentEvent;
            container.innerHTML = `
                <div class="event-detail-header">
                    <div style="position: absolute; bottom: 20px; left: 20px; right: 20px;">
                        <h2 class="mb-2">${event.name}</h2>
                        <p class="text-muted">${event.category}  Hosted by ${event.host}</p>
                    </div>
                </div>
                
                <div class="event-detail-content">
                    <div class="flex justify-between items-center mb-4">
                        <div class="flex items-center gap-2">
                            <span class="badge ${event.attendees >= event.maxAttendees * 0.8 ? 'live-badge' : 'free-badge'}">
                                ${event.attendees}/${event.maxAttendees} attending
                            </span>
                            ${event.geoFenced ? '<span class="geo-fencing-badge">Geo-fenced</span>' : ''}
                        </div>
                        <button class="btn btn-outline btn-small" onclick="toggleBookmark(${event.id})">
                            <i class="fas ${event.bookmarked ? 'fa-bookmark' : 'fa-bookmark'}"></i>
                        </button>
                    </div>
                    
                    <h3 class="mb-3">About this event</h3>
                    <p class="mb-4">${event.description}</p>
                    
                    <div class="card mb-4">
                        <h4 class="mb-2">Event Details</h4>
                        <div class="event-info">
                            <i class="fas fa-calendar"></i>
                            <span>${event.date}  ${event.time}</span>
                        </div>
                        <div class="event-info">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>${event.location}</span>
                        </div>
                        <div class="event-info">
                            <i class="fas fa-users"></i>
                            <span>${event.ageRange}  ${event.genderPreference}</span>
                        </div>
                        <div class="event-info">
                            <i class="fas fa-tag"></i>
                            <span>${event.price > 0 ? '$' + event.price + ' ticket' : 'Free admission'}</span>
                        </div>
                    </div>
                    
                    <div class="event-tags mb-4">
                        ${event.tags.map(tag => `<span class="event-tag">${tag}</span>`).join('')}
                    </div>
                    
                    <div class="rsvp-buttons">
                        <button class="rsvp-button ${event.rsvp === 'going' ? 'active' : ''}" onclick="updateRSVP('going')">
                            Going
                        </button>
                        <button class="rsvp-button ${event.rsvp === 'interested' ? 'active' : ''}" onclick="updateRSVP('interested')">
                            Interested
                        </button>
                        <button class="rsvp-button ${event.rsvp === 'not-going' ? 'active' : ''}" onclick="updateRSVP('not-going')">
                            Not Going
                        </button>
                    </div>
                    
                    <button class="btn btn-primary btn-block mt-4" onclick="joinEvent(${event.id})">
                        <i class="fas fa-qrcode"></i> Join Event
                    </button>
                    
                    <div class="flex gap-2 mt-3">
                        <button class="btn btn-outline flex-1" onclick="openEventPhotos(${event.id})">
                            <i class="fas fa-images"></i> Photos
                        </button>
                        <button class="btn btn-outline flex-1" onclick="shareEvent(${event.id})">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                    </div>
                    
                    ${event.host === state.userProfile.name ? `
                        <div class="card mt-4">
                            <h4 class="mb-2">Host Dashboard</h4>
                            <p class="text-muted mb-3">Manage your event</p>
                            <button class="btn btn-outline btn-block" onclick="showModal('adminDashboardModal')">
                                <i class="fas fa-cog"></i> Manage Event
                            </button>
                        </div>
                    ` : ''}
                </div>
            `;
        }
        
        function handleRSVP(eventId) {
            const event = MOCK_EVENTS.find(e => e.id === eventId);
            if (!event) return;
            
            if (event.rsvp === 'none') {
                event.rsvp = 'interested';
                showToast('Marked as interested', 'success');
            } else if (event.rsvp === 'interested') {
                event.rsvp = 'going';
                event.attendees++;
                showToast('RSVP confirmed! You are going to this event', 'success');
            } else if (event.rsvp === 'going') {
                event.rsvp = 'none';
                event.attendees = Math.max(0, event.attendees - 1);
                showToast('RSVP removed', 'info');
            }
            
            renderPage();
        }
        
        function updateRSVP(status) {
            if (!state.currentEvent) return;
            
            state.currentEvent.rsvp = status;
            if (status === 'going') {
                state.currentEvent.attendees++;
            } else if (state.currentEvent.rsvp === 'going') {
                state.currentEvent.attendees = Math.max(0, state.currentEvent.attendees - 1);
            }
            
            showToast(`RSVP updated to "${status}"`, 'success');
            renderPage();
        }
        
        function toggleBookmark(eventId) {
            const eventIndex = MOCK_EVENTS.findIndex(e => e.id === eventId);
            if (eventIndex === -1) return;
            
            MOCK_EVENTS[eventIndex].bookmarked = !MOCK_EVENTS[eventIndex].bookmarked;
            
            if (MOCK_EVENTS[eventIndex].bookmarked) {
                if (!state.bookmarkedEvents.includes(eventId)) {
                    state.bookmarkedEvents.push(eventId);
                }
                showToast('Event bookmarked', 'success');
            } else {
                const index = state.bookmarkedEvents.indexOf(eventId);
                if (index > -1) {
                    state.bookmarkedEvents.splice(index, 1);
                }
                showToast('Event removed from bookmarks', 'info');
            }
            
            localStorage.setItem('amps_bookmarkedEvents', JSON.stringify(state.bookmarkedEvents));
            renderPage();
        }
        
        function joinEvent(eventId) {
            const event = MOCK_EVENTS.find(e => e.id === eventId);
            if (!event) return;
            
            if (!state.isAuthenticated) {
                showToast('Please sign in to join events', 'warning');
                navigateTo('auth');
                return;
            }
            
            // Check if user has RSVP'd
            if (event.rsvp !== 'going') {
                event.rsvp = 'going';
                event.attendees++;
                showToast('You have joined the event!', 'success');
            }
            
            // Check geo-fencing
            if (event.geoFenced) {
                getLocation().then(location => {
                    const inRange = checkGeoFence(event, location);
                    if (inRange) {
                        navigateTo('swipe', event);
                    } else {
                        showToast('You are not within the event geo-fence', 'warning');
                    }
                }).catch(error => {
                    console.error('Location error:', error);
                    navigateTo('swipe', event);
                });
            } else {
                navigateTo('swipe', event);
            }
        }
        
        function startCameraScanning() {
            requestCameraPermission().then(success => {
                if (success) {
                    showToast('Camera started. Point at QR code', 'info');
                    // Simulate QR scan after 2 seconds
                    setTimeout(() => {
                        hideModal('qrScannerModal');
                        simulateQRScan();
                    }, 2000);
                }
            });
        }
        
        function enterEventCode() {
            const code = prompt('Enter 6-digit event code:');
            if (code && code.length === 6) {
                hideModal('qrScannerModal');
                showToast(`Joining event with code: ${code}`, 'info');
                
                // Simulate finding event
                setTimeout(() => {
                    const event = MOCK_EVENTS[0];
                    if (event) {
                        state.currentEvent = event;
                        showModal('privacyModal');
                    } else {
                        showToast('Event not found', 'error');
                    }
                }, 1000);
            }
        }
        
        function selectPrivacyMode(mode) {
            state.privacyMode = mode;
            const options = document.querySelectorAll('.privacy-option');
            options.forEach(opt => opt.classList.remove('selected'));
            event.target.closest('.privacy-option').classList.add('selected');
        }
        
        function continueToEvent() {
            hideModal('privacyModal');
            if (state.currentEvent) {
                navigateTo('swipe', state.currentEvent);
            }
        }
        
        function toggleFilterOption(button, filterType, value) {
            const buttons = button.parentElement.querySelectorAll('.filter-option');
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            state.eventFilters[filterType] = value;
        }
        
        function applyEventFilters() {
            hideModal('filtersModal');
            
            const ageMin = parseInt(document.getElementById('ageMin').value) || 18;
            const ageMax = parseInt(document.getElementById('ageMax').value) || 35;
            state.eventFilters.ageMin = ageMin;
            state.eventFilters.ageMax = ageMax;
            
            state.eventFilters.askEachTime = document.getElementById('askEachTime').checked;
            
            showToast('Filters applied', 'success');
            renderPage();
        }
        
        function takeLivePhoto() {
            openCameraForSelfie();
        }
        
        function openCameraForSelfie() {
            showModal('cameraModal');
            requestCameraPermission();
        }
        
        function closeCamera() {
            if (state.cameraStream) {
                state.cameraStream.getTracks().forEach(track => track.stop());
                state.cameraStream = null;
            }
            hideModal('cameraModal');
        }
        
        function switchCamera() {
            state.facingMode = state.facingMode === 'user' ? 'environment' : 'user';
            closeCamera();
            setTimeout(() => {
                openCameraForSelfie();
            }, 100);
        }
        
        function takePhoto() {
            const video = document.getElementById('cameraVideo');
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0);
            
            state.livePhoto = canvas.toDataURL('image/jpeg');
            closeCamera();
            showToast('Live photo taken!', 'success');
            
            // Update user profile photo
            state.userProfile.profilePhoto = state.livePhoto;
            localStorage.setItem('amps_userProfile', JSON.stringify(state.userProfile));
            
            if (state.currentPage === 'profile') {
                renderPage();
            }
        }
        
        // Swipe functions
        function swipeLeft() {
            const card = document.querySelector('.profile-card:last-child');
            if (card) {
                card.style.transform = `translateX(-500px) rotate(-30deg)`;
                card.style.opacity = '0';
                
                setTimeout(() => {
                    state.currentProfileIndex++;
                    if (state.currentProfileIndex >= MOCK_PROFILES.length) {
                        state.currentProfileIndex = 0;
                    }
                    renderSwipePage(document.getElementById('content'));
                }, 300);
                
                showToast('Passed', 'info');
            }
        }
        
        function swipeRight() {
            const card = document.querySelector('.profile-card:last-child');
            if (card) {
                card.style.transform = `translateX(500px) rotate(30deg)`;
                card.style.opacity = '0';
                
                setTimeout(() => {
                    // Simulate match 30% of the time
                    if (Math.random() < 0.3) {
                        showMatchModal();
                    }
                    
                    state.currentProfileIndex++;
                    if (state.currentProfileIndex >= MOCK_PROFILES.length) {
                        state.currentProfileIndex = 0;
                    }
                    renderSwipePage(document.getElementById('content'));
                }, 300);
                
                showToast('Liked!', 'success');
            }
        }
        
        function superLike() {
            if (state.superLikes > 0) {
                state.superLikes--;
                const card = document.querySelector('.profile-card:last-child');
                if (card) {
                    card.style.transform = `translateY(-500px)`;
                    card.style.opacity = '0';
                    
                    setTimeout(() => {
                        showMatchModal();
                        state.currentProfileIndex++;
                        if (state.currentProfileIndex >= MOCK_PROFILES.length) {
                            state.currentProfileIndex = 0;
                        }
                        renderSwipePage(document.getElementById('content'));
                    }, 300);
                    
                    showToast('Super Like sent! ', 'success');
                }
            } else {
                showToast('No super likes remaining', 'warning');
            }
        }
        
        function undoSwipe() {
            if (state.swipeHistory.length > 0) {
                const lastSwipe = state.swipeHistory.pop();
                state.currentProfileIndex = Math.max(0, state.currentProfileIndex - 1);
                renderSwipePage(document.getElementById('content'));
                showToast('Undo successful', 'info');
            } else {
                showToast('No swipes to undo', 'info');
            }
        }
        
        function resetSwipes() {
            state.currentProfileIndex = 0;
            renderSwipePage(document.getElementById('content'));
            showToast('Swipes reset', 'info');
        }
        
        function clearFilters() {
            state.eventFilters = {
                lookingFor: 'dating',
                gender: 'all',
                ageMin: 18,
                ageMax: 35,
                askEachTime: true
            };
            renderPage();
            showToast('Filters cleared', 'info');
        }
        
        function showMatchModal() {
            const matchProfile = MOCK_PROFILES[state.currentProfileIndex];
            if (matchProfile) {
                document.getElementById('matchName').textContent = matchProfile.name;
                document.getElementById('matchMessage').textContent = `You and ${matchProfile.name} liked each other at ${state.currentEvent?.name || 'the event'}!`;
                
                // Add to matches
                if (!state.matches.some(m => m.id === matchProfile.id)) {
                    state.matches.push({
                        ...matchProfile,
                        timestamp: new Date().toISOString(),
                        unread: true
                    });
                }
                
                showModal('matchModal');
            }
        }
        
        function startChat() {
            hideModal('matchModal');
            const matchProfile = MOCK_PROFILES[state.currentProfileIndex];
            if (matchProfile) {
                navigateTo('chat', { userId: matchProfile.id });
            }
        }
        
        // Page renderers
        function renderMatchesPage(container) {
            container.innerHTML = `
                <h2 class="mb-4">Matches (${state.matches.length})</h2>
                
                ${state.matches.length > 0 ? `
                    <div class="attendee-list">
                        ${state.matches.map(match => `
                            <div class="attendee-item" onclick="openChat(${match.id})">
                                <div class="attendee-avatar" style="background-image: url('${match.livePhoto}');"></div>
                                <div class="attendee-info">
                                    <h4>${match.name}, ${match.age}</h4>
                                    <p class="text-muted">${match.bio.substring(0, 40)}...</p>
                                    <div class="attendee-status">
                                        <span class="status-${match.online ? 'online' : 'away'}">
                                            <i class="fas fa-circle"></i> ${match.online ? 'Online' : 'Away'}
                                        </span>
                                        <span> ${match.distance}</span>
                                    </div>
                                </div>
                                ${match.unread ? '<span class="badge live-badge">New</span>' : ''}
                            </div>
                        `).join('')}
                    </div>
                ` : `
                    <div class="text-center py-12">
                        <i class="fas fa-heart" style="font-size: 4rem; color: var(--gray-light); margin-bottom: var(--space-md);"></i>
                        <h3 class="mb-2">No Matches Yet</h3>
                        <p class="text-muted mb-4">Start swiping at events to find matches</p>
                        <button class="btn btn-primary" onclick="navigateTo('events')">
                            <i class="fas fa-calendar"></i> Find Events
                        </button>
                    </div>
                `}
                
                ${state.matches.some(m => m.unread) ? `
                    <button class="btn btn-outline btn-block mt-4" onclick="markAllAsRead()">
                        <i class="fas fa-check"></i> Mark All as Read
                    </button>
                ` : ''}
            `;
        }
        
        function renderProfilePage(container) {
            container.innerHTML = `
                <div class="profile-header">
                    <div class="user-avatar ${state.userTier === 'pro' ? 'pro' : state.userTier === 'max' ? 'pro-plus' : ''}" 
                         style="background-image: url('${state.userProfile.profilePhoto}'); cursor: pointer;" 
                         onclick="changeProfilePhoto()">
                        <div style="position: absolute; bottom: 0; right: 0; background: rgba(0,0,0,0.7); padding: 4px 8px; border-radius: 12px;">
                            <i class="fas fa-camera"></i>
                        </div>
                    </div>
                    <h2>${state.userProfile.name}, ${state.userProfile.age}</h2>
                    <p class="text-gradient">${state.userProfile.occupation} at ${state.userProfile.company}</p>
                    <div class="flex justify-center gap-2 mt-2">
                        ${state.userTier === 'pro' ? 
                            '<div class="pro-badge"><i class="fas fa-crown"></i> PRO</div>' : 
                            state.userTier === 'max' ?
                            '<div class="pro-plus-badge"><i class="fas fa-star"></i> MAX</div>' :
                            '<div class="free-badge"><i class="fas fa-user"></i> FREE</div>'
                        }
                        <div class="badge" style="background: rgba(139, 92, 246, 0.2); color: var(--purple-light);">
                            <i class="fas fa-shield-alt"></i> Verified
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <h4 class="mb-2">About Me</h4>
                    <p>${state.userProfile.bio}</p>
                </div>
                
                <div class="card mb-4">
                    <h4 class="mb-2">Interests</h4>
                    <div class="flex flex-wrap gap-2">
                        ${state.userProfile.interests.map(interest => `
                            <span class="event-tag">${interest}</span>
                        `).join('')}
                    </div>
                </div>
                
                <div class="card mb-4">
                    <h4 class="mb-2">Contact Info</h4>
                    <div class="event-info">
                        <i class="fas fa-envelope"></i>
                        <span>${state.userProfile.email}</span>
                    </div>
                    <div class="event-info">
                        <i class="fas fa-phone"></i>
                        <span>${state.userProfile.phone}</span>
                    </div>
                    <div class="event-info">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>${state.userProfile.location}</span>
                    </div>
                </div>
                
                <div class="flex flex-col gap-2">
                    <button class="btn btn-primary" onclick="editProfile()">
                        <i class="fas fa-edit"></i> Edit Profile
                    </button>
                    <button class="btn btn-outline" onclick="showPrivacySettings()">
                        <i class="fas fa-lock"></i> Privacy Settings
                    </button>
                    ${state.userTier === 'free' ? `
                        <button class="btn btn-pro" onclick="navigateTo('pricing')">
                            <i class="fas fa-crown"></i> Upgrade to Pro
                        </button>
                    ` : ''}
                    <button class="btn btn-outline" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Log Out
                    </button>
                </div>
            `;
        }
        
        function renderSwipePage(container) {
            if (!state.currentEvent) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <h3>No event selected</h3>
                        <button class="btn btn-primary mt-3" onclick="navigateTo('events')">
                            Find an Event
                        </button>
                    </div>
                `;
                return;
            }
            
            const currentProfile = MOCK_PROFILES[state.currentProfileIndex % MOCK_PROFILES.length];
            
            container.innerHTML = `
                <div class="swipe-container">
                    <div class="swipe-header">
                        <span class="event-badge">${state.currentEvent.name}</span>
                        <h3>Connect with Attendees</h3>
                        <p class="text-muted">
                            ${state.userTier === 'free' ? `${Math.max(0, state.dailyLikes - state.dailyLikesUsed)} likes left today` : 'Unlimited likes'}
                            ${state.superLikes > 0 ? `  ${state.superLikes} super likes` : ''}
                        </p>
                    </div>
                    
                    <div class="card-stack">
                        <div class="swipe-overlay like" id="likeOverlay">LIKE</div>
                        <div class="swipe-overlay nope" id="nopeOverlay">NOPE</div>
                        <div class="swipe-overlay super" id="superOverlay">SUPER!</div>
                        
                        <div class="card-container">
                            ${MOCK_PROFILES.slice(state.currentProfileIndex, state.currentProfileIndex + 3).map((profile, index) => `
                                <div class="profile-card" style="z-index: ${3 - index}; ${index > 0 ? 'transform: scale(' + (1 - index * 0.05) + ') translateY(' + (index * 10) + 'px);' : ''}">
                                    <div class="card-content" style="background: ${profile.cardColor};">
                                        <div class="card-frame"></div>
                                        
                                        <div class="profile-image" style="background-image: url('${profile.livePhoto}');">
                                            ${profile.verified ? `
                                                <div style="position: absolute; top: 10px; right: 10px; background: var(--blue); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                                    <i class="fas fa-check"></i>
                                                </div>
                                            ` : ''}
                                        </div>
                                        
                                        <div class="profile-info">
                                            <h2>${profile.name}, ${profile.age}</h2>
                                            <p>${profile.bio}</p>
                                            
                                            <div class="interests">
                                                ${profile.interests.slice(0, 4).map(interest => `
                                                    <div class="interest-tag">${interest}</div>
                                                `).join('')}
                                            </div>
                                            
                                            <div class="flex justify-between items-center mt-3">
                                                <div class="text-sm">
                                                    <i class="fas fa-map-marker-alt"></i>
                                                    <span>${profile.distance}  ${profile.location}</span>
                                                </div>
                                                <div class="text-sm">
                                                    <i class="fas fa-heart" style="color: var(--pink);"></i>
                                                    <span>${profile.compatibilityScore}% match</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="swipe-actions">
                        <button class="action-button undo" onclick="undoSwipe()" ${state.swipeHistory.length === 0 ? 'disabled style="opacity: 0.5;"' : ''}>
                            <i class="fas fa-undo"></i>
                        </button>
                        <button class="action-button nope" onclick="swipeLeft()">
                            <i class="fas fa-times"></i>
                        </button>
                        <button class="action-button super" onclick="superLike()" ${state.superLikes === 0 ? 'disabled style="opacity: 0.5;"' : ''}>
                            <i class="fas fa-star"></i>
                        </button>
                        <button class="action-button like" onclick="swipeRight()">
                            <i class="fas fa-heart"></i>
                        </button>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <p class="text-muted">Swipe right to like, left to pass</p>
                </div>
            `;
            
            // Add swipe functionality
            setupSwipeCards();
        }
        
        function renderChatPage(container) {
            const chatData = state.chatMessages[state.currentChatId] || [];
            
            container.innerHTML = `
                <div class="chat-container">
                    <div class="chat-header">
                        <button class="back-btn" onclick="navigateTo('matches')">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <div class="chat-avatar" style="background-image: url('${MOCK_PROFILES[0]?.livePhoto || ''}');"></div>
                        <div style="flex: 1;">
                            <h4>${MOCK_PROFILES[0]?.name || 'Match'}</h4>
                            <p class="text-muted">Online now</p>
                        </div>
                        <button class="btn btn-outline btn-small" onclick="showChatMenu()">
                            <i class="fas fa-ellipsis-h"></i>
                        </button>
                    </div>
                    
                    <div class="chat-messages" id="chatMessages">
                        ${chatData.map(msg => `
                            <div class="message ${msg.sender === 'me' ? 'sent' : 'received'}">
                                <div class="message-text">${msg.text}</div>
                                <div class="message-time">${msg.time}</div>
                            </div>
                        `).join('')}
                        
                        ${chatData.length === 0 ? `
                            <div class="text-center py-8">
                                <i class="fas fa-comments" style="font-size: 3rem; color: var(--gray-light); margin-bottom: var(--space-md);"></i>
                                <h4 class="mb-2">No messages yet</h4>
                                <p class="text-muted">Send a message to start the conversation!</p>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="chat-input">
                        <input type="text" class="form-control" id="messageInput" placeholder="Type a message..." onkeypress="handleMessageKeypress(event)">
                        <button class="btn btn-primary" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            `;
            
            // Scroll to bottom of chat
            setTimeout(() => {
                const chatMessages = document.getElementById('chatMessages');
                if (chatMessages) {
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }
            }, 100);
        }
        
        function renderAuthPage(container) {
            container.innerHTML = `
                <div class="auth-container">
                    <div class="text-center mb-5">
                        <h1 class="hero-title mb-2">Welcome Back</h1>
                        <p class="text-muted">Sign in to continue connecting at events</p>
                    </div>
                    
                    <div class="auth-tabs">
                        <button class="auth-tab active" onclick="switchAuthTab('signin')">Sign In</button>
                        <button class="auth-tab" onclick="switchAuthTab('signup')">Sign Up</button>
                    </div>
                    
                    <form id="authForm" onsubmit="handleAuth(event)">
                        <div id="authFields">
                            <!-- Fields will be loaded here based on tab -->
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-block">
                            Continue
                        </button>
                    </form>
                    
                    <div class="text-center mt-4">
                        <p class="text-muted">Or continue with</p>
                        <div class="flex justify-center gap-3 mt-3">
                            <button class="btn btn-glass" onclick="socialLogin('google')">
                                <i class="fab fa-google"></i>
                            </button>
                            <button class="btn btn-glass" onclick="socialLogin('facebook')">
                                <i class="fab fa-facebook"></i>
                            </button>
                            <button class="btn btn-glass" onclick="socialLogin('apple')">
                                <i class="fab fa-apple"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="text-center mt-5">
                        <button class="btn btn-outline" onclick="demoLogin()">
                            <i class="fas fa-play-circle"></i> Try Demo Mode
                        </button>
                    </div>
                </div>
            `;
            
            // Load initial tab
            switchAuthTab('signin');
        }
        
        function renderPricingPage(container) {
            container.innerHTML = `
                <div class="text-center mb-5">
                    <h1>Choose Your Plan</h1>
                    <p class="text-muted">Upgrade to unlock premium features</p>
                </div>
                
                <div class="pricing-grid">
                    <div class="pricing-card">
                        <div class="free-badge">FREE</div>
                        <h3 class="text-center mb-2">$0/month</h3>
                        <p class="text-center text-muted mb-3">Basic features</p>
                        <div class="flex flex-col gap-2 mb-3">
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>30 likes/day per event</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>Basic matching</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>Attend events</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-times" style="color: var(--gray-light);"></i>
                                <span>See who liked you</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-times" style="color: var(--gray-light);"></i>
                                <span>Create events</span>
                            </div>
                        </div>
                        <button class="btn btn-outline btn-block" onclick="changeTier('free')" ${state.userTier === 'free' ? 'disabled' : ''}>
                            ${state.userTier === 'free' ? 'Current Plan' : 'Select Free'}
                        </button>
                    </div>
                    
                    <div class="pricing-card featured">
                        <div class="pro-badge">PRO</div>
                        <h3 class="text-center mb-2">$14.99/month</h3>
                        <p class="text-center text-muted mb-3">Best for regular attendees</p>
                        <div class="flex flex-col gap-2 mb-3">
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>Unlimited likes</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>See who liked you</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>5 super likes/day</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>Advanced filters</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-times" style="color: var(--gray-light);"></i>
                                <span>Create events</span>
                            </div>
                        </div>
                        <button class="btn btn-pro btn-block" onclick="upgradeToPro()" ${state.userTier === 'pro' ? 'disabled' : ''}>
                            ${state.userTier === 'pro' ? 'Current Plan' : 'Upgrade to Pro'}
                        </button>
                    </div>
                    
                    <div class="pricing-card">
                        <div class="pro-plus-badge">MAX</div>
                        <h3 class="text-center mb-2">$29.99/month</h3>
                        <p class="text-center text-muted mb-3">For event creators & hosts</p>
                        <div class="flex flex-col gap-2 mb-3">
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>All Pro features</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>Create unlimited events</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>Custom QR codes</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>Analytics dashboard</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-check" style="color: var(--green);"></i>
                                <span>Geo-fencing</span>
                            </div>
                        </div>
                        <button class="btn btn-pro-plus btn-block" onclick="showPaymentModal('max')" ${state.userTier === 'max' ? 'disabled' : ''}>
                            ${state.userTier === 'max' ? 'Current Plan' : 'Upgrade to Max'}
                        </button>
                    </div>
                </div>
                
                <div class="card mt-5">
                    <h4 class="mb-2">Frequently Asked Questions</h4>
                    <div class="accordion">
                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span>Can I cancel anytime?</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-content">
                                <p class="text-muted">Yes, you can cancel your subscription at any time. You'll continue to have access until the end of your billing period.</p>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span>Do you offer annual plans?</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-content">
                                <p class="text-muted">Yes! Annual plans save you 40% compared to monthly billing. Contact support for annual plan options.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderSettingsPage(container) {
            container.innerHTML = `
                <h2 class="mb-4">Settings</h2>
                
                <div class="card mb-4">
                    <h4 class="mb-3">Account</h4>
                    <div class="flex flex-col gap-2">
                        <button class="btn btn-outline justify-start" onclick="editProfile()">
                            <i class="fas fa-user"></i> Edit Profile
                        </button>
                        <button class="btn btn-outline justify-start" onclick="showPrivacySettings()">
                            <i class="fas fa-lock"></i> Privacy Settings
                        </button>
                        <button class="btn btn-outline justify-start" onclick="changePassword()">
                            <i class="fas fa-key"></i> Change Password
                        </button>
                        <button class="btn btn-outline justify-start" onclick="navigateTo('billing')">
                            <i class="fas fa-credit-card"></i> Billing & Subscription
                        </button>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <h4 class="mb-3">Notifications</h4>
                    <div class="flex flex-col gap-3">
                        <div class="flex justify-between items-center">
                            <span>Match Notifications</span>
                            <label class="switch">
                                <input type="checkbox" ${state.privacySettings.notifications.matches ? 'checked' : ''} onchange="toggleNotification('matches')">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="flex justify-between items-center">
                            <span>Message Notifications</span>
                            <label class="switch">
                                <input type="checkbox" ${state.privacySettings.notifications.messages ? 'checked' : ''} onchange="toggleNotification('messages')">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="flex justify-between items-center">
                            <span>Event Updates</span>
                            <label class="switch">
                                <input type="checkbox" ${state.privacySettings.notifications.eventUpdates ? 'checked' : ''} onchange="toggleNotification('eventUpdates')">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <h4 class="mb-3">Support</h4>
                    <div class="flex flex-col gap-2">
                        <button class="btn btn-outline justify-start" onclick="navigateTo('help')">
                            <i class="fas fa-question-circle"></i> Help Center
                        </button>
                        <button class="btn btn-outline justify-start" onclick="navigateTo('safety')">
                            <i class="fas fa-shield-alt"></i> Safety Center
                        </button>
                        <button class="btn btn-outline justify-start" onclick="contactSupport()">
                            <i class="fas fa-headset"></i> Contact Support
                        </button>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <h4 class="mb-3">About</h4>
                    <div class="flex flex-col gap-2">
                        <div class="flex justify-between">
                            <span>App Version</span>
                            <span class="text-muted">1.0.0</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Terms of Service</span>
                            <a href="#" class="text-gradient">View</a>
                        </div>
                        <div class="flex justify-between">
                            <span>Privacy Policy</span>
                            <a href="#" class="text-gradient">View</a>
                        </div>
                    </div>
                </div>
                
                <button class="btn btn-outline btn-block" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Log Out
                </button>
                
                <button class="btn btn-outline btn-block mt-3" style="color: var(--red);" onclick="deleteAccount()">
                    <i class="fas fa-trash"></i> Delete Account
                </button>
            `;
        }
        
        function renderBookmarksPage(container) {
            const bookmarkedEvents = MOCK_EVENTS.filter(event => event.bookmarked);
            
            container.innerHTML = `
                <h2 class="mb-4">Bookmarked Events (${bookmarkedEvents.length})</h2>
                
                ${bookmarkedEvents.length > 0 ? `
                    <div class="events-grid">
                        ${bookmarkedEvents.map(event => `
                            <div class="event-card" onclick="viewEvent(${event.id})">
                                <div class="event-card-header">
                                    <div>
                                        <h3 class="mb-2">${event.name}</h3>
                                        <p class="text-gradient">${event.category}</p>
                                    </div>
                                    <button class="bookmark-button active" onclick="toggleBookmark(${event.id}); event.stopPropagation()">
                                        <i class="fas fa-bookmark"></i>
                                    </button>
                                </div>
                                
                                <div class="event-info">
                                    <i class="fas fa-calendar"></i>
                                    <span>${event.date}  ${event.time}</span>
                                </div>
                                <div class="event-info">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>${event.location}</span>
                                </div>
                                
                                <div class="event-tags mt-3">
                                    ${event.tags.slice(0, 3).map(tag => `<span class="event-tag">${tag}</span>`).join('')}
                                </div>
                                
                                <button class="btn btn-primary btn-block mt-3" onclick="event.stopPropagation(); handleRSVP(${event.id})">
                                    ${event.rsvp === 'going' ? 'Joined' : 'RSVP'}
                                </button>
                            </div>
                        `).join('')}
                    </div>
                ` : `
                    <div class="text-center py-12">
                        <i class="fas fa-bookmark" style="font-size: 4rem; color: var(--gray-light); margin-bottom: var(--space-md);"></i>
                        <h3 class="mb-2">No Bookmarks Yet</h3>
                        <p class="text-muted mb-4">Save events you're interested in by clicking the bookmark icon</p>
                        <button class="btn btn-primary" onclick="navigateTo('events')">
                            <i class="fas fa-calendar"></i> Browse Events
                        </button>
                    </div>
                `}
            `;
        }
        
        function renderAchievementsPage(container) {
            const unlocked = MOCK_ACHIEVEMENTS.filter(a => a.unlocked);
            const locked = MOCK_ACHIEVEMENTS.filter(a => !a.unlocked);
            
            container.innerHTML = `
                <h2 class="mb-4">Achievements</h2>
                
                <div class="card mb-4">
                    <div class="flex items-center gap-3">
                        <div style="font-size: 3rem; color: var(--gold);">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div>
                            <h3>${unlocked.length}/${MOCK_ACHIEVEMENTS.length} Unlocked</h3>
                            <p class="text-muted">Complete achievements to earn rewards</p>
                        </div>
                    </div>
                </div>
                
                <h3 class="mb-3">Unlocked</h3>
                <div class="achievements-grid mb-4">
                    ${unlocked.map(achievement => `
                        <div class="achievement-card">
                            <div class="achievement-icon" style="background: rgba(16, 185, 129, 0.2); color: var(--green);">
                                <i class="fas ${achievement.icon}"></i>
                            </div>
                            <h4 class="achievement-title">${achievement.title}</h4>
                            <p class="achievement-desc">${achievement.description}</p>
                            <div class="badge free-badge mt-2">${achievement.reward}</div>
                        </div>
                    `).join('')}
                </div>
                
                <h3 class="mb-3">Locked</h3>
                <div class="achievements-grid">
                    ${locked.map(achievement => `
                        <div class="achievement-card" style="opacity: 0.6;">
                            <div class="achievement-icon" style="background: rgba(255, 255, 255, 0.1); color: var(--gray-light);">
                                <i class="fas ${achievement.icon}"></i>
                            </div>
                            <h4 class="achievement-title">${achievement.title}</h4>
                            <p class="achievement-desc">${achievement.description}</p>
                            <div class="progress-bar mt-2">
                                <div class="progress-fill" style="width: ${achievement.progress}%"></div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        // Add missing helper functions
        function showMenuModal() {
            const modalContent = `
                <div class="modal-content" style="max-width: 300px;">
                    <div class="flex flex-col gap-2">
                        <button class="btn btn-outline justify-start" onclick="hideModal('menuModal'); navigateTo('dashboard')">
                            <i class="fas fa-home"></i> Dashboard
                        </button>
                        <button class="btn btn-outline justify-start" onclick="hideModal('menuModal'); navigateTo('events')">
                            <i class="fas fa-calendar"></i> Events
                        </button>
                        <button class="btn btn-outline justify-start" onclick="hideModal('menuModal'); navigateTo('matches')">
                            <i class="fas fa-heart"></i> Matches
                        </button>
                        <button class="btn btn-outline justify-start" onclick="hideModal('menuModal'); navigateTo('profile')">
                            <i class="fas fa-user"></i> Profile
                        </button>
                        <hr style="border-color: rgba(255,255,255,0.1); margin: 10px 0;">
                        <button class="btn btn-outline justify-start" onclick="hideModal('menuModal'); navigateTo('settings')">
                            <i class="fas fa-cog"></i> Settings
                        </button>
                        <button class="btn btn-outline justify-start" onclick="hideModal('menuModal'); navigateTo('help')">
                            <i class="fas fa-question-circle"></i> Help
                        </button>
                        <button class="btn btn-outline justify-start" onclick="hideModal('menuModal'); navigateTo('pricing')">
                            <i class="fas fa-crown"></i> Upgrade
                        </button>
                        <hr style="border-color: rgba(255,255,255,0.1); margin: 10px 0;">
                        <button class="btn btn-outline justify-start" style="color: var(--red);" onclick="hideModal('menuModal'); logout()">
                            <i class="fas fa-sign-out-alt"></i> Log Out
                        </button>
                    </div>
                </div>
            `;
            
            // Create modal if it doesn't exist
            let modal = document.getElementById('menuModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'menuModal';
                modal.className = 'modal-overlay';
                modal.onclick = function(e) {
                    if (e.target === modal) hideModal('menuModal');
                };
                document.body.appendChild(modal);
            }
            
            modal.innerHTML = modalContent;
            modal.style.display = 'flex';
        }
        
        function showNotifications() {
            showToast('No new notifications', 'info');
        }
        
        function openChat(userId) {
            state.currentChatId = userId;
            navigateTo('chat');
        }
        
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message) {
                const timestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                if (!state.chatMessages[state.currentChatId]) {
                    state.chatMessages[state.currentChatId] = [];
                }
                
                state.chatMessages[state.currentChatId].push({
                    text: message,
                    sender: 'me',
                    time: timestamp
                });
                
                input.value = '';
                renderChatPage(document.getElementById('content'));
                
                // Simulate reply after 1 second
                setTimeout(() => {
                    const replies = [
                        "That's interesting! Tell me more.",
                        "I agree with you on that!",
                        "What are your thoughts on the event?",
                        "Nice to meet you too!",
                        "Looking forward to connecting more at the next event!"
                    ];
                    
                    const randomReply = replies[Math.floor(Math.random() * replies.length)];
                    
                    state.chatMessages[state.currentChatId].push({
                        text: randomReply,
                        sender: 'them',
                        time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                    });
                    
                    renderChatPage(document.getElementById('content'));
                }, 1000);
            }
        }
        
        function handleMessageKeypress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
        
        function switchAuthTab(tab) {
            const tabs = document.querySelectorAll('.auth-tab');
            tabs.forEach(t => t.classList.remove('active'));
            
            event.target.classList.add('active');
            
            const authFields = document.getElementById('authFields');
            
            if (tab === 'signin') {
                authFields.innerHTML = `
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="email" placeholder="your@email.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="password" placeholder="" required>
                    </div>
                    <div class="flex justify-between items-center mb-4">
                        <label class="form-label">
                            <input type="checkbox" id="rememberMe">
                            <span>Remember me</span>
                        </label>
                        <a href="#" class="text-gradient" onclick="forgotPassword()">Forgot password?</a>
                    </div>
                `;
            } else {
                authFields.innerHTML = `
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="fullName" placeholder="John Doe" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="signupEmail" placeholder="your@email.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="signupPassword" placeholder="" required>
                        <p class="text-sm text-muted mt-1">Minimum 8 characters</p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Age</label>
                        <input type="number" class="form-control" id="age" min="18" max="99" placeholder="25" required>
                    </div>
                    <div class="form-group mb-4">
                        <label class="form-label">
                            <input type="checkbox" id="terms" required>
                            <span>I agree to the Terms of Service and Privacy Policy</span>
                        </label>
                    </div>
                `;
            }
        }
        
        function handleAuth(event) {
            event.preventDefault();
            
            const tabs = document.querySelectorAll('.auth-tab');
            const isSignIn = tabs[0].classList.contains('active');
            
            if (isSignIn) {
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                // Demo authentication
                if (email && password.length >= 6) {
                    demoLogin();
                } else {
                    showToast('Please enter valid credentials', 'error');
                }
            } else {
                const fullName = document.getElementById('fullName').value;
                const email = document.getElementById('signupEmail').value;
                const password = document.getElementById('signupPassword').value;
                const age = document.getElementById('age').value;
                
                if (fullName && email && password.length >= 8 && age >= 18) {
                    state.userProfile.name = fullName;
                    state.userProfile.email = email;
                    state.userProfile.age = parseInt(age);
                    demoLogin();
                } else {
                    showToast('Please fill all required fields correctly', 'error');
                }
            }
        }
        
        function socialLogin(platform) {
            showToast(`Signing in with ${platform}...`, 'info');
            setTimeout(() => {
                demoLogin();
            }, 1500);
        }
        
        function forgotPassword() {
            const email = prompt('Enter your email to reset password:');
            if (email) {
                showToast(`Password reset link sent to ${email}`, 'success');
            }
        }
        
        // Add missing page renderers
        function renderCreateEventPage(container) {
            startEventWizard();
            container.innerHTML = `
                <div class="text-center py-12">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--purple-primary);"></i>
                    <p class="mt-3">Loading event creator...</p>
                </div>
            `;
        }
        
        function renderHelpPage(container) {
            container.innerHTML = `
                <h2 class="mb-4">Help Center</h2>
                
                <div class="help-categories">
                    <div class="help-category" onclick="openHelpCategory('getting-started')">
                        <i class="fas fa-rocket" style="font-size: 2rem; margin-bottom: var(--space-sm); color: var(--purple-primary);"></i>
                        <h4>Getting Started</h4>
                        <p class="text-muted">New user guide</p>
                    </div>
                    
                    <div class="help-category" onclick="openHelpCategory('events')">
                        <i class="fas fa-calendar" style="font-size: 2rem; margin-bottom: var(--space-sm); color: var(--blue);"></i>
                        <h4>Events</h4>
                        <p class="text-muted">Joining & creating events</p>
                    </div>
                    
                    <div class="help-category" onclick="openHelpCategory('matching')">
                        <i class="fas fa-heart" style="font-size: 2rem; margin-bottom: var(--space-sm); color: var(--pink);"></i>
                        <h4>Matching</h4>
                        <p class="text-muted">How to connect with others</p>
                    </div>
                    
                    <div class="help-category" onclick="openHelpCategory('safety')">
                        <i class="fas fa-shield-alt" style="font-size: 2rem; margin-bottom: var(--space-sm); color: var(--green);"></i>
                        <h4>Safety</h4>
                        <p class="text-muted">Safety guidelines</p>
                    </div>
                </div>
                
                <div class="card mt-4">
                    <h4 class="mb-3">Frequently Asked Questions</h4>
                    <div class="accordion">
                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span>How do I join an event?</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-content">
                                <p class="text-muted">Scan the event QR code at the venue or enter the event code manually in the app.</p>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <div class="accordion-header" onclick="toggleAccordion(this)">
                                <span>Is my profile information safe?</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-content">
                                <p class="text-muted">Yes, we use end-to-end encryption and never share your personal information with third parties.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-4">
                    <h4 class="mb-3">Contact Support</h4>
                    <p class="text-muted mb-3">Need more help? Our support team is here for you.</p>
                    <div class="flex flex-col gap-2">
                        <button class="btn btn-outline" onclick="contactSupport()">
                            <i class="fas fa-envelope"></i> Email Support
                        </button>
                        <button class="btn btn-outline" onclick="openLiveChat()">
                            <i class="fas fa-comments"></i> Live Chat
                        </button>
                    </div>
                </div>
            `;
        }
        
        function renderSubscriptionPage(container) {
            navigateTo('pricing');
        }
        
        function renderBillingPage(container) {
            container.innerHTML = `
                <h2 class="mb-4">Billing & Subscription</h2>
                
                <div class="card mb-4">
                    <h4 class="mb-3">Current Plan</h4>
                    <div class="flex justify-between items-center">
                        <div>
                            <h3 class="${state.userTier === 'pro' ? 'pro-gradient' : state.userTier === 'max' ? 'pro-plus-gradient' : ''}">
                                ${state.userTier.charAt(0).toUpperCase() + state.userTier.slice(1)}
                            </h3>
                            <p class="text-muted">${state.userTier === 'free' ? 'Free plan' : 'Renews monthly'}</p>
                        </div>
                        <button class="btn btn-outline" onclick="navigateTo('pricing')">
                            ${state.userTier === 'free' ? 'Upgrade' : 'Change Plan'}
                        </button>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <h4 class="mb-3">Payment Methods</h4>
                    <div class="flex flex-col gap-2">
                        <div class="payment-method">
                            <i class="fab fa-cc-mastercard" style="font-size: 1.5rem;"></i>
                            <div style="flex: 1;">
                                <h4>Mastercard  4242</h4>
                                <p class="text-muted">Expires 12/2025</p>
                            </div>
                            <button class="btn btn-outline btn-small">Edit</button>
                        </div>
                        <button class="btn btn-outline justify-start" onclick="addPaymentMethod()">
                            <i class="fas fa-plus"></i> Add Payment Method
                        </button>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <h4 class="mb-3">Billing History</h4>
                    <div class="flex flex-col gap-2">
                        <div class="flex justify-between items-center">
                            <div>
                                <h4>Pro Subscription</h4>
                                <p class="text-muted">Jan 15, 2024</p>
                            </div>
                            <div class="text-right">
                                <h4>$14.99</h4>
                                <p class="text-muted">Paid</p>
                            </div>
                        </div>
                        <button class="btn btn-outline btn-block" onclick="viewFullBillingHistory()">
                            View All Invoices
                        </button>
                    </div>
                </div>
            `;
        }
        
        function renderCheckoutPage(container) {
            showModal('paymentModal');
            container.innerHTML = `
                <div class="text-center py-12">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--purple-primary);"></i>
                    <p class="mt-3">Processing payment...</p>
                </div>
            `;
        }
        
        function renderDiscoverPage(container) {
            container.innerHTML = `
                <h2 class="mb-4">Discover People</h2>
                <p class="text-muted mb-4">Connect with people outside of events</p>
                
                <div class="text-center py-12">
                    <i class="fas fa-compass" style="font-size: 4rem; color: var(--gray-light); margin-bottom: var(--space-md);"></i>
                    <h3 class="mb-2">Coming Soon!</h3>
                    <p class="text-muted">Discover people near you based on shared interests</p>
                    <button class="btn btn-primary mt-3" onclick="navigateTo('events')">
                        <i class="fas fa-calendar"></i> Browse Events Instead
                    </button>
                </div>
            `;
        }
        
        // Add missing modal functions
        function showPaymentModal(tier) {
            showModal('paymentModal');
            let amount = tier === 'pro' ? '14.99' : '29.99';
            document.getElementById('paymentAmount').textContent = `$${amount}`;
            document.getElementById('paymentEventName').textContent = `${tier.toUpperCase()} Subscription`;
            document.getElementById('paymentType').textContent = 'Monthly subscription';
        }
        
        function selectPaymentMethod(method) {
            const options = document.querySelectorAll('.payment-option');
            options.forEach(opt => opt.classList.remove('active'));
            event.target.closest('.payment-option').classList.add('active');
        }
        
        function processPayment() {
            hideModal('paymentModal');
            showToast('Payment processing...', 'info');
            
            setTimeout(() => {
                if (Math.random() > 0.1) { // 90% success rate
                    if (document.getElementById('paymentEventName').textContent.includes('Pro')) {
                        changeTier('pro');
                    } else {
                        changeTier('max');
                    }
                    showToast('Payment successful! Upgrade complete.', 'success');
                } else {
                    showToast('Payment failed. Please try again.', 'error');
                }
            }, 2000);
        }
        
        function showPaymentMethod() {
            showToast('Select a payment method in the payment modal', 'info');
        }
        
        function editProfile() {
            navigateTo('onboarding');
        }
        
        function changeProfilePhoto() {
            openCameraForSelfie();
        }
        
        function showPrivacySettings() {
            const modalContent = `
                <div class="modal-content">
                    <h3 class="mb-3">Privacy Settings</h3>
                    
                    <div class="form-group mb-4">
                        <label class="form-label">Profile Visibility</label>
                        <select class="form-control" id="profileVisibility">
                            <option value="public" ${state.privacySettings.showProfile === 'public' ? 'selected' : ''}>Public</option>
                            <option value="events-only" ${state.privacySettings.showProfile === 'events-only' ? 'selected' : ''}>Events Only</option>
                            <option value="private" ${state.privacySettings.showProfile === 'private' ? 'selected' : ''}>Private</option>
                        </select>
                    </div>
                    
                    <div class="form-group mb-4">
                        <label class="form-label">
                            <input type="checkbox" id="showOnlineStatus" ${state.privacySettings.showOnlineStatus ? 'checked' : ''}>
                            Show online status
                        </label>
                    </div>
                    
                    <div class="form-group mb-4">
                        <label class="form-label">
                            <input type="checkbox" id="showDistance" ${state.privacySettings.showDistance ? 'checked' : ''}>
                            Show distance to others
                        </label>
                    </div>
                    
                    <div class="flex gap-2">
                        <button class="btn btn-outline flex-1" onclick="hideModal('privacySettingsModal')">
                            Cancel
                        </button>
                        <button class="btn btn-primary flex-1" onclick="savePrivacySettings()">
                            Save Changes
                        </button>
                    </div>
                </div>
            `;
            
            let modal = document.getElementById('privacySettingsModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'privacySettingsModal';
                modal.className = 'modal-overlay';
                modal.onclick = function(e) {
                    if (e.target === modal) hideModal('privacySettingsModal');
                };
                document.body.appendChild(modal);
            }
            
            modal.innerHTML = modalContent;
            modal.style.display = 'flex';
        }
        
        function savePrivacySettings() {
            state.privacySettings.showProfile = document.getElementById('profileVisibility').value;
            state.privacySettings.showOnlineStatus = document.getElementById('showOnlineStatus').checked;
            state.privacySettings.showDistance = document.getElementById('showDistance').checked;
            
            hideModal('privacySettingsModal');
            showToast('Privacy settings updated', 'success');
        }
        
        function toggleNotification(type) {
            state.privacySettings.notifications[type] = !state.privacySettings.notifications[type];
            showToast(`${type} notifications ${state.privacySettings.notifications[type] ? 'enabled' : 'disabled'}`, 'info');
        }
        
        function changePassword() {
            const current = prompt('Enter current password:');
            if (current) {
                const newPass = prompt('Enter new password:');
                if (newPass && newPass.length >= 8) {
                    showToast('Password changed successfully', 'success');
                } else {
                    showToast('Password must be at least 8 characters', 'error');
                }
            }
        }
        
        function deleteAccount() {
            if (confirm('Are you sure you want to delete your account? This action cannot be undone.')) {
                logout();
                showToast('Account deleted successfully', 'success');
            }
        }
        
        // Add missing swipe setup
        function setupSwipeCards() {
            const cards = document.querySelectorAll('.profile-card');
            const likeOverlay = document.getElementById('likeOverlay');
            const nopeOverlay = document.getElementById('nopeOverlay');
            const superOverlay = document.getElementById('superOverlay');
            
            cards.forEach(card => {
                let isDragging = false;
                let startX, startY, currentX, currentY;
                
                card.addEventListener('mousedown', startDrag);
                card.addEventListener('touchstart', startDrag);
                
                function startDrag(e) {
                    isDragging = true;
                    const touch = e.type === 'touchstart' ? e.touches[0] : e;
                    startX = touch.clientX;
                    startY = touch.clientY;
                    
                    document.addEventListener('mousemove', drag);
                    document.addEventListener('touchmove', drag);
                    document.addEventListener('mouseup', endDrag);
                    document.addEventListener('touchend', endDrag);
                }
                
                function drag(e) {
                    if (!isDragging) return;
                    
                    const touch = e.type === 'touchmove' ? e.touches[0] : e;
                    currentX = touch.clientX - startX;
                    currentY = touch.clientY - startY;
                    
                    const rotation = currentX * 0.1;
                    card.style.transform = `translate(${currentX}px, ${currentY}px) rotate(${rotation}deg)`;
                    
                    // Show overlay based on direction
                    if (currentX > 50) {
                        likeOverlay.style.opacity = Math.min(currentX / 100, 1);
                        nopeOverlay.style.opacity = 0;
                        superOverlay.style.opacity = 0;
                    } else if (currentX < -50) {
                        nopeOverlay.style.opacity = Math.min(-currentX / 100, 1);
                        likeOverlay.style.opacity = 0;
                        superOverlay.style.opacity = 0;
                    } else if (currentY < -50) {
                        superOverlay.style.opacity = Math.min(-currentY / 100, 1);
                        likeOverlay.style.opacity = 0;
                        nopeOverlay.style.opacity = 0;
                    } else {
                        likeOverlay.style.opacity = 0;
                        nopeOverlay.style.opacity = 0;
                        superOverlay.style.opacity = 0;
                    }
                }
                
                function endDrag() {
                    if (!isDragging) return;
                    isDragging = false;
                    
                    document.removeEventListener('mousemove', drag);
                    document.removeEventListener('touchmove', drag);
                    document.removeEventListener('mouseup', endDrag);
                    document.removeEventListener('touchend', endDrag);
                    
                    const threshold = 100;
                    if (Math.abs(currentX) > threshold) {
                        if (currentX > 0) {
                            swipeRight();
                        } else {
                            swipeLeft();
                        }
                    } else if (currentY < -threshold) {
                        superLike();
                    } else {
                        card.style.transform = '';
                    }
                    
                    likeOverlay.style.opacity = 0;
                    nopeOverlay.style.opacity = 0;
                    superOverlay.style.opacity = 0;
                }
            });
        }
        
        function simulateQRScan() {
            // Simulate QR code scanning
            const event = MOCK_EVENTS[0];
            if (event) {
                state.currentEvent = event;
                showModal('privacyModal');
            }
        }
        
        function toggleAccordion(element) {
            const content = element.nextElementSibling;
            const icon = element.querySelector('i');
            
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
                icon.style.transform = 'rotate(0deg)';
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
                icon.style.transform = 'rotate(180deg)';
            }
        }
        
        function markAllAsRead() {
            state.matches.forEach(match => match.unread = false);
            showToast('All matches marked as read', 'success');
            renderPage();
        }
        
        function openHelpCategory(category) {
            showToast(`Opening ${category} help section...`, 'info');
        }
        
        function contactSupport() {
            window.open('mailto:support@amps.com', '_blank');
        }
        
        function openLiveChat() {
            showToast('Live chat coming soon!', 'info');
        }
        
        function addPaymentMethod() {
            showToast('Payment method feature coming soon!', 'info');
        }
        
        function viewFullBillingHistory() {
            showToast('Billing history feature coming soon!', 'info');
        }
        
        function showEmergencyContacts() {
            showToast('Emergency contacts feature coming soon!', 'info');
        }
        
        function addEmergencyContact() {
            const name = prompt('Enter contact name:');
            const phone = prompt('Enter phone number:');
            if (name && phone) {
                showToast('Emergency contact added', 'success');
            }
        }
        
        function showBlockedUsers() {
            showToast('Blocked users feature coming soon!', 'info');
        }
        
        function showPrivacyControls() {
            showToast('Privacy controls feature coming soon!', 'info');
        }
        
        function showPhotoModeration() {
            showToast('Photo moderation feature coming soon!', 'info');
        }
        
        function showUnapprovedPhotos() {
            showToast('Photo review feature coming soon!', 'info');
        }
        
        function downloadPhotoAlbum() {
            showToast('Photo download feature coming soon!', 'info');
        }
        
        function openPhotoDetail(photoId) {
            showToast('Photo detail view coming soon!', 'info');
        }
        
        function shareEvent(eventId) {
            const event = MOCK_EVENTS.find(e => e.id === eventId);
            if (event) {
                const shareText = `Check out ${event.name} on Amps! ${event.description.substring(0, 100)}...`;
                if (navigator.share) {
                    navigator.share({
                        title: event.name,
                        text: shareText,
                        url: window.location.href
                    });
                } else {
                    prompt('Share this event:', shareText);
                }
            }
        }
        
        function showRevenueReport() {
            showToast('Revenue report feature coming soon!', 'info');
        }
        
        function exportAllData() {
            showToast('Data export feature coming soon!', 'info');
        }
        
        function downloadQRCode() {
            showToast('QR code download feature coming soon!', 'info');
        }
        
        function shareQRCode() {
            showToast('QR code share feature coming soon!', 'info');
        }
        
        function showChatMenu() {
            showToast('Chat menu feature coming soon!', 'info');
        }
        
        function shareEvent() {
            showToast('Event sharing feature coming soon!', 'info');
        }

        // ===== EXPORT FUNCTIONS FOR GLOBAL ACCESS =====
        // Export all necessary functions for HTML event handlers
        window.navigateTo = navigateTo;
        window.goBack = goBack;
        window.showModal = showModal;
        window.hideModal = hideModal;
        window.demoLogin = demoLogin;
        window.upgradeToPro = upgradeToPro;
        window.changeTier = changeTier;
        window.logout = logout;
        window.viewEvent = viewEvent;
        window.handleRSVP = handleRSVP;
        window.updateRSVP = updateRSVP;
        window.toggleBookmark = toggleBookmark;
        window.joinEvent = joinEvent;
        window.startCameraScanning = startCameraScanning;
        window.enterEventCode = enterEventCode;
        window.selectPrivacyMode = selectPrivacyMode;
        window.continueToEvent = continueToEvent;
        window.toggleFilterOption = toggleFilterOption;
        window.applyEventFilters = applyEventFilters;
        window.takeLivePhoto = takeLivePhoto;
        window.openCameraForSelfie = openCameraForSelfie;
        window.closeCamera = closeCamera;
        window.switchCamera = switchCamera;
        window.takePhoto = takePhoto;
        window.swipeLeft = swipeLeft;
        window.swipeRight = swipeRight;
        window.superLike = superLike;
        window.undoSwipe = undoSwipe;
        window.resetSwipes = resetSwipes;
        window.clearFilters = clearFilters;
        window.showMatchModal = showMatchModal;
        window.startChat = startChat;
        window.openChat = openChat;
        window.sendMessage = sendMessage;
        window.switchAuthTab = switchAuthTab;
        window.handleAuth = handleAuth;
        window.showMenuModal = showMenuModal;
        window.showToast = showToast;
        window.showPaymentModal = showPaymentModal;
        window.selectPaymentMethod = selectPaymentMethod;
        window.processPayment = processPayment;
        window.showPaymentMethod = showPaymentMethod;
        window.showNotifications = showNotifications;
        window.editProfile = editProfile;
        window.changeProfilePhoto = changeProfilePhoto;
        window.showPrivacySettings = showPrivacySettings;
        window.showHelp = showHelp;
        window.changePassword = changePassword;
        window.toggleNotification = toggleNotification;
        window.deleteAccount = deleteAccount;
        window.startEventWizard = startEventWizard;
        window.previousWizardStep = previousWizardStep;
        window.nextWizardStep = nextWizardStep;
        window.selectBrandingColor = selectBrandingColor;
        window.triggerLogoUpload = triggerLogoUpload;
        window.handleLogoUpload = handleLogoUpload;
        window.toggleWizardTag = toggleWizardTag;
        window.addWizardTag = addWizardTag;
        window.updateRadiusValue = updateRadiusValue;
        window.openEventPhotos = openEventPhotos;
        window.triggerFileUpload = triggerFileUpload;
        window.handlePhotoUpload = handlePhotoUpload;
        window.submitEventPhotos = submitEventPhotos;
        window.switchAnalyticsTab = switchAnalyticsTab;
        window.exportAnalytics = exportAnalytics;
        window.exportEventAnalytics = exportEventAnalytics;
        window.connectSocialMedia = connectSocialMedia;
        window.importSocialPhotos = importSocialPhotos;
        window.shareToSocialMedia = shareToSocialMedia;
        window.openEventManagement = openEventManagement;
        window.triggerEmergency = triggerEmergency;
        window.submitSafetyReport = submitSafetyReport;
        window.uploadProfilePhoto = uploadProfilePhoto;
        window.handleProfilePhotoUpload = handleProfilePhotoUpload;
        window.nextOnboardingStep = nextOnboardingStep;
        window.skipOnboarding = skipOnboarding;

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing app...');
            init();
        });

        // Also try to initialize immediately in case DOM is already loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>
