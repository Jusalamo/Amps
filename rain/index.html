<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <title>Amps | Amplify Your Connections at Live Events</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Mapbox GL -->
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" id="manifest">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Amps">
    
    <!-- Styles -->
    <style> 
    /* ===== BASE STYLES ===== */
:root {
    /* Color System */
    --bg-primary: #000000;
    --bg-secondary: #0a0a0a;
    --bg-tertiary: #161616;
    --bg-card: rgba(30, 30, 30, 0.7);
    --bg-glass: rgba(255, 255, 255, 0.05);
    
    /* Profile Card Colors */
    --card-purple: #8B5CF6;
    --card-pink: #EC4899;
    --card-blue: #3B82F6;
    --card-green: #10B981;
    --card-yellow: #F59E0B;
    --card-orange: #F97316;
    --card-red: #EF4444;
    --card-teal: #14B8A6;
    --card-indigo: #6366F1;
    --card-lavender: #C4B5FD;
    --card-pastel-pink: #FFC0D9;
    --card-pastel-blue: #BAE6FD;
    --card-mint: #BBF7D0;
    --card-peach: #FECACA;
    
    /* Primary Colors */
    --primary: #8B5CF6;
    --primary-light: #A78BFA;
    --primary-dark: #7C3AED;
    --primary-glow: rgba(139, 92, 246, 0.3);
    
    /* Accent Colors */
    --accent-green: #10B981;
    --accent-red: #EF4444;
    --accent-yellow: #F59E0B;
    --accent-blue: #3B82F6;
    --accent-gold: #F5DEB3;
    
    /* Gradients */
    --pro-gradient: linear-gradient(135deg, #8B5CF6, #EC4899, #F59E0B);
    --pro-plus-gradient: linear-gradient(135deg, #F59E0B, #8B5CF6, #EC4899);
    --demo-gradient: linear-gradient(135deg, #3B82F6, #8B5CF6, #EC4899);
    
    /* Neutral Colors */
    --white: #FFFFFF;
    --gray-100: #F1F5F9;
    --gray-200: #E2E8F0;
    --gray-300: #CBD5E1;
    --gray-400: #8E8E93;
    --gray-500: #64748b;
    --gray-600: #475569;
    --gray-700: #334155;
    --gray-800: #1C1C1E;
    --gray-900: #2C2C2E;
    
    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.5);
    --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.3);
    --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.3);
    --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.6), 0 10px 10px -5px rgba(0, 0, 0, 0.4);
    --shadow-glow: 0 0 30px rgba(139, 92, 246, 0.4);
    --shadow-card-stack: 0 20px 60px rgba(0, 0, 0, 0.4), 0 8px 24px rgba(0, 0, 0, 0.3);
    --shadow-gold: 0 8px 24px rgba(245, 222, 179, 0.3);
    
    /* Spacing System */
    --space-1: 4px;
    --space-2: 8px;
    --space-3: 12px;
    --space-4: 16px;
    --space-5: 24px;
    --space-6: 32px;
    --space-7: 48px;
    --space-8: 64px;
    
    /* Border Radius System */
    --radius-sm: 8px;
    --radius: 12px;
    --radius-md: 16px;
    --radius-lg: 20px;
    --radius-xl: 24px;
    --radius-2xl: 32px;
    --radius-full: 9999px;
    
    /* Transitions */
    --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition: 250ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
    
    /* Layout Dimensions */
    --header-height: 64px;
    --bottom-nav-height: 65px;
    --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
    
    /* Map Drawer */
    --map-drawer-height: 20%;
    --map-drawer-transition: cubic-bezier(0.4, 0, 0.2, 1);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', Roboto, Oxygen, Ubuntu, sans-serif;
    background: var(--bg-primary);
    color: var(--white);
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden;
    min-height: 100vh;
    padding-bottom: calc(var(--bottom-nav-height) + var(--safe-area-inset-bottom) + 20px);
}

.app {
    max-width: 480px;
    margin: 0 auto;
    min-height: 100vh;
    background: var(--bg-primary);
    position: relative;
    overflow: hidden;
}

/* ===== UTILITY CLASSES ===== */
.hidden { display: none !important; }
.flex { display: flex; }
.flex-col { flex-direction: column; }
.items-center { align-items: center; }
.justify-center { justify-content: center; }
.justify-between { justify-content: space-between; }
.justify-end { justify-content: flex-end; }
.gap-1 { gap: var(--space-1); }
.gap-2 { gap: var(--space-2); }
.gap-3 { gap: var(--space-3); }
.gap-4 { gap: var(--space-4); }
.gap-5 { gap: var(--space-5); }
.gap-6 { gap: var(--space-6); }
.w-full { width: 100%; }
.text-center { text-align: center; }
.cursor-pointer { cursor: pointer; }
.relative { position: relative; }
.absolute { position: absolute; }
.flex-1 { flex: 1; }

/* Spacing Utilities */
.mt-1 { margin-top: var(--space-1); }
.mt-2 { margin-top: var(--space-2); }
.mt-3 { margin-top: var(--space-3); }
.mt-4 { margin-top: var(--space-4); }
.mt-5 { margin-top: var(--space-5); }
.mt-6 { margin-top: var(--space-6); }
.mb-1 { margin-bottom: var(--space-1); }
.mb-2 { margin-bottom: var(--space-2); }
.mb-3 { margin-bottom: var(--space-3); }
.mb-4 { margin-bottom: var(--space-4); }
.mb-5 { margin-bottom: var(--space-5); }
.mb-6 { margin-bottom: var(--space-6); }
.ml-2 { margin-left: var(--space-2); }
.ml-3 { margin-left: var(--space-3); }
.mr-2 { margin-right: var(--space-2); }
.mr-3 { margin-right: var(--space-3); }
.p-1 { padding: var(--space-1); }
.p-2 { padding: var(--space-2); }
.p-3 { padding: var(--space-3); }
.p-4 { padding: var(--space-4); }
.p-5 { padding: var(--space-5); }
.p-6 { padding: var(--space-6); }
.py-1 { padding-top: var(--space-1); padding-bottom: var(--space-1); }
.py-2 { padding-top: var(--space-2); padding-bottom: var(--space-2); }
.py-3 { padding-top: var(--space-3); padding-bottom: var(--space-3); }
.py-4 { padding-top: var(--space-4); padding-bottom: var(--space-4); }
.py-5 { padding-top: var(--space-5); padding-bottom: var(--space-5); }
.py-6 { padding-top: var(--space-6); padding-bottom: var(--space-6); }
.py-12 { padding-top: 3rem; padding-bottom: 3rem; }
.px-2 { padding-left: var(--space-2); padding-right: var(--space-2); }
.px-3 { padding-left: var(--space-3); padding-right: var(--space-3); }
.px-4 { padding-left: var(--space-4); padding-right: var(--space-4); }

/* Text Utilities */
.text-xs { font-size: 12px; line-height: 1.4; }
.text-sm { font-size: 14px; line-height: 1.5; }
.text-base { font-size: 16px; line-height: 1.5; }
.text-lg { font-size: 18px; line-height: 1.5; }
.text-xl { font-size: 20px; line-height: 1.4; }
.text-2xl { font-size: 24px; line-height: 1.3; }
.text-3xl { font-size: 32px; line-height: 1.2; }
.font-bold { font-weight: 700; }
.font-semibold { font-weight: 600; }
.font-medium { font-weight: 500; }

/* Color Utilities */
.text-gray-400 { color: var(--gray-400); }
.text-gray-300 { color: var(--gray-300); }
.text-gray-500 { color: var(--gray-500); }
.text-gray-600 { color: var(--gray-600); }
.text-primary { color: var(--primary); }
.text-white { color: var(--white); }
.text-red-400 { color: var(--accent-red); }
.text-green-500 { color: var(--accent-green); }
.text-yellow-500 { color: var(--accent-yellow); }
.text-blue-500 { color: var(--accent-blue); }
.text-gradient {
    background: linear-gradient(135deg, var(--primary), var(--primary-light));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
.pro-gradient {
    background: var(--pro-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
.pro-plus-gradient {
    background: var(--pro-plus-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

/* ===== LANDING PAGE ===== */
.hero {
    text-align: center;
    padding: var(--space-8) var(--space-5) var(--space-7);
    position: relative;
    z-index: 1;
}

.hero h1 {
    font-size: 3rem;
    margin-bottom: var(--space-5);
    line-height: 1.1;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 30%, var(--card-pink) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.hero-subtitle {
    font-size: 1.25rem;
    margin-bottom: var(--space-7);
    color: var(--gray-400);
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.6;
}

.features-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-5);
    margin: var(--space-7) 0;
}

.feature {
    background: rgba(255, 255, 255, 0.05);
    border-radius: var(--radius-2xl);
    padding: var(--space-5);
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all var(--transition);
}

.feature:hover {
    border-color: var(--primary);
    transform: translateY(-4px);
    box-shadow: var(--shadow-glow);
}

.feature-icon {
    width: 56px;
    height: 56px;
    background: rgba(139, 92, 246, 0.2);
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto var(--space-4);
    font-size: 24px;
    color: var(--primary-light);
}

.cta-grid {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    margin: var(--space-7) 0;
}

/* ===== NAVIGATION ===== */
.navbar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    height: var(--header-height);
    background: rgba(0, 0, 0, 0.9);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 var(--space-5);
    backdrop-filter: blur(20px);
    max-width: 480px;
    margin: 0 auto;
}

.nav-brand {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: 24px;
    font-weight: 800;
    cursor: pointer;
}

.nav-brand .amp {
    background: var(--pro-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.nav-brand .s {
    color: var(--white);
}

.nav-actions {
    display: flex;
    gap: 10px;
    align-items: center;
}

.back-btn {
    background: none;
    border: none;
    color: var(--white);
    font-size: 20px;
    cursor: pointer;
    padding: var(--space-2);
    border-radius: var(--radius-full);
    transition: background var(--transition-fast);
    min-height: 44px;
    min-width: 44px;
}

.back-btn:hover {
    background: rgba(255, 255, 255, 0.1);
}

/* ===== BOTTOM NAVIGATION ===== */
.bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: calc(var(--bottom-nav-height) + var(--safe-area-inset-bottom));
    background: rgba(0, 0, 0, 0.98);
    backdrop-filter: blur(20px);
    border-top: 1px solid rgba(255, 255, 255, 0.05);
    display: flex;
    justify-content: space-around;
    align-items: center;
    padding-bottom: var(--safe-area-inset-bottom);
    z-index: 999;
    max-width: 480px;
    margin: 0 auto;
}

.nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--space-1);
    padding: var(--space-3);
    background: none;
    border: none;
    color: var(--gray-400);
    font-size: 12px;
    transition: all var(--transition-fast);
    flex: 1;
    height: 100%;
    position: relative;
    min-height: 44px;
    min-width: 44px;
}

.nav-item.active {
    color: var(--primary);
}

.nav-item i {
    font-size: 20px;
}

/* ===== CONTENT CONTAINER ===== */
.content {
    padding: calc(var(--header-height) + var(--space-4)) var(--space-5) var(--space-5);
    min-height: 100vh;
}

/* ===== BUTTONS ===== */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-5);
    border-radius: var(--radius-xl);
    font-weight: 600;
    font-size: 14px;
    text-decoration: none;
    cursor: pointer;
    border: none;
    transition: all var(--transition);
    position: relative;
    overflow: hidden;
    backdrop-filter: blur(10px);
    min-height: 44px;
    min-width: 44px;
}

.btn:focus {
    outline: 2px solid var(--primary);
    outline-offset: 2px;
}

.btn-primary {
    background: var(--primary);
    color: var(--white);
    box-shadow: var(--shadow-glow);
}

.btn-primary:hover {
    background: var(--primary-light);
    transform: translateY(-2px);
    box-shadow: var(--shadow-glow), 0 8px 25px rgba(139, 92, 246, 0.3);
}

.btn-pro {
    background: var(--pro-gradient);
    color: var(--white);
    background-size: 200% 200%;
    animation: gradientMove 3s ease infinite;
    box-shadow: 0 0 30px rgba(236, 72, 153, 0.3);
}

.btn-pro:hover {
    transform: translateY(-2px);
    box-shadow: 0 0 40px rgba(236, 72, 153, 0.4);
}

.btn-pro-plus {
    background: var(--pro-plus-gradient);
    color: var(--white);
    box-shadow: 0 0 30px rgba(245, 158, 11, 0.3);
}

.btn-demo {
    background: var(--demo-gradient);
    color: var(--white);
    animation: gradientMove 3s ease infinite;
    background-size: 200% 200%;
}

.btn-outline {
    background: transparent;
    color: var(--white);
    border: 2px solid rgba(255, 255, 255, 0.3);
}

.btn-outline:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: var(--primary);
    transform: translateY(-2px);
}

.btn-glass {
    background: var(--bg-glass);
    color: var(--white);
    border: 1px solid rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
}

.btn-glass:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.2);
    transform: translateY(-2px);
}

.btn-large {
    padding: var(--space-4) var(--space-6);
    font-size: 16px;
}

.btn-small {
    padding: var(--space-2) var(--space-4);
    font-size: 12px;
}

.btn-block {
    width: 100%;
}

.btn-icon {
    width: 48px;
    height: 48px;
    padding: 0;
    border-radius: var(--radius-full);
    font-size: 20px;
}

/* ===== CARD COMPONENTS ===== */
.card {
    background: var(--bg-card);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-2xl);
    padding: var(--space-5);
    backdrop-filter: blur(20px);
    transition: all var(--transition);
}

.card:hover {
    border-color: rgba(255, 255, 255, 0.2);
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.card-glass {
    background: var(--bg-glass);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-2xl);
    padding: var(--space-5);
    backdrop-filter: blur(20px);
}

/* ===== HOME PAGE ===== */
.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: var(--space-6) 0 var(--space-4);
}

.quick-actions {
    display: grid;
    gap: var(--space-4);
    margin: var(--space-6) 0;
}

/* Mobile-first: 1 column */
.quick-actions {
    grid-template-columns: 1fr;
}

/* Tablet: 2 columns */
@media (min-width: 640px) {
    .quick-actions {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* Desktop: 4 columns */
@media (min-width: 1024px) {
    .quick-actions {
        grid-template-columns: repeat(4, 1fr);
    }
}

.action-card {
    background: var(--bg-card);
    border-radius: var(--radius-2xl);
    padding: var(--space-5) var(--space-4);
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.05);
    cursor: pointer;
    transition: all var(--transition);
    min-height: 140px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.action-card:hover {
    border-color: var(--primary);
    transform: translateY(-4px);
    box-shadow: var(--shadow-glow);
}

.action-card i {
    font-size: 36px;
    margin-bottom: var(--space-4);
}

.action-card.primary i { color: var(--primary); }
.action-card.blue i { color: var(--card-blue); }
.action-card.pink i { color: var(--card-pink); }
.action-card.gold i { color: var(--accent-gold); }
.action-card.teal i { color: var(--card-teal); }
.action-card.red i { color: var(--card-red); }
.action-card.indigo i { color: var(--card-indigo); }
.action-card.orange i { color: var(--card-orange); }

.stats-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-3);
    margin: var(--space-5) 0;
}

.stat-card {
    background: var(--bg-tertiary);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    text-align: center;
}

.stat-value {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: var(--space-1);
}

.stat-label {
    font-size: 12px;
    color: var(--gray-400);
}

.featured-events {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-4);
}

.event-card-featured {
    background: var(--bg-card);
    border-radius: var(--radius-2xl);
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all var(--transition);
    cursor: pointer;
    position: relative;
}

.event-card-featured:hover {
    transform: translateY(-4px);
    border-color: var(--primary);
    box-shadow: var(--shadow-glow);
}

.event-card-featured .event-card-image {
    width: 100%;
    height: 160px;
    background-size: cover;
    background-position: center;
    position: relative;
}

.event-card-overlay {
    position: absolute;
    top: 12px;
    left: 12px;
    right: 12px;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}

.event-card-featured .event-card-content {
    padding: var(--space-4);
}

/* ===== ADDITIONAL STYLES FOR NEW COMPONENTS ===== */

/* Color Options for Event Wizard */
.color-option {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-full);
    cursor: pointer;
    border: 3px solid transparent;
    transition: all var(--transition);
}

.color-option.active {
    border-color: var(--white);
    transform: scale(1.1);
    box-shadow: var(--shadow-glow);
}

.color-option:hover {
    transform: scale(1.05);
}

/* Share Modal Styles */
.share-modal {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.9);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 2000;
    backdrop-filter: blur(10px);
}

.share-modal .modal-content {
    max-width: 400px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
}

/* Loading Spinner */
.loading-spinner {
    width: 40px;
    height: 40px;
    border: 3px solid rgba(255, 255, 255, 0.1);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Empty State Styling */
.empty-state {
    text-align: center;
    padding: var(--space-8) var(--space-5);
}

.empty-state i {
    font-size: 64px;
    color: var(--gray-600);
    margin-bottom: var(--space-4);
}

.empty-state h3 {
    margin-bottom: var(--space-2);
    font-size: 20px;
}

.empty-state p {
    color: var(--gray-400);
    margin-bottom: var(--space-6);
}

/* Event Wizard Specific */
.event-wizard-modal .modal-content {
    max-width: 450px;
}

.wizard-progress {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-6);
    position: relative;
}

.wizard-progress::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--gray-700);
    z-index: 1;
    transform: translateY(-50%);
}

.progress-step {
    position: relative;
    z-index: 2;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: var(--bg-tertiary);
    border: 2px solid var(--gray-700);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 14px;
    color: var(--gray-400);
    transition: all var(--transition);
}

.progress-step.active {
    background: var(--primary);
    border-color: var(--primary);
    color: white;
}

.progress-step.completed {
    background: var(--accent-green);
    border-color: var(--accent-green);
    color: white;
}

.wizard-step {
    display: none;
    animation: fadeIn 0.3s ease;
}

.wizard-step.active {
    display: block;
}

.wizard-navigation {
    display: flex;
    justify-content: space-between;
    margin-top: var(--space-6);
    padding-top: var(--space-4);
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

/* Geofence Map Container */
.geofence-map-container {
    width: 100%;
    height: 250px;
    background: var(--bg-tertiary);
    border-radius: var(--radius-lg);
    overflow: hidden;
    margin: var(--space-3) 0;
    position: relative;
}

/* Ticket Box Specific */
.ticket-box-page {
    padding: var(--space-5);
}

.ticket-tabs {
    display: flex;
    background: var(--bg-tertiary);
    border-radius: var(--radius);
    padding: var(--space-1);
    margin-bottom: var(--space-5);
}

.ticket-tab {
    flex: 1;
    padding: var(--space-3);
    text-align: center;
    background: none;
    border: none;
    color: var(--gray-400);
    font-weight: 600;
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    min-height: 44px;
}

.ticket-tab.active {
    background: var(--primary);
    color: var(--white);
}

.ticket-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
}

.ticket-card {
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all var(--transition);
}

.ticket-card:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
    box-shadow: var(--shadow-glow);
}

.ticket-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--space-3);
}

.ticket-event {
    flex: 1;
}

.ticket-status {
    padding: var(--space-1) var(--space-3);
    border-radius: var(--radius-full);
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.ticket-status.active {
    background: var(--accent-green);
    color: white;
}

.ticket-status.used {
    background: var(--gray-600);
    color: white;
}

.ticket-status.expired {
    background: var(--accent-red);
    color: white;
}

.ticket-details {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-3);
    margin-bottom: var(--space-4);
}

.ticket-detail {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: 14px;
    color: var(--gray-400);
}

.ticket-detail i {
    color: var(--primary);
    width: 20px;
    text-align: center;
}

.ticket-qr {
    width: 80px;
    height: 80px;
    background: white;
    border-radius: var(--radius);
    display: flex;
    align-items: center;
    justify-content: center;
    color: black;
    font-weight: bold;
    margin: 0 auto var(--space-4);
    overflow: hidden;
    font-size: 10px;
    text-align: center;
    padding: var(--space-2);
    word-break: break-all;
}

.ticket-actions {
    display: flex;
    gap: var(--space-3);
}

/* Settings Page Specific */
.settings-page {
    padding: var(--space-5);
}

.settings-section {
    margin-bottom: var(--space-6);
}

.settings-section h3 {
    margin-bottom: var(--space-4);
    font-size: 18px;
    color: var(--white);
}

.settings-option {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-4);
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    margin-bottom: var(--space-2);
    cursor: pointer;
    transition: all var(--transition);
    min-height: 44px;
}

.settings-option:hover {
    background: var(--bg-tertiary);
}

.settings-info {
    display: flex;
    align-items: center;
    gap: var(--space-3);
}

.settings-value {
    color: var(--gray-400);
    font-size: 14px;
}

.settings-divider {
    height: 1px;
    background: rgba(255, 255, 255, 0.1);
    margin: var(--space-4) 0;
}

/* Privacy Settings */
.privacy-option {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    padding: var(--space-4);
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    margin-bottom: var(--space-2);
    cursor: pointer;
    transition: all var(--transition);
    border: 2px solid transparent;
}

.privacy-option:hover {
    border-color: rgba(255, 255, 255, 0.1);
}

.privacy-option i.fa-check {
    color: var(--primary);
    font-size: 16px;
}

/* Event Management */
.event-management-page {
    padding: var(--space-5);
}

.event-management-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-5);
}

.organizer-events {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
}

.organizer-event-card {
    background: var(--bg-card);
    border-radius: var(--radius-xl);
    padding: var(--space-4);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all var(--transition);
}

.organizer-event-card:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
}

.organizer-event-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--space-3);
}

.organizer-event-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-3);
    margin: var(--space-3) 0;
}

.organizer-stat {
    text-align: center;
    padding: var(--space-2);
    background: var(--bg-tertiary);
    border-radius: var(--radius);
}

.organizer-stat-value {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: var(--space-1);
}

.organizer-stat-label {
    font-size: 12px;
    color: var(--gray-400);
}

.organizer-event-actions {
    display: flex;
    gap: var(--space-2);
    margin-top: var(--space-3);
    flex-wrap: wrap;
}

/* Chat Interface Specific */
.chat-interface {
    height: calc(100vh - var(--header-height));
    display: flex;
    flex-direction: column;
    background: var(--bg-primary);
}

.chat-header {
    padding: var(--space-4) var(--space-5);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    gap: var(--space-3);
    background: var(--bg-secondary);
    position: sticky;
    top: 0;
    z-index: 10;
}

.chat-avatar {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-full);
    background-size: cover;
    background-position: center;
    border: 2px solid var(--primary);
}

.chat-info {
    flex: 1;
}

.chat-name {
    font-weight: 600;
    font-size: 16px;
}

.chat-status {
    font-size: 12px;
    color: var(--gray-400);
}

.chat-actions {
    display: flex;
    gap: var(--space-3);
}

.chat-actions button {
    background: none;
    border: none;
    color: var(--gray-400);
    font-size: 18px;
    cursor: pointer;
    padding: var(--space-2);
    border-radius: var(--radius-full);
    min-height: 44px;
    min-width: 44px;
}

.chat-actions button:hover {
    background: rgba(255, 255, 255, 0.05);
}

.chat-messages {
    flex: 1;
    padding: var(--space-4);
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    background: var(--bg-primary);
}

.message {
    display: flex;
    gap: var(--space-3);
    max-width: 85%;
    animation: messageAppear 0.3s ease;
}

.message.sent {
    align-self: flex-end;
    flex-direction: row-reverse;
}

.message.received {
    align-self: flex-start;
}

.message-avatar {
    width: 32px;
    height: 32px;
    border-radius: var(--radius-full);
    background-size: cover;
    background-position: center;
    flex-shrink: 0;
    align-self: flex-end;
}

.message-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
    max-width: 100%;
}

.message-bubble {
    padding: var(--space-3) var(--space-4);
    border-radius: 18px;
    max-width: 280px;
    word-wrap: break-word;
    line-height: 1.4;
    font-size: 14px;
}

.message.sent .message-bubble {
    background: var(--primary);
    color: var(--white);
    border-bottom-right-radius: 4px;
}

.message.received .message-bubble {
    background: var(--bg-tertiary);
    color: var(--white);
    border-bottom-left-radius: 4px;
}

.message-time {
    font-size: 11px;
    color: var(--gray-500);
    padding: 0 var(--space-2);
}

.message.sent .message-time {
    text-align: right;
}

.message.received .message-time {
    text-align: left;
}

.chat-input-container {
    padding: var(--space-3) var(--space-4);
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    background: var(--bg-secondary);
    display: flex;
    align-items: center;
    gap: var(--space-3);
    position: sticky;
    bottom: 0;
}

.chat-input {
    flex: 1;
    padding: var(--space-3) var(--space-4);
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-full);
    color: var(--white);
    font-size: 14px;
    resize: none;
    min-height: 44px;
    max-height: 100px;
    font-family: inherit;
}

.chat-input:focus {
    outline: none;
    border-color: var(--primary);
}

.chat-send-btn {
    background: var(--primary);
    color: white;
    border: none;
    border-radius: var(--radius-full);
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition);
    flex-shrink: 0;
}

.chat-send-btn:hover {
    background: var(--primary-light);
    transform: scale(1.05);
}

/* Matches Page Specific */
.matches-page {
    padding: var(--space-5);
}

.matches-header {
    margin-bottom: var(--space-5);
}

.matches-header h2 {
    font-size: 24px;
    font-weight: 700;
}

.matches-search {
    position: relative;
    margin-bottom: var(--space-4);
}

.matches-search input {
    width: 100%;
    padding: var(--space-3) var(--space-4) var(--space-3) 44px;
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-full);
    color: var(--white);
    font-size: 14px;
    font-family: inherit;
}

.matches-search input:focus {
    outline: none;
    border-color: var(--primary);
}

.matches-search i {
    position: absolute;
    left: var(--space-4);
    top: 50%;
    transform: translateY(-50%);
    color: var(--gray-400);
}

.matches-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
}

.match-item {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    padding: var(--space-3);
    background: transparent;
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition);
    position: relative;
}

.match-item:hover {
    background: rgba(255, 255, 255, 0.05);
}

.match-avatar {
    width: 56px;
    height: 56px;
    border-radius: var(--radius-full);
    background-size: cover;
    background-position: center;
    border: 2px solid var(--primary);
    position: relative;
    flex-shrink: 0;
}

.match-status {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--accent-green);
    border: 2px solid var(--bg-primary);
}

.match-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
    min-width: 0;
}

.match-name {
    font-weight: 600;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 16px;
}

.match-name span:first-child {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.match-time {
    font-size: 12px;
    color: var(--gray-500);
    flex-shrink: 0;
    margin-left: var(--space-2);
}

.match-last-message {
    font-size: 14px;
    color: var(--gray-400);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--space-2);
}

.match-last-message span:first-child {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    flex: 1;
}

.unread-badge {
    background: var(--primary);
    color: white;
    font-size: 12px;
    padding: 2px 6px;
    border-radius: 10px;
    min-width: 18px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    font-weight: 600;
}

/* Comment Section */
.comment-section {
    margin-top: var(--space-6);
    background: var(--bg-card);
    border-radius: var(--radius-xl);
    padding: var(--space-5);
}

.comment-section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-4);
}

.comment-section-header h2 {
    font-size: 20px;
    font-weight: 700;
}

.comment-section-header span {
    color: var(--gray-400);
    font-size: 14px;
}

.comments-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    margin-bottom: var(--space-4);
}

.comment {
    display: flex;
    gap: var(--space-3);
    animation: commentAppear 0.3s ease;
}

.comment-avatar {
    width: 32px;
    height: 32px;
    border-radius: var(--radius-full);
    background-size: cover;
    background-position: center;
    flex-shrink: 0;
}

.comment-content {
    flex: 1;
}

.comment-header {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin-bottom: var(--space-1);
}

.comment-author {
    font-weight: 600;
    font-size: 14px;
}

.comment-time {
    font-size: 12px;
    color: var(--gray-500);
}

.comment-text {
    font-size: 14px;
    line-height: 1.5;
    margin-bottom: var(--space-2);
    color: var(--gray-300);
}

.comment-actions {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    font-size: 12px;
    color: var(--gray-500);
}

.comment-action {
    display: flex;
    align-items: center;
    gap: var(--space-1);
    background: none;
    border: none;
    color: var(--gray-500);
    cursor: pointer;
    padding: var(--space-1);
    border-radius: var(--radius);
    transition: all var(--transition-fast);
    font-size: 12px;
}

.comment-action:hover {
    color: var(--primary);
    background: rgba(139, 92, 246, 0.1);
}

.comment-form {
    display: flex;
    gap: var(--space-3);
    align-items: flex-start;
    margin-top: var(--space-4);
}

.comment-input {
    flex: 1;
    padding: var(--space-3) var(--space-4);
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-full);
    color: var(--white);
    font-size: 14px;
    resize: none;
    min-height: 44px;
    max-height: 100px;
    font-family: inherit;
}

.comment-input:focus {
    outline: none;
    border-color: var(--primary);
}

.comment-submit {
    background: var(--primary);
    color: white;
    border: none;
    border-radius: var(--radius-full);
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition);
    flex-shrink: 0;
}

.comment-submit:hover {
    background: var(--primary-light);
    transform: scale(1.05);
}

/* Photo Dump - WhatsApp Style */
.photo-dump-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-3);
    margin-bottom: var(--space-4);
}

@media (min-width: 640px) {
    .photo-dump-grid {
        grid-template-columns: repeat(4, 1fr);
    }
}

.photo-dump-item {
    position: relative;
    aspect-ratio: 1;
    border-radius: var(--radius-lg);
    overflow: hidden;
    cursor: pointer;
}

.photo-dump-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition);
}

.photo-dump-item:hover img {
    transform: scale(1.05);
}

.photo-dump-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    font-weight: bold;
    color: white;
}

.photo-watermark {
    position: absolute;
    bottom: 8px;
    left: 8px;
    right: 8px;
    background: rgba(0, 0, 0, 0.7);
    padding: 8px;
    border-radius: var(--radius);
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 12px;
    backdrop-filter: blur(10px);
}

.photo-watermark .ampz-logo {
    font-weight: bold;
    color: white;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 10px;
}

.download-photo-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    border: none;
    border-radius: var(--radius-full);
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition);
    min-height: 32px;
    min-width: 32px;
    backdrop-filter: blur(10px);
}

.download-photo-btn:hover {
    background: rgba(0, 0, 0, 0.9);
    transform: scale(1.1);
}

/* Search Suggestions */
.search-suggestions {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    margin-top: var(--space-2);
    z-index: 1000;
    max-height: 200px;
    overflow-y: auto;
    display: none;
    box-shadow: var(--shadow-lg);
}

.search-suggestions.active {
    display: block;
    animation: slideDown 0.2s ease;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.suggestion-item {
    padding: var(--space-3) var(--space-4);
    cursor: pointer;
    transition: background var(--transition-fast);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    display: flex;
    align-items: center;
    gap: var(--space-3);
    color: var(--gray-300);
    font-size: 14px;
}

.suggestion-item:last-child {
    border-bottom: none;
}

.suggestion-item:hover {
    background: rgba(255, 255, 255, 0.05);
}

.suggestion-item i {
    color: var(--primary);
    width: 16px;
}

/* Modal Header */
.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-5);
    padding-bottom: var(--space-3);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.modal-header h2,
.modal-header h3 {
    margin: 0;
    font-size: 20px;
}

.modal-close {
    background: none;
    border: none;
    color: var(--gray-400);
    font-size: 20px;
    cursor: pointer;
    padding: var(--space-2);
    border-radius: var(--radius-full);
    min-height: 44px;
    min-width: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-close:hover {
    background: rgba(255, 255, 255, 0.1);
}

/* Additional Animations */
@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes commentAppear {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Form Validation */
.form-control:invalid:focus {
    border-color: var(--accent-red);
    box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.3);
}

.error-message {
    color: var(--accent-red);
    font-size: 12px;
    margin-top: var(--space-1);
    display: none;
}

.form-control:invalid + .error-message {
    display: block;
}

/* Scrollbar Styling for Modals */
.modal-content::-webkit-scrollbar {
    width: 6px;
}

.modal-content::-webkit-scrollbar-track {
    background: transparent;
}

.modal-content::-webkit-scrollbar-thumb {
    background: var(--primary);
    border-radius: 3px;
}

/* Responsive Adjustments */
@media (max-width: 480px) {
    .photo-dump-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .ticket-details {
        grid-template-columns: 1fr;
    }
    
    .organizer-event-stats {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .chat-message-bubble {
        max-width: 250px;
    }
    
    .share-modal-options {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 375px) {
    .photo-dump-grid {
        grid-template-columns: 1fr;
    }
    
    .organizer-event-stats {
        grid-template-columns: 1fr;
    }
    
    .share-modal-options {
        grid-template-columns: 1fr;
    }
}

/* Touch Device Optimizations */
@media (hover: none) and (pointer: coarse) {
    .action-card:hover,
    .ticket-card:hover,
    .organizer-event-card:hover,
    .match-item:hover {
        transform: none;
    }
    
    .action-card:active,
    .ticket-card:active,
    .organizer-event-card:active,
    .match-item:active {
        background: rgba(255, 255, 255, 0.05);
    }
}

/* High Contrast Mode Support */
@media (prefers-contrast: high) {
    .btn,
    .card,
    .modal-content,
    .settings-option {
        border: 2px solid var(--white);
    }
    
    .btn-primary {
        border-color: var(--primary);
    }
    
    .btn-outline {
        border-color: currentColor;
    }
}

/* Reduced Motion Support */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* Print Styles */
@media print {
    .navbar,
    .bottom-nav,
    .chat-input-container,
    .comment-form,
    .event-actions,
    .download-photo-btn,
    .modal-close,
    .btn {
        display: none !important;
    }
    
    .app {
        max-width: none;
    }
    
    body {
        background: white !important;
        color: black !important;
    }
    
    .card,
    .modal-content {
        background: white !important;
        color: black !important;
        border: 1px solid black !important;
        box-shadow: none !important;
    }
}

/* Accessibility Focus Styles */
.skip-to-content {
    position: absolute;
    top: -40px;
    left: 0;
    background: var(--primary);
    color: white;
    padding: var(--space-3);
    text-decoration: none;
    z-index: 9999;
}

.skip-to-content:focus {
    top: 0;
}

/* Screen Reader Only */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

.bookmark-btn {
    position: absolute;
    top: 12px;
    right: 12px;
    width: 36px;
    height: 36px;
    border-radius: var(--radius-full);
    background: rgba(0, 0, 0, 0.7);
    border: none;
    color: var(--gray-400);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition);
    z-index: 2;
    min-height: 36px;
    min-width: 36px;
}

.bookmark-btn:hover {
    background: rgba(0, 0, 0, 0.9);
    color: var(--white);
}

.bookmark-btn.active {
    color: var(--accent-gold);
    background: rgba(245, 222, 179, 0.2);
}

.bookmark-btn.active:hover {
    background: rgba(245, 222, 179, 0.3);
}

.bookmarked-events {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
}

/* ===== ENHANCED EVENTS PAGE WITH MAP DRAWER ===== */
.events-container {
    position: fixed;
    top: var(--header-height);
    left: 0;
    right: 0;
    bottom: calc(var(--bottom-nav-height) + var(--safe-area-inset-bottom));
    z-index: 10;
    background: var(--bg-primary);
    transition: transform 0.4s var(--map-drawer-transition);
    transform: translateY(0);
    overflow: hidden;
    border-radius: var(--radius-2xl) var(--radius-2xl) 0 0;
    box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.3);
}

.events-container.dragging {
    transition: none;
}

.events-container.map-full {
    transform: translateY(calc(100% - 80px));
}

.events-container.map-half {
    transform: translateY(50%);
}

.map-drawer {
    position: fixed;
    top: var(--header-height);
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 5;
    background: var(--bg-primary);
    pointer-events: none;
}

.map-container {
    width: 100%;
    height: 100%;
    background: var(--bg-tertiary);
    pointer-events: all;
}

#map {
    width: 100%;
    height: 100%;
}

.events-header {
    padding: var(--space-6) var(--space-5) var(--space-4) var(--space-5);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    background: var(--bg-primary);
    border-radius: var(--radius-2xl) var(--radius-2xl) 0 0;
    position: relative;
    z-index: 2;
}

.events-list {
    height: calc(100% - 140px);
    overflow-y: auto;
    padding: var(--space-5);
    scrollbar-color: var(--primary) transparent;
    padding-right: var(--space-3);
}

.events-list::-webkit-scrollbar {
    width: 8px;
}

.events-list::-webkit-scrollbar-track {
    background: transparent;
}

.events-list::-webkit-scrollbar-thumb {
    background: var(--primary);
    border-radius: 4px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.events-list:hover::-webkit-scrollbar-thumb {
    opacity: 1;
}

.event-card-list {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    padding: var(--space-4);
    background: linear-gradient(90deg, transparent, var(--bg-card));
    border-radius: var(--radius-xl);
    border: 1px solid rgba(255, 255, 255, 0.1);
    margin-bottom: var(--space-3);
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: all var(--transition);
}

.event-card-list:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
}

.event-card-list::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 100px;
    background: linear-gradient(90deg, rgba(139, 92, 246, 0.2), transparent);
    z-index: 0;
}

.event-card-image {
    width: 80px;
    height: 80px;
    border-radius: var(--radius-lg);
    overflow: hidden;
    flex-shrink: 0;
    position: relative;
    z-index: 1;
}

.event-card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.event-card-content {
    flex: 1;
    position: relative;
    z-index: 1;
}

.map-handle {
    position: absolute;
    top: 12px;
    left: 0;
    right: 0;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    z-index: 20;
    cursor: grab;
    border-radius: var(--radius-2xl) var(--radius-2xl) 0 0;
    pointer-events: auto;
}

.map-handle:active {
    cursor: grabbing;
}

.map-handle-bar {
    width: 40px;
    height: 4px;
    background: var(--gray-600);
    border-radius: 2px;
    transition: all var(--transition);
}

.map-handle:hover .map-handle-bar {
    background: var(--primary);
    width: 60px;
}

/* Enhanced Map Markers */
.map-marker {
    position: relative;
    cursor: pointer;
    transition: transform 0.3s ease;
}

.map-marker:hover {
    transform: scale(1.2);
}

/* ===== MAP PAGE SPECIFIC STYLES ===== */
.map-page {
    position: fixed;
    top: var(--header-height);
    left: 0;
    right: 0;
    bottom: calc(var(--bottom-nav-height) + var(--safe-area-inset-bottom));
    background: var(--bg-primary);
    display: flex;
    flex-direction: column;
}

.map-page-header {
    padding: var(--space-4) var(--space-5);
    background: var(--bg-secondary);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    z-index: 10;
}

.map-search-container {
    display: flex;
    gap: var(--space-3);
    margin-bottom: var(--space-3);
}

.map-search-input-wrapper {
    flex: 1;
    position: relative;
}

.map-search-input {
    width: 100%;
    padding: 14px var(--space-4) 14px 44px;
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-xl);
    color: var(--white);
    font-size: 16px;
}

.map-search-input:focus {
    outline: none;
    border-color: var(--primary);
}

.map-search-icon {
    position: absolute;
    left: var(--space-4);
    top: 50%;
    transform: translateY(-50%);
    color: var(--gray-400);
}

.map-controls {
    display: flex;
    gap: var(--space-2);
}

.map-control-btn {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-full);
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: var(--white);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition);
}

.map-control-btn:hover {
    background: var(--primary);
    transform: scale(1.05);
}

.map-control-btn.active {
    background: var(--primary);
    color: white;
}

.map-filters {
    display: flex;
    gap: var(--space-2);
    overflow-x: auto;
    padding-bottom: var(--space-2);
    -webkit-overflow-scrolling: touch;
}

.map-filter-chip {
    padding: var(--space-2) var(--space-4);
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-full);
    font-size: 14px;
    color: var(--gray-300);
    cursor: pointer;
    white-space: nowrap;
    transition: all var(--transition);
}

.map-filter-chip:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.2);
}

.map-filter-chip.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.map-container-full {
    flex: 1;
    position: relative;
    background: var(--bg-tertiary);
}

.map-container-full #map {
    width: 100%;
    height: 100%;
}

.map-user-location {
    position: absolute;
    bottom: var(--space-5);
    right: var(--space-5);
    z-index: 1000;
}

.map-user-location-btn {
    width: 56px;
    height: 56px;
    border-radius: var(--radius-full);
    background: var(--primary);
    color: white;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: var(--shadow-lg);
    transition: all var(--transition);
}

.map-user-location-btn:hover {
    background: var(--primary-light);
    transform: scale(1.1);
}

.map-legend {
    position: absolute;
    bottom: var(--space-5);
    left: var(--space-5);
    background: var(--bg-card);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    padding: var(--space-3);
    backdrop-filter: blur(20px);
    z-index: 1000;
    max-width: 200px;
}

.map-legend-item {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin-bottom: var(--space-2);
    font-size: 12px;
}

.map-legend-color {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.map-legend-color.user {
    background: var(--accent-green);
}

.map-legend-color.event {
    background: var(--primary);
}

.map-legend-color.geofence {
    background: rgba(139, 92, 246, 0.3);
    border: 1px dashed var(--primary);
}

.map-event-list {
    position: absolute;
    top: var(--space-5);
    right: var(--space-5);
    width: 300px;
    max-height: 60vh;
    overflow-y: auto;
    background: var(--bg-card);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    backdrop-filter: blur(20px);
    z-index: 1000;
    display: none;
}

.map-event-list.active {
    display: block;
    animation: slideInFromRight 0.3s ease;
}

.map-event-list-header {
    padding: var(--space-4);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.map-event-list-content {
    padding: var(--space-4);
}

.map-event-item {
    padding: var(--space-3);
    background: var(--bg-tertiary);
    border-radius: var(--radius);
    margin-bottom: var(--space-2);
    cursor: pointer;
    transition: all var(--transition);
    border: 1px solid transparent;
}

.map-event-item:hover {
    border-color: var(--primary);
    transform: translateX(4px);
}

.map-event-item.active {
    background: rgba(139, 92, 246, 0.2);
    border-color: var(--primary);
}

.map-layer-controls {
    position: absolute;
    top: var(--space-5);
    left: var(--space-5);
    background: var(--bg-card);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    padding: var(--space-3);
    backdrop-filter: blur(20px);
    z-index: 1000;
}

.map-layer-option {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2);
    cursor: pointer;
    border-radius: var(--radius);
    transition: background var(--transition-fast);
}

.map-layer-option:hover {
    background: rgba(255, 255, 255, 0.05);
}

.map-layer-checkbox {
    width: 18px;
    height: 18px;
    border: 2px solid var(--gray-500);
    border-radius: var(--radius-sm);
    display: flex;
    align-items: center;
    justify-content: center;
}

.map-layer-checkbox.checked {
    background: var(--primary);
    border-color: var(--primary);
}

.map-layer-checkbox.checked::after {
    content: '';
    color: white;
    font-size: 12px;
}

/* Map Popup Enhanced */
.mapboxgl-popup-content {
    background: var(--bg-card) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: var(--radius-lg) !important;
    padding: 0 !important;
    color: var(--white) !important;
    max-width: 300px !important;
    backdrop-filter: blur(20px);
}

.mapboxgl-popup-close-button {
    color: var(--white) !important;
    font-size: 20px !important;
    padding: var(--space-2) !important;
    min-height: 44px;
    min-width: 44px;
}

.mapboxgl-popup-close-button:hover {
    background: rgba(255, 255, 255, 0.1) !important;
}

.map-popup-content {
    padding: var(--space-4);
}

.map-popup-header {
    padding: var(--space-3) var(--space-4);
    background: var(--primary);
    color: white;
    border-radius: var(--radius-lg) var(--radius-lg) 0 0;
}

.map-popup-body {
    padding: var(--space-4);
}

.map-popup-actions {
    display: flex;
    gap: var(--space-2);
    margin-top: var(--space-3);
}

/* Map Clusters */
.map-cluster {
    background: var(--primary);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    border: 3px solid white;
    box-shadow: 0 0 20px rgba(139, 92, 246, 0.5);
    cursor: pointer;
    transition: all var(--transition);
}

.map-cluster:hover {
    transform: scale(1.1);
    box-shadow: 0 0 30px rgba(139, 92, 246, 0.7);
}

/* Map Loading State */
.map-loading {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--bg-primary);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10000;
}

.map-loading-spinner {
    width: 60px;
    height: 60px;
    border: 4px solid rgba(255, 255, 255, 0.1);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: var(--space-4);
}

.map-loading-text {
    color: var(--gray-400);
    font-size: 14px;
}

/* Map Error State */
.map-error {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--bg-primary);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    padding: var(--space-5);
    text-align: center;
}

.map-error i {
    font-size: 64px;
    color: var(--accent-red);
    margin-bottom: var(--space-4);
}

.map-error h3 {
    margin-bottom: var(--space-2);
}

.map-error p {
    color: var(--gray-400);
    margin-bottom: var(--space-4);
}

/* Map Attribution */
.mapboxgl-ctrl.mapboxgl-ctrl-attrib {
    background: rgba(0, 0, 0, 0.7) !important;
    color: var(--gray-400) !important;
    border-radius: var(--radius) !important;
    padding: var(--space-2) var(--space-3) !important;
    font-size: 11px !important;
    backdrop-filter: blur(10px);
}

.mapboxgl-ctrl.mapboxgl-ctrl-attrib a {
    color: var(--primary-light) !important;
}

/* Map Compass */
.mapboxgl-ctrl.mapboxgl-ctrl-compass {
    background: var(--bg-card) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: var(--radius) !important;
    box-shadow: var(--shadow) !important;
}

.mapboxgl-ctrl.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon {
    background-image: none !important;
    color: var(--white) !important;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Map Zoom Controls */
.mapboxgl-ctrl.mapboxgl-ctrl-group {
    background: var(--bg-card) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: var(--radius) !important;
    box-shadow: var(--shadow) !important;
    overflow: hidden;
}

.mapboxgl-ctrl.mapboxgl-ctrl-group button {
    background: transparent !important;
    border: none !important;
    color: var(--white) !important;
    width: 30px !important;
    height: 30px !important;
}

.mapboxgl-ctrl.mapboxgl-ctrl-group button:hover {
    background: rgba(255, 255, 255, 0.05) !important;
}

.mapboxgl-ctrl.mapboxgl-ctrl-group button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon,
.mapboxgl-ctrl.mapboxgl-ctrl-group button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon {
    background-image: none !important;
    position: relative;
}

.mapboxgl-ctrl.mapboxgl-ctrl-group button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon::after {
    content: '+';
    font-size: 20px;
    font-weight: bold;
}

.mapboxgl-ctrl.mapboxgl-ctrl-group button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon::after {
    content: '';
    font-size: 20px;
    font-weight: bold;
}

/* Map Scale */
.mapboxgl-ctrl.mapboxgl-ctrl-scale {
    background: var(--bg-card) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: var(--radius) !important;
    color: var(--white) !important;
    font-size: 11px !important;
    padding: var(--space-1) var(--space-2) !important;
    backdrop-filter: blur(10px);
}

.marker-pin {
    width: 32px;
    height: 32px;
    border-radius: 50% 50% 50% 0;
    background: var(--primary);
    transform: rotate(-45deg);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}

.marker-pin i {
    color: white;
    transform: rotate(45deg);
    font-size: 16px;
}

.marker-pulse {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: var(--primary);
    opacity: 0.2;
    animation: pulse 2s infinite;
}

.user-location-marker {
    width: 24px;
    height: 24px;
    background: var(--accent-green);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 12px;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.4);
    border: 2px solid white;
}

/* Map Popup */
.map-popup-content {
    min-width: 250px;
    overflow: hidden;
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.popup-header {
    padding: var(--space-3) var(--space-4);
    color: white;
    background: var(--primary);
}

.popup-header h4 {
    margin: 0;
    font-size: 16px;
    line-height: 1.2;
}

.popup-distance {
    font-size: 12px;
    opacity: 0.9;
}

.popup-body {
    padding: var(--space-4);
    background: var(--bg-card);
}

.popup-info p {
    margin: 0 0 var(--space-2) 0;
    font-size: 14px;
    color: var(--gray-300);
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.popup-info i {
    width: 20px;
    color: var(--primary);
}

.popup-actions {
    display: flex;
    gap: var(--space-2);
    margin-top: var(--space-3);
}

.popup-actions .btn {
    flex: 1;
    padding: var(--space-2) var(--space-3);
    font-size: 12px;
    min-height: 36px;
}

/* ===== ENHANCED SEARCH ===== */
.search-container {
    position: relative;
    width: 100%;
    margin-bottom: var(--space-4);
}

.search-input-wrapper {
    position: relative;
    display: flex;
    align-items: center;
}

.search-input-wrapper i {
    position: absolute;
    left: var(--space-4);
    color: var(--gray-400);
    z-index: 1;
}

.search-input {
    width: 100%;
    padding: 14px var(--space-4) 14px 44px;
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-xl);
    color: var(--white);
    font-size: 16px;
    transition: all var(--transition);
    font-size: 16px; /* Prevent iOS zoom */
}

.search-input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px var(--primary-glow);
}

.clear-search {
    position: absolute;
    right: var(--space-3);
    background: none;
    border: none;
    color: var(--gray-400);
    cursor: pointer;
    padding: var(--space-2);
    border-radius: var(--radius-full);
    transition: all var(--transition);
    min-height: 44px;
    min-width: 44px;
}

.clear-search:hover {
    background: rgba(255, 255, 255, 0.1);
    color: var(--white);
}

.search-button {
    margin-left: var(--space-3);
    padding: 14px var(--space-4);
    min-width: 80px;
}

.search-suggestions {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius);
    margin-top: var(--space-2);
    z-index: 1000;
    max-height: 200px;
    overflow-y: auto;
    display: none;
}

.search-suggestions.active {
    display: block;
}

.suggestion-item {
    padding: var(--space-3) var(--space-4);
    cursor: pointer;
    transition: background var(--transition-fast);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.suggestion-item:hover {
    background: rgba(255, 255, 255, 0.05);
}

.suggestion-item:last-child {
    border-bottom: none;
}

/* ===== FILTER PILLS ===== */
.filter-pills {
    display: flex;
    gap: var(--space-2);
    margin: var(--space-4) 0;
    flex-wrap: wrap;
}

.filter-pill {
    padding: var(--space-2) var(--space-4);
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-full);
    font-size: 14px;
    color: var(--gray-300);
    cursor: pointer;
    transition: all var(--transition);
    display: flex;
    align-items: center;
    gap: var(--space-2);
    min-height: 36px;
}

.filter-pill:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.2);
}

.filter-pill.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.filter-pill .remove {
    font-size: 12px;
    opacity: 0.7;
}

.filter-pill .remove:hover {
    opacity: 1;
}

/* ===== CONNECT (SWIPE) PAGE ===== */
.swipe-interface {
    height: calc(100vh - var(--header-height) - var(--bottom-nav-height));
    display: flex;
    flex-direction: column;
}

.swipe-header {
    padding: var(--space-5);
}

.card-stack {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-5);
    position: relative;
}

.card-container {
    width: 100%;
    max-width: 280px;
    aspect-ratio: 3/4;
    position: relative;
}

@media (max-width: 480px) {
    .card-container {
        max-width: 90%;
        margin: 0 auto;
    }
}

.profile-card {
    position: absolute;
    width: 100%;
    height: 100%;
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s;
    cursor: grab;
    z-index: 1;
    border-radius: var(--radius-xl);
    overflow: hidden;
}

.profile-card:active {
    cursor: grabbing;
}

.card-content {
    position: relative;
    width: 100%;
    height: 100%;
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-card-stack);
}

.card-frame {
    position: absolute;
    width: 110%;
    height: 110%;
    top: -8%;
    left: -5%;
    background: var(--accent-gold);
    border-radius: var(--radius-xl);
    transform: rotate(-3deg);
    z-index: -1;
    box-shadow: var(--shadow-gold);
}

.profile-image {
    width: 85%;
    aspect-ratio: 1/1;
    margin: var(--space-5) auto 0;
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    background-size: cover;
    background-position: center;
    position: relative;
}

.profile-info {
    padding: var(--space-5) var(--space-6);
    text-align: center;
}

.profile-info h2 {
    font-size: 1.5rem;
    margin-bottom: var(--space-1);
    color: var(--gray-800);
    font-weight: 700;
    letter-spacing: -0.02em;
}

.profile-info p {
    font-size: 13px;
    color: var(--gray-600);
    margin-bottom: var(--space-4);
    line-height: 1.5;
}

.interests {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    justify-content: center;
    margin-bottom: var(--space-5);
}

.interest-tag {
    font-size: 11px;
    padding: var(--space-1) 10px;
    border-radius: 12px;
    background: rgba(28, 28, 30, 0.08);
    color: var(--gray-600);
    font-weight: 600;
}

.swipe-actions {
    padding: var(--space-5);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--space-3);
    z-index: 50;
}

.action-button {
    width: 80px;
    height: 80px;
    border-radius: var(--radius-full);
    border: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    cursor: pointer;
    transition: all var(--transition);
    color: var(--white);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    min-height: 80px;
    min-width: 80px;
}

.action-button span {
    font-size: 12px;
    margin-top: var(--space-1);
    font-weight: 600;
}

.action-button.nope {
    background: var(--accent-red);
}

.action-button.rewind {
    background: var(--gray-600);
    width: 70px;
    height: 70px;
    font-size: 20px;
    min-height: 70px;
    min-width: 70px;
}

.action-button.rewind:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.action-button.refresh {
    background: var(--accent-blue);
    width: 70px;
    height: 70px;
    font-size: 20px;
    min-height: 70px;
    min-width: 70px;
}

.action-button.like {
    background: var(--card-pink);
}

.action-button:hover:not(:disabled) {
    transform: scale(1.05);
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
}

.action-button:active:not(:disabled) {
    transform: scale(0.95);
}

.stats-row {
    display: flex;
    justify-content: space-around;
    background: var(--bg-tertiary);
    border-radius: var(--radius-lg);
    padding: var(--space-3);
    margin-top: var(--space-4);
}

.stat {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 14px;
    color: var(--gray-300);
}

.stat i {
    color: var(--primary);
}

/* ===== EVENT DETAILS PAGE ===== */
.event-details-page {
    padding: var(--space-5);
    padding-top: calc(var(--header-height) + var(--space-5));
}

.event-details-header {
    position: relative;
    height: 300px;
    border-radius: var(--radius-2xl);
    overflow: hidden;
    margin-bottom: var(--space-5);
}

.event-details-header img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.event-details-header-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
    padding: var(--space-5);
}

.event-details-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-5);
}

.event-details-section {
    background: var(--bg-card);
    border-radius: var(--radius-xl);
    padding: var(--space-5);
}

.event-info-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-4);
    margin: var(--space-4) 0;
}

.event-info-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
}

.event-info-item i {
    color: var(--primary);
    font-size: 20px;
}

.event-tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    margin-top: var(--space-4);
}

.event-tag {
    background: var(--bg-tertiary);
    padding: 6px 12px;
    border-radius: var(--radius-full);
    font-size: 12px;
    color: var(--gray-300);
}

.event-actions {
    display: flex;
    gap: var(--space-3);
    margin-top: var(--space-5);
}

/* ===== COMMUNITY PHOTO DUMP (WHATSAPP STYLE) ===== */
.photo-dump-section {
    margin-top: var(--space-6);
}

.photo-dump-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-4);
}

.photo-dump-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-3);
    margin-bottom: var(--space-4);
}

.photo-dump-item {
    position: relative;
    aspect-ratio: 1;
    border-radius: var(--radius-lg);
    overflow: hidden;
    cursor: pointer;
}

.photo-dump-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.photo-dump-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    font-weight: bold;
    color: white;
}

.photo-watermark {
    position: absolute;
    bottom: 8px;
    left: 8px;
    right: 8px;
    background: rgba(0, 0, 0, 0.7);
    padding: 8px;
    border-radius: var(--radius);
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 12px;
}

.photo-watermark .ampz-logo {
    font-weight: bold;
    color: white;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.download-photo-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    border: none;
    border-radius: var(--radius-full);
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition);
    min-height: 32px;
    min-width: 32px;
}

.download-photo-btn:hover {
    background: rgba(0, 0, 0, 0.9);
    transform: scale(1.1);
}

.upload-photo-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    padding: var(--space-4);
    background: var(--bg-tertiary);
    border: 2px dashed rgba(255, 255, 255, 0.2);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition);
    margin-top: var(--space-4);
}

.upload-photo-btn:hover {
    border-color: var(--primary);
    background: rgba(139, 92, 246, 0.1);
}

/* ===== MATCHES/CHAT PAGE (INSTAGRAM STYLE) ===== */
.matches-page {
    padding: var(--space-5);
}

.matches-header {
    margin-bottom: var(--space-5);
}

.matches-search {
    position: relative;
    margin-bottom: var(--space-4);
}

.matches-search input {
    width: 100%;
    padding: var(--space-3) var(--space-4) var(--space-3) 44px;
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-full);
    color: var(--white);
    font-size: 14px;
}

.matches-search i {
    position: absolute;
    left: var(--space-4);
    top: 50%;
    transform: translateY(-50%);
    color: var(--gray-400);
}

.matches-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
}

.match-item {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    padding: var(--space-3);
    background: transparent;
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition);
    position: relative;
}

.match-item:hover {
    background: rgba(255, 255, 255, 0.05);
}

.match-avatar {
    width: 56px;
    height: 56px;
    border-radius: var(--radius-full);
    background-size: cover;
    background-position: center;
    border: 2px solid var(--primary);
    position: relative;
}

.match-status {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: var(--accent-green);
    border: 2px solid var(--bg-primary);
}

.match-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
}

.match-name {
    font-weight: 600;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.match-last-message {
    font-size: 14px;
    color: var(--gray-400);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.match-time {
    font-size: 12px;
    color: var(--gray-500);
}

.unread-badge {
    background: var(--primary);
    color: white;
    font-size: 12px;
    padding: 2px 6px;
    border-radius: 10px;
    min-width: 18px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* ===== CHAT INTERFACE (INSTAGRAM STYLE) ===== */
.chat-interface {
    height: calc(100vh - var(--header-height));
    display: flex;
    flex-direction: column;
    background: var(--bg-primary);
}

.chat-header {
    padding: var(--space-4) var(--space-5);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    gap: var(--space-3);
    background: var(--bg-secondary);
    position: sticky;
    top: 0;
    z-index: 10;
}

.chat-avatar {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-full);
    background-size: cover;
    background-position: center;
    border: 2px solid var(--primary);
}

.chat-info {
    flex: 1;
}

.chat-name {
    font-weight: 600;
    font-size: 16px;
}

.chat-status {
    font-size: 12px;
    color: var(--gray-400);
}

.chat-actions {
    display: flex;
    gap: var(--space-3);
}

.chat-actions button {
    background: none;
    border: none;
    color: var(--gray-400);
    font-size: 18px;
    cursor: pointer;
    padding: var(--space-2);
    border-radius: var(--radius-full);
    min-height: 44px;
    min-width: 44px;
}

.chat-actions button:hover {
    background: rgba(255, 255, 255, 0.05);
}

.chat-messages {
    flex: 1;
    padding: var(--space-4);
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    background: var(--bg-primary);
}

.message {
    display: flex;
    gap: var(--space-3);
    max-width: 85%;
    animation: messageAppear 0.3s ease;
}

.message.sent {
    align-self: flex-end;
    flex-direction: row-reverse;
}

.message.received {
    align-self: flex-start;
}

.message-avatar {
    width: 32px;
    height: 32px;
    border-radius: var(--radius-full);
    background-size: cover;
    background-position: center;
    flex-shrink: 0;
}

.message-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
}

.message-bubble {
    padding: var(--space-3) var(--space-4);
    border-radius: 18px;
    max-width: 280px;
    word-wrap: break-word;
    line-height: 1.4;
}

.message.sent .message-bubble {
    background: var(--primary);
    color: var(--white);
    border-bottom-right-radius: 4px;
}

.message.received .message-bubble {
    background: var(--bg-tertiary);
    color: var(--white);
    border-bottom-left-radius: 4px;
}

.message-time {
    font-size: 11px;
    color: var(--gray-500);
    padding: 0 var(--space-2);
}

.message.sent .message-time {
    text-align: right;
}

.message.received .message-time {
    text-align: left;
}

.chat-input-container {
    padding: var(--space-3) var(--space-4);
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    background: var(--bg-secondary);
    display: flex;
    align-items: center;
    gap: var(--space-3);
    position: sticky;
    bottom: 0;
}

.chat-input {
    flex: 1;
    padding: var(--space-3) var(--space-4);
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-full);
    color: var(--white);
    font-size: 14px;
    resize: none;
    min-height: 44px;
    max-height: 100px;
}

.chat-input:focus {
    outline: none;
    border-color: var(--primary);
}

.chat-send-btn {
    background: var(--primary);
    color: white;
    border: none;
    border-radius: var(--radius-full);
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition);
}

.chat-send-btn:hover {
    background: var(--primary-light);
    transform: scale(1.05);
}

/* ===== PROFILE PAGE ===== */
.profile-header {
    text-align: center;
    padding: var(--space-5);
}

.avatar {
    width: 100px;
    height: 100px;
    border-radius: var(--radius-full);
    background: linear-gradient(135deg, var(--primary), var(--primary-light));
    margin: 0 auto var(--space-4);
    position: relative;
    overflow: hidden;
    border: 3px solid var(--bg-primary);
    background-size: cover;
    background-position: center;
}

.avatar.pro {
    border: 3px solid transparent;
    border-image: var(--pro-gradient) 1;
}

.avatar.pro-plus {
    border: 3px solid transparent;
    border-image: var(--pro-plus-gradient) 1;
}

/* ===== ACCOUNT SETTINGS ===== */
.settings-page {
    padding: var(--space-5);
}

.settings-section {
    margin-bottom: var(--space-6);
}

.settings-section h3 {
    margin-bottom: var(--space-4);
    font-size: 18px;
}

.settings-option {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-4);
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    margin-bottom: var(--space-2);
    cursor: pointer;
    transition: all var(--transition);
    min-height: 44px;
}

.settings-option:hover {
    background: var(--bg-tertiary);
}

.settings-info {
    display: flex;
    align-items: center;
    gap: var(--space-3);
}

.settings-value {
    color: var(--gray-400);
    font-size: 14px;
}

.settings-divider {
    height: 1px;
    background: rgba(255, 255, 255, 0.1);
    margin: var(--space-4) 0;
}

/* ===== TICKET BOX ===== */
.ticket-box-page {
    padding: var(--space-5);
}

.ticket-tabs {
    display: flex;
    background: var(--bg-tertiary);
    border-radius: var(--radius);
    padding: var(--space-1);
    margin-bottom: var(--space-5);
}

.ticket-tab {
    flex: 1;
    padding: var(--space-3);
    text-align: center;
    background: none;
    border: none;
    color: var(--gray-400);
    font-weight: 600;
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    min-height: 44px;
}

.ticket-tab.active {
    background: var(--primary);
    color: var(--white);
}

.ticket-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
}

.ticket-card {
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all var(--transition);
}

.ticket-card:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
}

.ticket-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--space-3);
}

.ticket-event {
    flex: 1;
}

.ticket-status {
    padding: var(--space-1) var(--space-3);
    border-radius: var(--radius-full);
    font-size: 12px;
    font-weight: 600;
}

.ticket-status.active {
    background: var(--accent-green);
    color: white;
}

.ticket-status.used {
    background: var(--gray-600);
    color: white;
}

.ticket-status.expired {
    background: var(--accent-red);
    color: white;
}

.ticket-details {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-3);
    margin-bottom: var(--space-4);
}

.ticket-detail {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: 14px;
    color: var(--gray-400);
}

.ticket-detail i {
    color: var(--primary);
    width: 20px;
}

.ticket-qr {
    width: 80px;
    height: 80px;
    background: white;
    border-radius: var(--radius);
    display: flex;
    align-items: center;
    justify-content: center;
    color: black;
    font-weight: bold;
    margin: 0 auto;
    overflow: hidden;
}

.ticket-actions {
    display: flex;
    gap: var(--space-3);
    margin-top: var(--space-4);
}

/* ===== EVENT CREATION WIZARD ===== */
.wizard-progress {
    display: flex;
    justify-content: space-between;
    position: relative;
    margin-bottom: var(--space-6);
}

.wizard-progress::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 10%;
    right: 10%;
    height: 2px;
    background: var(--gray-700);
    z-index: 1;
}

.progress-step {
    position: relative;
    z-index: 2;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: var(--bg-tertiary);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    color: var(--gray-400);
    border: 2px solid var(--gray-700);
}

.progress-step.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

.progress-step.completed {
    background: var(--accent-green);
    color: white;
    border-color: var(--accent-green);
}

.wizard-step {
    display: none;
    animation: slideIn 0.3s ease;
}

.wizard-step.active {
    display: block;
}

.wizard-navigation {
    display: flex;
    justify-content: space-between;
    margin-top: var(--space-6);
}

/* Geofence Map */
.geofence-map-container {
    width: 100%;
    height: 300px;
    background: var(--bg-tertiary);
    border-radius: var(--radius-lg);
    overflow: hidden;
    margin: var(--space-4) 0;
    position: relative;
}

.geofence-radius-control {
    margin-top: var(--space-4);
}

.geofence-value {
    display: flex;
    justify-content: space-between;
    margin-bottom: var(--space-2);
    font-size: 14px;
    color: var(--gray-300);
}

.geofence-slider {
    width: 100%;
    height: 6px;
    border-radius: 3px;
    background: var(--bg-tertiary);
    outline: none;
    -webkit-appearance: none;
}

.geofence-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    border: 3px solid var(--white);
    box-shadow: var(--shadow);
}

.geofence-slider::-moz-range-thumb {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    border: 3px solid var(--white);
    box-shadow: var(--shadow);
}

/* Event Management */
.event-management-page {
    padding: var(--space-5);
}

.event-management-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-5);
}

.organizer-events {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
}

.organizer-event-card {
    background: var(--bg-card);
    border-radius: var(--radius-xl);
    padding: var(--space-4);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all var(--transition);
}

.organizer-event-card:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
}

.organizer-event-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--space-3);
}

.organizer-event-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-3);
    margin: var(--space-3) 0;
}

.organizer-stat {
    text-align: center;
    padding: var(--space-2);
    background: var(--bg-tertiary);
    border-radius: var(--radius);
}

.organizer-stat-value {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: var(--space-1);
}

.organizer-stat-label {
    font-size: 12px;
    color: var(--gray-400);
}

.organizer-event-actions {
    display: flex;
    gap: var(--space-2);
    margin-top: var(--space-3);
}

/* ===== FORMS ===== */
.form-group {
    margin-bottom: var(--space-5);
}

.form-label {
    display: block;
    margin-bottom: var(--space-2);
    color: var(--gray-300);
    font-weight: 500;
}

.form-control {
    width: 100%;
    padding: 14px var(--space-4);
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-xl);
    color: var(--white);
    font-size: 16px;
    transition: all var(--transition-fast);
    font-size: 16px; /* Prevent iOS zoom */
}

.form-control:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px var(--primary-glow);
}

textarea.form-control {
    min-height: 100px;
    resize: vertical;
}

/* ===== BADGES ===== */
.pro-badge {
    background: var(--pro-gradient);
    color: white;
    padding: 6px var(--space-4);
    border-radius: var(--radius-full);
    font-size: 12px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 6px;
}

.pro-plus-badge {
    background: var(--pro-plus-gradient);
    color: white;
    padding: 6px var(--space-4);
    border-radius: var(--radius-full);
    font-size: 12px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 6px;
}

.free-badge {
    background: var(--bg-tertiary);
    color: var(--gray-400);
    padding: 6px var(--space-4);
    border-radius: var(--radius-full);
    font-size: 12px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 6px;
}

.live-badge {
    background: var(--accent-green);
    color: white;
    padding: 6px var(--space-3);
    border-radius: var(--radius-full);
    font-size: 12px;
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    animation: pulse 2s infinite;
}

/* ===== TABS ===== */
.tabs {
    display: flex;
    background: var(--bg-tertiary);
    border-radius: var(--radius);
    padding: var(--space-1);
    margin-bottom: var(--space-5);
}

.tab-button {
    flex: 1;
    padding: var(--space-3);
    text-align: center;
    background: none;
    border: none;
    color: var(--gray-400);
    font-weight: 600;
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    min-height: 44px;
}

.tab-button.active {
    background: var(--primary);
    color: var(--white);
}

.tab-content {
    display: block;
}

.tab-pane {
    display: none;
    animation: fadeIn 0.3s ease;
}

.tab-pane.active {
    display: block;
}

/* ===== MODALS ===== */
.pro-modal, .match-modal, .filters-modal, .ticket-modal, .event-wizard-modal,
.chat-modal, .settings-modal, .currency-modal, .ticket-purchase-modal,
.emergency-modal, .report-modal, .analytics-modal, .camera-modal,
.event-management-modal, .photo-viewer-modal, .comment-modal {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.9);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 2000;
    backdrop-filter: blur(10px);
}

.modal-content {
    background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
    border-radius: var(--radius-2xl);
    padding: var(--space-6);
    max-width: 400px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    border: 1px solid rgba(255, 255, 255, 0.1);
    animation: modalAppear 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-5);
}

.modal-close {
    background: none;
    border: none;
    color: var(--gray-400);
    font-size: 20px;
    cursor: pointer;
    padding: var(--space-2);
    border-radius: var(--radius-full);
    min-height: 44px;
    min-width: 44px;
}

.modal-close:hover {
    background: rgba(255, 255, 255, 0.1);
}

/* ===== COMMENT SECTION (INSTAGRAM STYLE) ===== */
.comment-section {
    margin-top: var(--space-6);
}

.comment-section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-4);
}

.comments-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    margin-bottom: var(--space-4);
}

.comment {
    display: flex;
    gap: var(--space-3);
    animation: commentAppear 0.3s ease;
}

.comment-avatar {
    width: 32px;
    height: 32px;
    border-radius: var(--radius-full);
    background-size: cover;
    background-position: center;
    flex-shrink: 0;
}

.comment-content {
    flex: 1;
}

.comment-header {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    margin-bottom: var(--space-1);
}

.comment-author {
    font-weight: 600;
    font-size: 14px;
}

.comment-time {
    font-size: 12px;
    color: var(--gray-500);
}

.comment-text {
    font-size: 14px;
    line-height: 1.5;
    margin-bottom: var(--space-2);
}

.comment-actions {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    font-size: 12px;
    color: var(--gray-500);
}

.comment-action {
    display: flex;
    align-items: center;
    gap: var(--space-1);
    background: none;
    border: none;
    color: var(--gray-500);
    cursor: pointer;
    padding: var(--space-1);
    border-radius: var(--radius);
    transition: all var(--transition-fast);
}

.comment-action:hover {
    color: var(--primary);
    background: rgba(139, 92, 246, 0.1);
}

.comment-form {
    display: flex;
    gap: var(--space-3);
    align-items: flex-start;
}

.comment-input {
    flex: 1;
    padding: var(--space-3) var(--space-4);
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-full);
    color: var(--white);
    font-size: 14px;
    resize: none;
    min-height: 44px;
    max-height: 100px;
}

.comment-input:focus {
    outline: none;
    border-color: var(--primary);
}

.comment-submit {
    background: var(--primary);
    color: white;
    border: none;
    border-radius: var(--radius-full);
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition);
    flex-shrink: 0;
}

.comment-submit:hover {
    background: var(--primary-light);
    transform: scale(1.05);
}

/* ===== PHOTO VIEWER MODAL ===== */
.photo-viewer-modal .modal-content {
    max-width: 90vw;
    max-height: 90vh;
    padding: var(--space-4);
    background: rgba(0, 0, 0, 0.8);
}

.photo-viewer-container {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
}

.photo-viewer-img {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
}

.photo-viewer-img img {
    max-width: 100%;
    max-height: 70vh;
    object-fit: contain;
    border-radius: var(--radius-lg);
}

.photo-viewer-info {
    padding: var(--space-4);
    background: rgba(0, 0, 0, 0.5);
    border-radius: var(--radius-lg);
    margin-top: var(--space-4);
}

.photo-viewer-actions {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: var(--space-3);
}

.photo-viewer-navigation {
    display: flex;
    gap: var(--space-3);
}

/* ===== SHARE MODAL ===== */
.share-modal-options {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-4);
    margin: var(--space-5) 0;
}

.share-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-4);
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition);
    border: 2px solid transparent;
}

.share-option:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
}

.share-option i {
    font-size: 32px;
    margin-bottom: var(--space-2);
}

.share-to-chat-list {
    max-height: 300px;
    overflow-y: auto;
    margin: var(--space-4) 0;
}

.share-to-chat-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3);
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    margin-bottom: var(--space-2);
    cursor: pointer;
    transition: all var(--transition);
}

.share-to-chat-item:hover {
    background: var(--bg-tertiary);
}

/* ===== ANIMATIONS ===== */
@keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}

@keyframes modalAppear {
    from {
        opacity: 0;
        transform: scale(0.8) translateY(20px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

@keyframes messageAppear {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes commentAppear {
    from {
        opacity: 0;
        transform: translateY(5px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes slideIn {
    from {
        transform: translateX(100px);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes slideInFromRight {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

/* ===== SWITCH ===== */
.switch {
    position: relative;
    display: inline-block;
    width: 52px;
    height: 26px;
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--gray-700);
    transition: .4s;
    border-radius: 34px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked + .slider {
    background-color: var(--primary);
}

input:checked + .slider:before {
    transform: translateX(26px);
}

/* ===== NOTIFICATION BADGE ===== */
.notification-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background: var(--accent-red);
    color: white;
    font-size: 10px;
    min-width: 16px;
    height: 16px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 4px;
}

/* ===== CAMERA MODAL ===== */
.camera-container {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
}

.camera-preview {
    flex: 1;
    position: relative;
    background: black;
}

.camera-video {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.camera-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(transparent, rgba(0, 0, 0, 0.3));
}

.camera-controls {
    padding: var(--space-5);
    background: var(--bg-primary);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.camera-btn {
    width: 72px;
    height: 72px;
    border-radius: 50%;
    background: white;
    border: 4px solid rgba(255, 255, 255, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition);
    min-height: 72px;
    min-width: 72px;
}

.camera-btn:hover {
    transform: scale(1.05);
    border-color: rgba(255, 255, 255, 0.5);
}

/* ===== CHECK-IN FLOW MODALS ===== */
.privacy-choice-modal {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2000;
    backdrop-filter: blur(10px);
}

.privacy-options {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
}

.privacy-option {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    padding: var(--space-5);
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    border: 2px solid transparent;
    cursor: pointer;
    transition: all var(--transition);
}

.privacy-option:hover {
    border-color: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
}

.privacy-option.public:hover {
    border-color: var(--primary);
}

.privacy-option.private:hover {
    border-color: var(--gray-500);
}

.privacy-icon {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.privacy-option.public .privacy-icon {
    background: rgba(139, 92, 246, 0.2);
    color: var(--primary);
}

.privacy-option.private .privacy-icon {
    background: rgba(100, 116, 139, 0.2);
    color: var(--gray-400);
}

.privacy-info {
    flex: 1;
}

.privacy-badge {
    opacity: 0;
    color: var(--primary);
    transition: opacity var(--transition);
}

.privacy-option:hover .privacy-badge {
    opacity: 1;
}

.qr-scan-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 2;
    pointer-events: none;
}

.qr-frame {
    width: 200px;
    height: 200px;
    border: 2px solid var(--primary);
    border-radius: var(--radius);
    position: relative;
}

.qr-frame::before,
.qr-frame::after {
    content: '';
    position: absolute;
    width: 30px;
    height: 30px;
    border: 3px solid var(--primary);
}

.qr-frame::before {
    top: -3px;
    left: -3px;
    border-right: none;
    border-bottom: none;
}

.qr-frame::after {
    bottom: -3px;
    right: -3px;
    border-left: none;
    border-top: none;
}

.qr-instruction {
    margin-top: var(--space-5);
    color: var(--white);
    font-weight: 500;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}

/* ===== NOTIFICATION STYLES ===== */
.notification {
    position: fixed;
    top: 80px;
    right: var(--space-5);
    background: var(--bg-card);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    display: flex;
    align-items: center;
    gap: var(--space-3);
    z-index: 9999;
    max-width: 300px;
    box-shadow: var(--shadow-lg);
    animation: slideInFromRight 0.3s ease;
    transition: opacity 0.3s ease;
}

.notification i {
    font-size: 20px;
}

.notification-success i {
    color: var(--accent-green);
}

.notification-error i {
    color: var(--accent-red);
}

.notification-warning i {
    color: var(--accent-yellow);
}

.notification-info i {
    color: var(--accent-blue);
}

/* ===== AUTH STYLES ===== */
.auth-container {
    max-width: 400px;
    margin: 0 auto;
}

.auth-tabs {
    display: flex;
    background: var(--bg-tertiary);
    border-radius: var(--radius);
    padding: var(--space-1);
    margin-bottom: var(--space-5);
}

.auth-tab {
    flex: 1;
    padding: var(--space-3);
    text-align: center;
    background: none;
    border: none;
    color: var(--gray-400);
    font-weight: 600;
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    min-height: 44px;
}

.auth-tab.active {
    background: var(--primary);
    color: var(--white);
}

/* ===== RESPONSIVE ENHANCEMENTS ===== */
@media (max-width: 480px) {
    h1 {
        font-size: 2rem;
    }
    
    h2 {
        font-size: 1.5rem;
    }
    
    .hero h1 {
        font-size: 2.5rem;
    }
    
    .content {
        padding: calc(var(--header-height) + var(--space-4)) var(--space-4) var(--space-4);
    }
    
    .navbar {
        padding: 0 var(--space-4);
    }
    
    .quick-actions {
        grid-template-columns: repeat(2, 1fr); /* 2 columns on mobile */
    }
    
    .action-card {
        min-height: 120px;
        padding: var(--space-5) var(--space-3);
    }
    
    .action-card h4 {
        font-size: 14px;
    }
    
    .action-card p {
        font-size: 12px;
    }
    
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .features-grid {
        grid-template-columns: 1fr;
    }
    
    .notifications-dropdown {
        width: calc(100% - var(--space-6));
        right: var(--space-3);
    }
    
    .event-details-header {
        height: 200px;
    }
    
    .photo-dump-grid {
        grid-template-columns: 1fr;
    }
    
    .action-button {
        width: 70px;
        height: 70px;
        font-size: 20px;
        min-height: 70px;
        min-width: 70px;
    }
    
    .action-button.rewind,
    .action-button.refresh {
        width: 60px;
        height: 60px;
        font-size: 18px;
        min-height: 60px;
        min-width: 60px;
    }
    
    .modal-content {
        width: 95%;
        max-height: 85vh;
        padding: var(--space-5) var(--space-4);
        border-radius: var(--radius-xl);
    }
    
    .map-handle {
        top: 8px;
    }
    
    .map-handle-bar {
        width: 36px;
    }
    
    .map-popup-content {
        min-width: 200px;
        max-width: 90vw;
    }
    
    .popup-actions {
        flex-direction: column;
    }
    
    .popup-actions .btn {
        width: 100%;
    }
    
    .search-container {
        flex-direction: column;
    }
    
    .search-button {
        width: 100%;
        margin-left: 0;
        margin-top: var(--space-3);
    }
}

@media (max-width: 375px) {
    .quick-actions {
        grid-template-columns: 1fr; /* Stack on very small phones */
    }
    
    .action-card {
        min-height: 100px;
        padding: var(--space-4);
    }
    
    .action-card i {
        font-size: 28px;
    }
    
    .photo-dump-grid {
        grid-template-columns: 1fr;
    }
}

@supports (padding: max(0px)) {
    .bottom-nav {
        padding-bottom: max(var(--safe-area-inset-bottom), 20px);
    }
}

/* Map popup */
.mapboxgl-popup {
    max-width: 200px;
}

.mapboxgl-popup-content {
    background: var(--bg-card);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    color: var(--white);
    max-width: 300px;
}

.mapboxgl-popup-content h3 {
    color: var(--white);
    margin-bottom: var(--space-2);
    font-size: 16px;
}

.mapboxgl-popup-content p {
    color: var(--gray-400);
    margin-bottom: var(--space-1);
    font-size: 14px;
}

.mapboxgl-popup-content button {
    background: var(--primary);
    color: white;
    border: none;
    padding: var(--space-2) var(--space-4);
    border-radius: var(--radius);
    cursor: pointer;
    margin-top: var(--space-2);
    width: 100%;
    font-weight: 600;
    min-height: 36px;
}

.mapboxgl-popup-close-button {
    color: var(--white);
    font-size: 16px;
    padding: var(--space-1) var(--space-2);
    min-height: 44px;
    min-width: 44px;
}

/* Map geofence circle */
.geofence-circle {
    stroke: var(--primary);
    stroke-width: 2;
    stroke-dasharray: 5, 5;
    fill: rgba(139, 92, 246, 0.1);
    animation: pulseCircle 2s infinite;
}

@keyframes pulseCircle {
    0%, 100% {
        stroke-width: 2;
        stroke-opacity: 0.8;
    }
    50% {
        stroke-width: 3;
        stroke-opacity: 0.5;
    }
}

/* ===== ATTENDEE LIST ===== */
.attendee-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
}

.attendee-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3);
    background: var(--bg-tertiary);
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition);
}

.attendee-item:hover {
    background: var(--bg-card);
    transform: translateX(4px);
}

.attendee-avatar {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-full);
    background-size: cover;
    background-position: center;
}

/* ===== EVENT BADGE ===== */
.event-badge {
    background: var(--bg-tertiary);
    padding: var(--space-2) var(--space-4);
    border-radius: var(--radius-full);
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    font-size: 14px;
}

/* ===== PRICING CARD ===== */
.pricing-card {
    background: var(--bg-card);
    border-radius: var(--radius-xl);
    padding: var(--space-5);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all var(--transition);
}

.pricing-card.featured {
    border: 2px solid var(--primary);
    transform: scale(1.02);
    box-shadow: var(--shadow-glow);
}

/* ===== FILTER SECTION ===== */
.filter-section {
    margin-bottom: var(--space-5);
}

.filter-section h4 {
    margin-bottom: var(--space-3);
}

.range-value {
    display: flex;
    justify-content: space-between;
    margin-bottom: var(--space-2);
    font-size: 14px;
    color: var(--gray-300);
}

.range-slider {
    width: 100%;
    height: 6px;
    border-radius: 3px;
    background: var(--bg-tertiary);
    outline: none;
    -webkit-appearance: none;
}

.range-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    border: 3px solid var(--white);
    box-shadow: var(--shadow);
}

.range-slider::-moz-range-thumb {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    border: 3px solid var(--white);
    box-shadow: var(--shadow);
}

/* ===== CURRENCY OPTIONS ===== */
.currency-option {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-4);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    cursor: pointer;
    transition: background var(--transition);
    min-height: 44px;
}

.currency-option:hover {
    background: rgba(255, 255, 255, 0.05);
}

.currency-option.selected {
    background: rgba(139, 92, 246, 0.1);
}

.currency-info {
    display: flex;
    align-items: center;
    gap: var(--space-3);
}

.currency-symbol {
    font-size: 24px;
    font-weight: bold;
}

.currency-name {
    display: block;
    font-weight: 500;
}

.currency-code {
    display: block;
    font-size: 12px;
    color: var(--gray-400);
}

/* ===== QUANTITY SELECTOR ===== */
.quantity-selector {
    display: flex;
    align-items: center;
    gap: var(--space-3);
}

.quantity-btn {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-full);
    background: var(--bg-tertiary);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: var(--white);
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 40px;
    min-width: 40px;
}

.quantity-btn:hover {
    background: rgba(255, 255, 255, 0.1);
}

/* ===== TOTAL PRICE ===== */
.total-price {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--space-4);
    background: var(--bg-card);
    border-radius: var(--radius-lg);
    font-size: 18px;
    font-weight: bold;
}

/* ===== STATUS BADGES ===== */
.status-badge {
    padding: var(--space-1) var(--space-3);
    border-radius: var(--radius-full);
    font-size: 12px;
    font-weight: 600;
}

.status-badge.active {
    background: var(--accent-green);
    color: white;
}

.status-badge.used {
    background: var(--gray-600);
    color: white;
}

.status-badge.cancelled {
    background: var(--accent-red);
    color: white;
}

/* ===== PROFILE PHOTO UPLOAD ===== */
.profile-photo-upload {
    text-align: center;
    margin-bottom: var(--space-5);
    position: relative;
    display: inline-block;
    margin-left: auto;
    margin-right: auto;
}

.upload-button {
    position: absolute;
    bottom: 0;
    right: 0;
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition);
    min-height: 36px;
    min-width: 36px;
}

.upload-button:hover {
    background: var(--primary-light);
    transform: scale(1.1);
}

/* ===== LOADING STATES ===== */
.loading {
    opacity: 0.6;
    pointer-events: none;
}

.loading-spinner {
    width: 40px;
    height: 40px;
    border: 3px solid rgba(255, 255, 255, 0.1);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* ===== EMPTY STATES ===== */
.empty-state {
    text-align: center;
    padding: var(--space-8) var(--space-5);
}

.empty-state i {
    font-size: 64px;
    color: var(--gray-600);
    margin-bottom: var(--space-4);
}

.empty-state h3 {
    margin-bottom: var(--space-2);
}

.empty-state p {
    color: var(--gray-400);
    margin-bottom: var(--space-6);
}

/* ===== CUSTOM SCROLLBAR ===== */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: var(--primary);
    border-radius: 4px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--primary-light);
}

.scrollable-content:hover::-webkit-scrollbar-thumb {
    opacity: 1;
}

/* Hide scrollbar by default, show on hover */
* {
    scrollbar-width: thin;
    scrollbar-color: transparent transparent;
}

*:hover {
    scrollbar-color: var(--primary) transparent;
}

/* ===== SNAP POINTS INDICATOR ===== */
.snap-points {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 6px;
    z-index: 25;
    pointer-events: none;
}

.snap-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    transition: all var(--transition);
}

.snap-dot.active {
    background: var(--primary);
    transform: scale(1.2);
}

/* Accessibility improvements */
button:focus,
input:focus,
select:focus,
textarea:focus {
    outline: 2px solid var(--primary);
    outline-offset: 2px;
}

/* Ensure all interactive elements have proper touch targets */
button,
.btn,
.nav-item,
.action-card,
.bookmark-btn,
.filter-pill,
.clear-search,
.quantity-btn,
.download-photo-btn,
.camera-btn,
.privacy-option,
.currency-option,
.settings-option,
.notification-item,
.match-item,
.attendee-item,
.comment-action,
.chat-send-btn,
.comment-submit {
    min-height: 44px;
    min-width: 44px;
}
    </style>
</head>
<body>
    <div class="app" id="app">
        <!-- Navigation will be injected here -->
        <div class="content" id="content">
            <!-- Content will be dynamically loaded here -->
        </div>
        
        <!-- Bottom Navigation will be injected here -->
        <div id="bottomNav"></div>
    </div>
    <!-- Share Event Modal -->
<div class="share-modal" id="shareModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Share Event</h3>
            <button class="modal-close" onclick="closeModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="share-modal-options">
            <div class="share-option" onclick="shareToPlatform('whatsapp')">
                <i class="fab fa-whatsapp" style="color: #25D366;"></i>
                <span>WhatsApp</span>
            </div>
            <div class="share-option" onclick="shareToPlatform('instagram')">
                <i class="fab fa-instagram" style="color: #E4405F;"></i>
                <span>Instagram</span>
            </div>
            <div class="share-option" onclick="shareToPlatform('twitter')">
                <i class="fab fa-twitter" style="color: #1DA1F2;"></i>
                <span>Twitter</span>
            </div>
            <div class="share-option" onclick="shareToPlatform('facebook')">
                <i class="fab fa-facebook" style="color: #1877F2;"></i>
                <span>Facebook</span>
            </div>
            <div class="share-option" onclick="copyEventLink()">
                <i class="fas fa-link"></i>
                <span>Copy Link</span>
            </div>
            <div class="share-option" onclick="shareToConnections()">
                <i class="fas fa-user-friends"></i>
                <span>Connections</span>
            </div>
        </div>
        
        <div class="mt-6">
            <h4 class="mb-3">Share with Specific Connections</h4>
            <div class="share-to-chat-list" id="shareToChatList">
                <!-- Connections will be loaded here -->
            </div>
        </div>
    </div>
</div>

<!-- Photo Viewer Modal -->
<div class="photo-viewer-modal" id="photoViewerModal">
    <div class="modal-content">
        <div class="photo-viewer-container">
            <div class="photo-viewer-img" id="photoViewerImage">
                <!-- Photo will be loaded here -->
            </div>
            <div class="photo-viewer-info">
                <div class="flex justify-between items-center">
                    <div>
                        <h4 id="photoViewerTitle">Community Photo</h4>
                        <p class="text-gray-400 text-sm" id="photoViewerInfo"></p>
                    </div>
                    <button class="btn btn-outline btn-small" onclick="downloadCurrentPhoto()">
                        <i class="fas fa-download"></i> Download
                    </button>
                </div>
            </div>
            <div class="photo-viewer-actions">
                <button class="btn btn-outline" onclick="prevPhoto()">
                    <i class="fas fa-chevron-left"></i> Previous
                </button>
                <button class="btn btn-outline" onclick="closeModal()">
                    <i class="fas fa-times"></i> Close
                </button>
                <button class="btn btn-outline" onclick="nextPhoto()">
                    Next <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Comment Modal -->
<div class="comment-modal" id="commentModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Comments</h3>
            <button class="modal-close" onclick="closeModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="comments-list" id="modalCommentsList">
            <!-- Comments will be loaded here -->
        </div>
        <form class="comment-form" onsubmit="addModalComment(event)">
            <textarea class="comment-input" id="modalCommentInput" placeholder="Add a comment..." rows="1"></textarea>
            <button type="submit" class="comment-submit">
                <i class="fas fa-paper-plane"></i>
            </button>
        </form>
    </div>
</div>
    

    <!-- Script -->

<script>
// ===== CONFIGURATION =====
const MAPBOX_TOKEN = 'pk.eyJ1IjoianVzYSIsImEiOiJjbWpjanh5amEwbDEwM2dzOXVhbjZ5dzcwIn0.stWdbPHCrf9sKrRJRmShlg';
const NAMIBIA_COORDINATES = {
    windhoek: { lat: -22.5609, lng: 17.0658 },
    swakopmund: { lat: -22.6833, lng: 14.5333 },
    walvisBay: { lat: -22.9575, lng: 14.5053 },
    rundu: { lat: -17.9204, lng: 19.7492 },
    katimaMulilo: { lat: -17.5036, lng: 24.2756 }
};

// ===== ENHANCED MOCK DATA =====
const MOCK_PROFILES = [
    {
        id: 1,
        name: 'Nadia',
        age: 24,
        bio: 'Event Photographer & Dancer. Love capturing moments and moving to the beat.',
        interests: ['Photography', 'Dance', 'Art', 'Music'],
        eventId: 1,
        location: 'Main Stage',
        online: true,
        verified: true,
        cardColor: 'var(--card-purple)',
        livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23C4B5FD"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">N</text></svg>',
        distance: '15m away',
        gender: 'female',
        isPublic: true,
        tempProfile: true
    },
    {
        id: 2,
        name: 'David',
        age: 28,
        bio: 'Tech Entrepreneur at Windhoek Startup Hub. Love connecting innovators.',
        interests: ['Technology', 'Startups', 'Networking', 'Coffee'],
        eventId: 1,
        location: 'VIP Lounge',
        online: true,
        verified: true,
        cardColor: 'var(--card-blue)',
        livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23BAE6FD"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">D</text></svg>',
        distance: '25m away',
        gender: 'male',
        isPublic: true,
        tempProfile: true
    },
    {
        id: 3,
        name: 'Sarah',
        age: 26,
        bio: 'Environmental Activist & Yoga Instructor. Passionate about sustainability.',
        interests: ['Yoga', 'Environment', 'Wellness', 'Travel'],
        eventId: 2,
        location: 'Garden Area',
        online: false,
        verified: true,
        cardColor: 'var(--card-green)',
        livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23BBF7D0"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">S</text></svg>',
        distance: '50m away',
        gender: 'female',
        isPublic: true,
        tempProfile: true
    },
    {
        id: 4,
        name: 'Michael',
        age: 32,
        bio: 'Chef & Food Blogger. Exploring Namibian cuisine fusion.',
        interests: ['Food', 'Cooking', 'Travel', 'Photography'],
        eventId: 1,
        location: 'Food Court',
        online: true,
        verified: false,
        cardColor: 'var(--card-orange)',
        livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23FECACA"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">M</text></svg>',
        distance: '30m away',
        gender: 'male',
        isPublic: true,
        tempProfile: true
    },
    {
        id: 5,
        name: 'Lisa',
        age: 23,
        bio: 'Music Producer & DJ. Mixing traditional Namibian sounds with electronic.',
        interests: ['Music', 'DJ', 'Production', 'Festivals'],
        eventId: 3,
        location: 'DJ Booth',
        online: true,
        verified: true,
        cardColor: 'var(--card-pink)',
        livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23FFC0D9"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">L</text></svg>',
        distance: '45m away',
        gender: 'female',
        isPublic: true,
        tempProfile: true
    }
];

const MOCK_EVENTS = [
    {
        id: 1,
        name: 'Windhoek Tech Summit 2024',
        location: 'Windhoek Country Club Resort',
        address: '123 Luxury Street, Windhoek, Namibia',
        date: 'Tonight',
        time: '6:00 PM - 11:00 PM',
        attendees: 156,
        maxAttendees: 200,
        description: 'The premier tech networking event in Namibia. Connect with tech entrepreneurs, developers, and investors from across the country.',
        category: 'Tech Networking',
        coverImage: 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=600&h=300&fit=crop',
        qrCode: 'AMPS_TECH_2024_001',
        radius: 100,
        organizerId: 1,
        coordinates: { lat: -22.5609, lng: 17.0658 },
        price: 150.00,
        currency: 'NAD',
        ageRange: '18-45',
        genderPreference: 'Everyone',
        tags: ['Tech', 'Networking', 'Startups', 'AI', 'Innovation'],
        bookmarked: true,
        rsvp: 'going',
        geoFencing: true,
        customTheme: '#8B5CF6',
        isFeatured: true,
        geofenceRadius: 100,
        communityPhotos: [
            'https://images.unsplash.com/photo-1511795409834-ef04bbd61622?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1501281668745-f6f2610e4e18?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1511578314322-379afb476865?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1492684223066-e9e2c03b6e70?w=400&h=400&fit=crop'
        ],
        comments: [
            {
                id: 1,
                userId: 2,
                userName: 'David',
                userAvatar: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23BAE6FD"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">D</text></svg>',
                text: 'Excited for this! Who\'s attending the AI panel?',
                timestamp: '2 hours ago',
                likes: 5
            },
            {
                id: 2,
                userId: 4,
                userName: 'Michael',
                userAvatar: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23FECACA"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">M</text></svg>',
                text: 'Will there be food trucks?',
                timestamp: '1 hour ago',
                likes: 2
            }
        ]
    },
    {
        id: 2,
        name: 'Namibian Art & Culture Festival',
        location: 'National Theatre of Namibia',
        address: 'Robert Mugabe Ave, Windhoek, Namibia',
        date: 'Tomorrow',
        time: '5:00 PM - 10:00 PM',
        attendees: 89,
        maxAttendees: 150,
        description: 'Celebrate Namibian heritage through art exhibitions, traditional dance, and cultural performances.',
        category: 'Art & Culture',
        coverImage: 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=600&h=300&fit=crop',
        qrCode: 'AMPS_ART_2024_002',
        radius: 80,
        organizerId: 2,
        coordinates: { lat: -22.5690, lng: 17.0836 },
        price: 80.00,
        currency: 'NAD',
        ageRange: '16+',
        genderPreference: 'Everyone',
        tags: ['Art', 'Culture', 'Heritage', 'Traditional', 'Exhibition'],
        bookmarked: true,
        rsvp: 'maybe',
        geoFencing: true,
        customTheme: '#EC4899',
        isFeatured: true,
        geofenceRadius: 80,
        communityPhotos: [
            'https://images.unsplash.com/photo-1492684223066-e9e2c03b6e70?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1511578314322-379afb476865?w=400&h=400&fit=crop'
        ],
        comments: []
    },
    {
        id: 3,
        name: 'Swakopmund Music Festival',
        location: 'Swakopmund Beach',
        address: 'Beach Road, Swakopmund, Namibia',
        date: 'Friday',
        time: '4:00 PM - 2:00 AM',
        attendees: 345,
        maxAttendees: 500,
        description: 'Beachside music festival featuring local and international artists. Three stages of non-stop music.',
        category: 'Music Festival',
        coverImage: 'https://images.unsplash.com/photo-1511379938547-c1f69419868d?w=600&h=300&fit=crop',
        qrCode: 'AMPS_MUSIC_2024_003',
        radius: 200,
        organizerId: 3,
        coordinates: { lat: -22.6833, lng: 14.5333 },
        price: 250.00,
        currency: 'NAD',
        ageRange: '18+',
        genderPreference: 'Everyone',
        tags: ['Music', 'Festival', 'Beach', 'DJ', 'Live'],
        bookmarked: false,
        rsvp: 'none',
        geoFencing: true,
        customTheme: '#3B82F6',
        isFeatured: false,
        geofenceRadius: 150,
        communityPhotos: [
            'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=400&h=400&fit=crop',
            'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?w=400&h=400&fit=crop'
        ],
        comments: []
    }
];

const CURRENCIES = [
    { code: 'NAD', symbol: 'N$', name: 'Namibian Dollar', conversionRate: 1 },
    { code: 'USD', symbol: '$', name: 'US Dollar', conversionRate: 0.055 },
    { code: 'EUR', symbol: '', name: 'Euro', conversionRate: 0.051 },
    { code: 'GBP', symbol: '', name: 'British Pound', conversionRate: 0.044 },
    { code: 'ZAR', symbol: 'R', name: 'South African Rand', conversionRate: 1 }
];

// ===== APP STATE =====
let state = {
    currentUser: null,
    currentPage: 'landing',
    currentEvent: null,
    currentMatch: null,
    swipeCount: 0,
    dailyLikes: 10,
    isPro: false,
    isMax: false,
    matches: [],
    events: MOCK_EVENTS,
    attendees: MOCK_PROFILES,
    cameraStream: null,
    facingMode: 'user',
    history: ['landing'],
    currentProfileIndex: 0,
    swipeHistory: [],
    lastMatch: null,
    chatMessages: {},
    userProfile: {
        name: 'Demo User',
        email: 'demo@amps.com',
        age: 28,
        occupation: 'Software Engineer',
        company: 'Tech Corp Namibia',
        bio: 'Passionate about technology and building meaningful connections at events in Namibia.',
        interests: ['Technology', 'Music', 'Travel', 'Fitness', 'Photography'],
        profilePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%238B5CF6"/><text x="100" y="120" font-size="24" text-anchor="middle" fill="white">U</text></svg>',
        phone: '+264 81 123 4567',
        location: 'Windhoek, Namibia',
        gender: 'male',
        visibility: 'public',
        bookmarkedEvents: [1, 2],
        privacySettings: {
            profileVisibility: 'public',
            showOnlineStatus: true,
            allowMessages: 'everyone',
            shareLocation: 'never'
        },
        notificationSettings: {
            newMatches: true,
            messages: true,
            eventReminders: true,
            announcements: true
        },
        accountSettings: {
            emailNotifications: true,
            pushNotifications: true,
            darkMode: true,
            language: 'English'
        }
    },
    superLikes: 1,
    rewindCount: 3,
    filters: {
        distance: 50,
        ageRange: { min: 18, max: 35 },
        gender: 'all',
        interests: [],
        verifiedOnly: false,
        searchQuery: ''
    },
    tickets: [],
    currency: 'NAD',
    notifications: [],
    map: null,
    mapDrawerOpen: false,
    mapDrawerPosition: 0,
    isDraggingMap: false,
    previousPage: null,
    eventSearchQuery: '',
    searchTimer: null,
    checkInFlow: {
        active: false,
        step: null,
        eventId: null,
        privacyChoice: null,
        livePhoto: null
    },
    mapMarkers: [],
    activeFilters: [],
    currentLocation: { lat: -22.5609, lng: 17.0658 }, // Default to Windhoek
    geofenceCircle: null,
    searchSuggestions: [],
    eventWizardData: {
        step: 1,
        data: {
            name: '',
            description: '',
            category: '',
            location: '',
            address: '',
            date: '',
            time: '',
            capacity: 100,
            ticketType: 'free',
            price: 0,
            availableTickets: 100,
            themeColor: '#8B5CF6',
            geofenceRadius: 100,
            coordinates: null,
            tags: []
        }
    },
    organizerEvents: [],
    chatActive: false,
    activeChatId: null,
    sharedEvents: {},
    swipeProfiles: [...MOCK_PROFILES]
};

// ===== INITIALIZATION =====
function init() {
    console.log('Initializing Amps App...');
    loadState();
    restorePageState();
    renderPage();
    updateNavigation();
    
    // Initialize demo organizer events if user is pro/max
    if (state.isPro || state.isMax) {
        state.organizerEvents = state.events.filter(e => e.organizerId === (state.currentUser?.id || 1));
    }
    
    // Initialize demo tickets
    if (!state.tickets.length) {
        state.tickets = [
            {
                id: 1,
                eventId: 1,
                eventName: 'Windhoek Tech Summit 2024',
                purchaseDate: new Date().toISOString(),
                price: 150.00,
                currency: 'NAD',
                qrCode: 'AMPS_TECH_2024_001_DEMO',
                status: 'active',
                type: 'General Admission',
                orderId: 'ORD-001',
                showQr: false
            },
            {
                id: 2,
                eventId: 2,
                eventName: 'Namibian Art & Culture Festival',
                purchaseDate: new Date(Date.now() - 86400000).toISOString(),
                price: 80.00,
                currency: 'NAD',
                qrCode: 'AMPS_ART_2024_002_DEMO',
                status: 'active',
                type: 'Standard Entry',
                orderId: 'ORD-002',
                showQr: false
            }
        ];
    }
    
    // Initialize chat messages if empty
    if (Object.keys(state.chatMessages).length === 0) {
        state.chatMessages = {
            'demo_user_2': [
                {
                    id: 1,
                    sender: 'received',
                    text: 'Hey! Loved your profile. Are you enjoying the event?',
                    time: '7:45 PM',
                    read: true
                },
                {
                    id: 2,
                    sender: 'user',
                    text: 'Yes, it\'s amazing! The speakers are incredible.',
                    time: '7:46 PM',
                    read: true
                },
                {
                    id: 3,
                    sender: 'received',
                    text: 'We should meet up at the networking session!',
                    time: '7:47 PM',
                    read: true
                }
            ]
        };
    }
    
    // Initialize matches if empty
    if (state.matches.length === 0) {
        state.matches = [
            {
                id: 1,
                userId: 'demo_user',
                matchId: 2,
                timestamp: new Date().toISOString(),
                eventId: 1,
                lastMessage: 'Hey! How\'s the event?',
                lastMessageTime: '2:15 PM',
                unread: true,
                unreadCount: 1
            },
            {
                id: 2,
                userId: 'demo_user',
                matchId: 5,
                timestamp: new Date(Date.now() - 86400000).toISOString(),
                eventId: 1,
                lastMessage: 'Great meeting you!',
                lastMessageTime: 'Yesterday',
                unread: false,
                unreadCount: 0
            }
        ];
    }
    
    // Show welcome notification
    if (!state.currentUser) {
        showNotification('Welcome to Amps! Connect at Namibian events.', 'info');
    }
    
    console.log('App initialized successfully');
}

function loadState() {
    try {
        const savedState = localStorage.getItem('amps_state');
        if (savedState) {
            const parsed = JSON.parse(savedState);
            state = { ...state, ...parsed };
            console.log('State loaded from localStorage');
        }
    } catch (error) {
        console.error('Error loading state:', error);
    }
}

function saveState() {
    try {
        localStorage.setItem('amps_state', JSON.stringify(state));
        console.log('State saved to localStorage');
    } catch (error) {
        console.error('Error saving state:', error);
    }
}

function restorePageState() {
    try {
        const savedPage = localStorage.getItem('amps_current_page');
        if (savedPage && savedPage !== 'landing') {
            state.currentPage = savedPage;
            state.history = [savedPage];
        }
    } catch (error) {
        console.error('Error restoring page state:', error);
    }
}

function savePageState() {
    try {
        localStorage.setItem('amps_current_page', state.currentPage);
    } catch (error) {
        console.error('Error saving page state:', error);
    }
}

// ===== ENHANCED ROUTER =====
function navigateTo(page) {
    console.log(`Navigating to: ${page}`);
    state.previousPage = state.currentPage;
    state.history.push(state.currentPage);
    state.currentPage = page;
    savePageState();
    renderPage();
    updateNavigation();
    window.scrollTo(0, 0);
    saveState();
}

function goBack() {
    if (state.history.length > 1) {
        state.currentPage = state.history.pop();
        savePageState();
        renderPage();
        updateNavigation();
        window.scrollTo(0, 0);
    }
}

// ===== PAGE RENDERERS =====
function renderPage() {
    const content = document.getElementById('content');
    if (!content) {
        console.error('Content container not found');
        return;
    }
    
    content.innerHTML = '';
    
    switch(state.currentPage) {
        case 'landing':
            renderLandingPage(content);
            break;
        case 'auth':
            renderAuthPage(content);
            break;
        case 'home':
            renderHomePage(content);
            break;
        case 'events':
            renderEventsPage(content);
            break;
        case 'connect':
            renderConnectPage(content);
            break;
        case 'matches':
            renderMatchesPage(content);
            break;
        case 'profile':
            renderProfilePage(content);
            break;
        case 'edit-profile':
            renderEditProfilePage(content);
            break;
        case 'privacy-settings':
            renderPrivacySettingsPage(content);
            break;
        case 'event-details':
            renderEventDetailsPage(content);
            break;
        case 'ticket-box':
            renderTicketBoxPage(content);
            break;
        case 'settings':
            renderSettingsPage(content);
            break;
        case 'event-management':
            renderEventManagementPage(content);
            break;
        case 'chat':
            renderChatPage(content);
            break;
        default:
            renderLandingPage(content);
    }
}

// ===== INDIVIDUAL PAGE RENDER FUNCTIONS =====

function renderLandingPage(container) {
    container.innerHTML = `
        <div class="hero">
            <h1>Amplify Your Connections at Live Events</h1>
            <p class="hero-subtitle">Connect with verified attendees in real-time. Scan event QR codes, swipe to match, and make meaningful connections.</p>
            
            <div class="cta-grid">
                <button class="btn btn-primary btn-large" onclick="navigateTo('auth')">
                    <i class="fas fa-user-plus"></i> Get Started Free
                </button>
                <button class="btn btn-demo btn-large" onclick="demoLogin()">
                    <i class="fas fa-play-circle"></i> Try Demo
                </button>
            </div>
        </div>
        
        <div class="features-grid">
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-qrcode"></i>
                </div>
                <h3>Event Check-in</h3>
                <p>Scan QR codes at events to see who's there</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-heart"></i>
                </div>
                <h3>Smart Matching</h3>
                <p>Swipe to connect with like-minded attendees</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-comments"></i>
                </div>
                <h3>Instant Chat</h3>
                <p>Chat with matches during the event</p>
            </div>
            
            <div class="feature">
                <div class="feature-icon">
                    <i class="fas fa-ticket-alt"></i>
                </div>
                <h3>Digital Tickets</h3>
                <p>Store and manage all your event tickets</p>
            </div>
        </div>
        
        <div class="card text-center mt-8">
            <h2 class="mb-4">Ready to Amplify Your Social Life?</h2>
            <p class="text-gray-400 mb-6">Join thousands of event-goers making real connections</p>
            <button class="btn btn-primary btn-large" onclick="navigateTo('auth')">
                <i class="fas fa-rocket"></i> Start Free Today
            </button>
        </div>
    `;
}

function renderAuthPage(container) {
    container.innerHTML = `
        <div class="auth-container">
            <h2 class="text-center mb-5">Welcome to Amps</h2>
            
            <div class="card">
                <div class="auth-tabs">
                    <button class="auth-tab active" id="loginTab" onclick="switchAuthTab('login')">Sign In</button>
                    <button class="auth-tab" id="signupTab" onclick="switchAuthTab('signup')">Sign Up</button>
                </div>
                
                <form id="authForm" onsubmit="handleAuth(event)">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="authEmail" placeholder="you@example.com" value="demo@amps.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="authPassword" placeholder="" value="password" required minlength="6">
                    </div>
                    
                    <div id="signupFields" class="hidden">
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="authName" placeholder="Alex Johnson" value="Demo User">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Age</label>
                            <input type="number" class="form-control" id="authAge" placeholder="24" min="18" max="100" value="28">
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-block mt-4" id="authSubmit">
                        <i class="fas fa-sign-in-alt"></i> Continue
                    </button>
                </form>
                
                <div class="text-center mt-4">
                    <button class="btn btn-demo btn-block" onclick="demoLogin()">
                        <i class="fas fa-play-circle"></i> Continue as Demo User
                    </button>
                </div>
                
                <div class="text-xs text-gray-400 text-center mt-4 p-3 bg-gray-900/50 rounded-lg">
                    Demo credentials pre-filled. Just click "Continue" or try the demo!
                </div>
            </div>
        </div>
    `;
}

function renderHomePage(container) {
    const eventsAttended = 12;
    const totalMatches = state.matches.length;
    const remainingSwipes = state.isPro || state.isMax ? '' : Math.max(0, state.dailyLikes - state.swipeCount);
    
    const featuredEvents = state.events.filter(e => e.isFeatured);
    const bookmarkedEvents = state.events.filter(e => state.userProfile.bookmarkedEvents?.includes(e.id));
    
    container.innerHTML = `
        <div class="profile-header">
            <div class="avatar ${state.isPro ? 'pro' : state.isMax ? 'pro-plus' : ''}" style="background-image: url('${state.userProfile.profilePhoto}');">
                ${state.isPro ? '<div class="pro-badge" style="position: absolute; bottom: -8px; right: -8px; font-size: 10px;"><i class="fas fa-crown"></i></div>' : ''}
                ${state.isMax ? '<div class="pro-plus-badge" style="position: absolute; bottom: -8px; right: -8px; font-size: 10px;"><i class="fas fa-star"></i></div>' : ''}
            </div>
            <h2>${state.userProfile.name}</h2>
            <p class="text-gradient">${state.userProfile.occupation}  ${state.userProfile.company}</p>
            ${state.isPro ? 
                '<div class="pro-badge mt-2"><i class="fas fa-crown"></i> PRO MEMBER</div>' : 
                state.isMax ?
                '<div class="pro-plus-badge mt-2"><i class="fas fa-star"></i> MAX MEMBER</div>' :
                '<div class="free-badge mt-2"><i class="fas fa-user"></i> FREE MEMBER</div>'
            }
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">${eventsAttended}</div>
                <div class="stat-label">Events</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${totalMatches}</div>
                <div class="stat-label">Matches</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${remainingSwipes}</div>
                <div class="stat-label">Likes Left</div>
            </div>
        </div>
        
        ${bookmarkedEvents.length > 0 ? `
            <div class="section-header">
                <h3>Bookmarked Events</h3>
                <button class="btn btn-outline btn-small" onclick="navigateTo('events')">
                    View All <i class="fas fa-arrow-right"></i>
                </button>
            </div>
            <div class="bookmarked-events">
                ${bookmarkedEvents.slice(0, 3).map(event => `
                    <div class="event-card-list mb-3" onclick="viewEventDetails(${event.id})">
                        <div class="event-card-image">
                            <img src="${event.coverImage}" alt="${event.name}">
                        </div>
                        <div class="event-card-content">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h4 class="mb-1">${event.name}</h4>
                                    <p class="text-gray-400 text-sm">
                                        <i class="fas fa-map-marker-alt"></i> ${event.location}
                                    </p>
                                </div>
                                <button class="bookmark-btn active" onclick="event.stopPropagation(); toggleBookmark(${event.id})">
                                    <i class="fas fa-bookmark"></i>
                                </button>
                            </div>
                            <div class="flex items-center gap-4 text-sm mt-2">
                                <span class="text-gradient">
                                    <i class="fas fa-users"></i> ${event.attendees}
                                </span>
                                <span class="text-gray-400">${event.date}</span>
                            </div>
                        </div>
                    </div>
                `).join('')}
            </div>
        ` : ''}
        
        ${featuredEvents.length > 0 ? `
            <div class="section-header ${bookmarkedEvents.length > 0 ? 'mt-6' : ''}">
                <h3>Featured Events</h3>
                <button class="btn btn-outline btn-small" onclick="navigateTo('events')">
                    View All <i class="fas fa-arrow-right"></i>
                </button>
            </div>
            <div class="featured-events">
                ${featuredEvents.map(event => `
                    <div class="event-card-featured" onclick="viewEventDetails(${event.id})">
                        <div class="event-card-image" style="background-image: url('${event.coverImage}');">
                            <button class="bookmark-btn ${event.bookmarked ? 'active' : ''}" onclick="event.stopPropagation(); toggleBookmark(${event.id})">
                                <i class="fas fa-bookmark"></i>
                            </button>
                            <div class="event-card-overlay">
                                <span class="live-badge"><i class="fas fa-bolt"></i> FEATURED</span>
                            </div>
                        </div>
                        <div class="event-card-content">
                            <h4 class="mb-2">${event.name}</h4>
                            <p class="text-gray-400 text-sm mb-2">
                                <i class="fas fa-map-marker-alt"></i> ${event.location}
                            </p>
                            <div class="flex items-center justify-between text-sm">
                                <span class="text-gradient">
                                    <i class="fas fa-users"></i> ${event.attendees}
                                </span>
                                <span class="text-gray-400">${event.date}</span>
                            </div>
                        </div>
                    </div>
                `).join('')}
            </div>
        ` : ''}
        
        <h3 class="mt-6 mb-4">Quick Actions</h3>
        <div class="quick-actions">
            <div class="action-card primary" onclick="startCheckInFlow()">
                <i class="fas fa-qrcode"></i>
                <h4>Check In</h4>
                <p class="text-gray-400">Scan event QR</p>
            </div>
            
            <div class="action-card blue" onclick="openMapFromHome()">
                <i class="fas fa-map"></i>
                <h4>View Map</h4>
                <p class="text-gray-400">Event locations</p>
            </div>
            
            <div class="action-card pink" onclick="showEventWizard()">
                <i class="fas fa-plus-circle"></i>
                <h4>Create Event</h4>
                <p class="text-gray-400">${state.isPro || state.isMax ? 'Set up new event' : 'Upgrade to create'}</p>
                ${!state.isPro && !state.isMax ? '<div class="pro-badge mt-2">PRO</div>' : ''}
            </div>
            
            <div class="action-card gold" onclick="navigateTo('ticket-box')">
                <i class="fas fa-ticket-alt"></i>
                <h4>Ticket Box</h4>
                <p class="text-gray-400">Manage tickets</p>
            </div>
        </div>
        
        ${state.isPro || state.isMax ? `
            <div class="card mt-6">
                <div class="flex justify-between items-center mb-4">
                    <h4>My Organized Events</h4>
                    <button class="btn btn-outline btn-small" onclick="navigateTo('event-management')">
                        Manage All
                    </button>
                </div>
                ${state.organizerEvents.length > 0 ? `
                    <div class="attendee-list">
                        ${state.organizerEvents.slice(0, 2).map(event => `
                            <div class="attendee-item" onclick="viewEventDetails(${event.id})">
                                <div class="attendee-avatar" style="background-image: url('${event.coverImage}');"></div>
                                <div class="attendee-info">
                                    <h4>${event.name}</h4>
                                    <p class="text-gray-400 text-sm">${event.attendees} attending</p>
                                </div>
                                <div class="live-badge">Live</div>
                            </div>
                        `).join('')}
                    </div>
                ` : `
                    <p class="text-gray-400 text-center py-4">No events created yet</p>
                `}
                <button class="btn btn-primary btn-block mt-4" onclick="showEventWizard()">
                    <i class="fas fa-plus"></i> Create New Event
                </button>
            </div>
        ` : ''}
        
        <div class="card mt-6">
            <h4 class="mb-4">Recent Matches</h4>
            ${state.matches.length > 0 ? `
                <div class="attendee-list">
                    ${state.matches.slice(0, 3).map(match => {
                        const profile = MOCK_PROFILES.find(p => p.id === match.matchId);
                        return `
                            <div class="attendee-item" onclick="openChat(${match.matchId})">
                                <div class="attendee-avatar" style="background-image: url('${profile?.livePhoto || ''}');"></div>
                                <div class="attendee-info">
                                    <h4>${profile?.name || 'Unknown'}</h4>
                                    <p class="text-gray-400 text-sm">${match.lastMessage || 'New match!'}</p>
                                </div>
                                ${match.unread ? '<span class="w-2 h-2 bg-primary rounded-full"></span>' : ''}
                            </div>
                        `;
                    }).join('')}
                </div>
                <button class="btn btn-outline btn-block mt-4" onclick="navigateTo('matches')">
                    View All Matches
                </button>
            ` : `
                <p class="text-gray-400 text-center py-4">No matches yet. Check into an event and start swiping!</p>
                <button class="btn btn-primary btn-block mt-2" onclick="navigateTo('events')">
                    <i class="fas fa-calendar"></i> Find Events
                </button>
            `}
        </div>
    `;
}

function renderTicketBoxPage(container) {
    const activeTickets = state.tickets.filter(t => t.status === 'active');
    const usedTickets = state.tickets.filter(t => t.status === 'used');
    const expiredTickets = state.tickets.filter(t => t.status === 'expired');
    
    container.innerHTML = `
        <div class="ticket-box-page">
            <h2 class="mb-5">Ticket Box</h2>
            
            <div class="ticket-tabs">
                <button class="ticket-tab active" onclick="switchTicketTab('active')">Active (${activeTickets.length})</button>
                <button class="ticket-tab" onclick="switchTicketTab('used')">Used (${usedTickets.length})</button>
                <button class="ticket-tab" onclick="switchTicketTab('expired')">Expired (${expiredTickets.length})</button>
            </div>
            
            <div class="tab-content">
                <div id="activeTicketsTab" class="tab-pane active">
                    ${activeTickets.length > 0 ? `
                        <div class="ticket-list">
                            ${activeTickets.map(ticket => {
                                const event = state.events.find(e => e.id === ticket.eventId);
                                return `
                                    <div class="ticket-card">
                                        <div class="ticket-header">
                                            <div class="ticket-event">
                                                <h4>${event?.name || ticket.eventName}</h4>
                                                <p class="text-gray-400 text-sm">Order: ${ticket.orderId}</p>
                                            </div>
                                            <div class="ticket-status active">Active</div>
                                        </div>
                                        
                                        <div class="ticket-details">
                                            <div class="ticket-detail">
                                                <i class="fas fa-calendar"></i>
                                                <span>${event?.date || 'Today'}</span>
                                            </div>
                                            <div class="ticket-detail">
                                                <i class="fas fa-clock"></i>
                                                <span>${event?.time || '6:00 PM'}</span>
                                            </div>
                                            <div class="ticket-detail">
                                                <i class="fas fa-map-marker-alt"></i>
                                                <span>${event?.location || 'Windhoek'}</span>
                                            </div>
                                            <div class="ticket-detail">
                                                <i class="fas fa-ticket-alt"></i>
                                                <span>${ticket.type}</span>
                                            </div>
                                        </div>
                                        
                                        ${ticket.showQr ? `
                                            <div class="ticket-qr-large mt-4">
                                                <span>${ticket.qrCode}</span>
                                            </div>
                                        ` : `
                                            <div class="ticket-qr" onclick="toggleTicketQR(${ticket.id})">
                                                <span>${ticket.qrCode.substring(0, 10)}...</span>
                                                <p class="text-xs text-gray-400 mt-1">Tap to show full QR</p>
                                            </div>
                                        `}
                                        
                                        <div class="ticket-actions">
                                            <button class="btn btn-outline flex-1" onclick="shareTicket(${ticket.id})">
                                                <i class="fas fa-share"></i> Share
                                            </button>
                                            <button class="btn btn-primary flex-1" onclick="toggleTicketQR(${ticket.id})">
                                                <i class="fas fa-qrcode"></i> ${ticket.showQr ? 'Hide' : 'Show'} QR
                                            </button>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    ` : `
                        <div class="empty-state">
                            <i class="fas fa-ticket-alt"></i>
                            <h3>No Active Tickets</h3>
                            <p>Purchase tickets for upcoming events</p>
                            <button class="btn btn-primary mt-4" onclick="navigateTo('events')">
                                <i class="fas fa-calendar"></i> Browse Events
                            </button>
                        </div>
                    `}
                </div>
                
                <div id="usedTicketsTab" class="tab-pane">
                    ${usedTickets.length > 0 ? `
                        <div class="ticket-list">
                            ${usedTickets.map(ticket => `
                                <div class="ticket-card">
                                    <div class="ticket-header">
                                        <div class="ticket-event">
                                            <h4>${ticket.eventName}</h4>
                                            <p class="text-gray-400 text-sm">Used on ${new Date(ticket.purchaseDate).toLocaleDateString()}</p>
                                        </div>
                                        <div class="ticket-status used">Used</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div class="empty-state">
                            <i class="fas fa-history"></i>
                            <h3>No Used Tickets</h3>
                            <p>Your used tickets will appear here</p>
                        </div>
                    `}
                </div>
                
                <div id="expiredTicketsTab" class="tab-pane">
                    ${expiredTickets.length > 0 ? `
                        <div class="ticket-list">
                            ${expiredTickets.map(ticket => `
                                <div class="ticket-card">
                                    <div class="ticket-header">
                                        <div class="ticket-event">
                                            <h4>${ticket.eventName}</h4>
                                            <p class="text-gray-400 text-sm">Expired</p>
                                        </div>
                                        <div class="ticket-status expired">Expired</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div class="empty-state">
                            <i class="fas fa-clock"></i>
                            <h3>No Expired Tickets</h3>
                            <p>Your expired tickets will appear here</p>
                        </div>
                    `}
                </div>
            </div>
            
            <div class="card mt-6">
                <h4 class="mb-4">Purchase Tickets</h4>
                <p class="text-gray-400 mb-4">Get tickets for upcoming events</p>
                <button class="btn btn-primary btn-block" onclick="navigateTo('events')">
                    <i class="fas fa-shopping-cart"></i> Browse Events to Purchase
                </button>
            </div>
        </div>
    `;
}

function renderSettingsPage(container) {
    container.innerHTML = `
        <div class="settings-page">
            <h2 class="mb-5">Settings</h2>
            
            <div class="settings-section">
                <h3>Account</h3>
                <div class="settings-option" onclick="navigateTo('edit-profile')">
                    <div class="settings-info">
                        <i class="fas fa-user"></i>
                        <span>Edit Profile</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
                
                <div class="settings-option" onclick="showChangeEmailModal()">
                    <div class="settings-info">
                        <i class="fas fa-envelope"></i>
                        <span>Change Email</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
                
                <div class="settings-option" onclick="showChangePasswordModal()">
                    <div class="settings-info">
                        <i class="fas fa-lock"></i>
                        <span>Change Password</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Privacy</h3>
                <div class="settings-option" onclick="navigateTo('privacy-settings')">
                    <div class="settings-info">
                        <i class="fas fa-shield-alt"></i>
                        <span>Privacy Settings</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
                
                <div class="settings-option" onclick="showBlockedUsers()">
                    <div class="settings-info">
                        <i class="fas fa-user-slash"></i>
                        <span>Blocked Users</span>
                    </div>
                    <span class="settings-value">0 users</span>
                </div>
                
                <div class="settings-option" onclick="setupEmergencyContact()">
                    <div class="settings-info">
                        <i class="fas fa-phone-alt"></i>
                        <span>Emergency Contact</span>
                    </div>
                    ${state.userProfile.emergencyContact ? '<span class="settings-value"> Set</span>' : '<i class="fas fa-chevron-right"></i>'}
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Preferences</h3>
                <div class="settings-option">
                    <div class="settings-info">
                        <i class="fas fa-palette"></i>
                        <span>Dark Mode</span>
                    </div>
                    <label class="switch">
                        <input type="checkbox" ${state.userProfile.accountSettings.darkMode ? 'checked' : ''} onchange="toggleDarkMode(this.checked)">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-option" onclick="showCurrencySelector()">
                    <div class="settings-info">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>Currency</span>
                    </div>
                    <span class="settings-value">${state.currency}</span>
                    <i class="fas fa-chevron-right"></i>
                </div>
                
                <div class="settings-option" onclick="showLanguageSelector()">
                    <div class="settings-info">
                        <i class="fas fa-language"></i>
                        <span>Language</span>
                    </div>
                    <span class="settings-value">${state.userProfile.accountSettings.language}</span>
                    <i class="fas fa-chevron-right"></i>
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Notifications</h3>
                <div class="settings-option">
                    <div class="settings-info">
                        <i class="fas fa-heart"></i>
                        <span>New Matches</span>
                    </div>
                    <label class="switch">
                        <input type="checkbox" ${state.userProfile.notificationSettings.newMatches ? 'checked' : ''} onchange="toggleNotificationSetting('newMatches', this.checked)">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-option">
                    <div class="settings-info">
                        <i class="fas fa-comment"></i>
                        <span>Messages</span>
                    </div>
                    <label class="switch">
                        <input type="checkbox" ${state.userProfile.notificationSettings.messages ? 'checked' : ''} onchange="toggleNotificationSetting('messages', this.checked)">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="settings-option">
                    <div class="settings-info">
                        <i class="fas fa-bell"></i>
                        <span>Event Reminders</span>
                    </div>
                    <label class="switch">
                        <input type="checkbox" ${state.userProfile.notificationSettings.eventReminders ? 'checked' : ''} onchange="toggleNotificationSetting('eventReminders', this.checked)">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="settings-section">
                <div class="settings-option" onclick="showAppInfo()">
                    <div class="settings-info">
                        <i class="fas fa-info-circle"></i>
                        <span>App Info</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
                
                <div class="settings-option" onclick="showHelpCenter()">
                    <div class="settings-info">
                        <i class="fas fa-question-circle"></i>
                        <span>Help Center</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
            </div>
            
            <div class="settings-divider"></div>
            
            <div class="settings-section">
                <div class="settings-option text-red-400" onclick="logout()">
                    <div class="settings-info">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Sign Out</span>
                    </div>
                </div>
                
                <div class="settings-option text-red-400" onclick="showDeleteAccountModal()">
                    <div class="settings-info">
                        <i class="fas fa-trash-alt"></i>
                        <span>Delete Account</span>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function renderEditProfilePage(container) {
    container.innerHTML = `
        <div class="settings-page">
            <h2 class="mb-5">Edit Profile</h2>
            
            <div class="profile-photo-upload mb-6">
                <div class="avatar ${state.isPro ? 'pro' : state.isMax ? 'pro-plus' : ''}" style="background-image: url('${state.userProfile.profilePhoto}');">
                    <button class="upload-button" onclick="changeProfilePhoto()">
                        <i class="fas fa-camera"></i>
                    </button>
                </div>
            </div>
            
            <form id="editProfileForm" onsubmit="saveProfile(event)">
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" class="form-control" id="profileName" value="${state.userProfile.name}" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Age</label>
                    <input type="number" class="form-control" id="profileAge" value="${state.userProfile.age}" min="18" max="100" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Occupation</label>
                    <input type="text" class="form-control" id="profileOccupation" value="${state.userProfile.occupation}" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Company</label>
                    <input type="text" class="form-control" id="profileCompany" value="${state.userProfile.company}" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Bio</label>
                    <textarea class="form-control" id="profileBio" rows="3" required>${state.userProfile.bio}</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Location</label>
                    <input type="text" class="form-control" id="profileLocation" value="${state.userProfile.location}" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" id="profilePhone" value="${state.userProfile.phone}" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Gender</label>
                    <select class="form-control" id="profileGender">
                        <option value="male" ${state.userProfile.gender === 'male' ? 'selected' : ''}>Male</option>
                        <option value="female" ${state.userProfile.gender === 'female' ? 'selected' : ''}>Female</option>
                        <option value="other" ${state.userProfile.gender === 'other' ? 'selected' : ''}>Other</option>
                        <option value="prefer-not-to-say" ${state.userProfile.gender === 'prefer-not-to-say' ? 'selected' : ''}>Prefer not to say</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Interests (comma separated)</label>
                    <input type="text" class="form-control" id="profileInterests" value="${state.userProfile.interests.join(', ')}" placeholder="e.g., Technology, Music, Travel">
                </div>
                
                <div class="flex gap-3 mt-6">
                    <button type="button" class="btn btn-outline flex-1" onclick="navigateTo('profile')">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary flex-1">
                        Save Changes
                    </button>
                </div>
            </form>
        </div>
    `;
}

function renderPrivacySettingsPage(container) {
    container.innerHTML = `
        <div class="settings-page">
            <h2 class="mb-5">Privacy Settings</h2>
            
            <div class="settings-section">
                <h3>Profile Visibility</h3>
                <div class="settings-option" onclick="changeProfileVisibility('public')">
                    <div class="settings-info">
                        <i class="fas fa-globe"></i>
                        <div>
                            <span>Public</span>
                            <p class="text-gray-400 text-sm">Anyone can see your profile</p>
                        </div>
                    </div>
                    ${state.userProfile.privacySettings.profileVisibility === 'public' ? '<i class="fas fa-check text-primary"></i>' : ''}
                </div>
                
                <div class="settings-option" onclick="changeProfileVisibility('connections')">
                    <div class="settings-info">
                        <i class="fas fa-user-friends"></i>
                        <div>
                            <span>Connections Only</span>
                            <p class="text-gray-400 text-sm">Only your matches can see your profile</p>
                        </div>
                    </div>
                    ${state.userProfile.privacySettings.profileVisibility === 'connections' ? '<i class="fas fa-check text-primary"></i>' : ''}
                </div>
                
                <div class="settings-option" onclick="changeProfileVisibility('private')">
                    <div class="settings-info">
                        <i class="fas fa-lock"></i>
                        <div>
                            <span>Private</span>
                            <p class="text-gray-400 text-sm">Only you can see your profile</p>
                        </div>
                    </div>
                    ${state.userProfile.privacySettings.profileVisibility === 'private' ? '<i class="fas fa-check text-primary"></i>' : ''}
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Messages</h3>
                <div class="settings-option" onclick="changeMessageSetting('everyone')">
                    <div class="settings-info">
                        <i class="fas fa-users"></i>
                        <div>
                            <span>Everyone</span>
                            <p class="text-gray-400 text-sm">Anyone can message you</p>
                        </div>
                    </div>
                    ${state.userProfile.privacySettings.allowMessages === 'everyone' ? '<i class="fas fa-check text-primary"></i>' : ''}
                </div>
                
                <div class="settings-option" onclick="changeMessageSetting('connections')">
                    <div class="settings-info">
                        <i class="fas fa-user-check"></i>
                        <div>
                            <span>Connections Only</span>
                            <p class="text-gray-400 text-sm">Only your matches can message you</p>
                        </div>
                    </div>
                    ${state.userProfile.privacySettings.allowMessages === 'connections' ? '<i class="fas fa-check text-primary"></i>' : ''}
                </div>
                
                <div class="settings-option" onclick="changeMessageSetting('none')">
                    <div class="settings-info">
                        <i class="fas fa-ban"></i>
                        <div>
                            <span>No One</span>
                            <p class="text-gray-400 text-sm">No one can message you</p>
                        </div>
                    </div>
                    ${state.userProfile.privacySettings.allowMessages === 'none' ? '<i class="fas fa-check text-primary"></i>' : ''}
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Location Sharing</h3>
                <div class="settings-option" onclick="changeLocationSharing('always')">
                    <div class="settings-info">
                        <i class="fas fa-map-marker-alt"></i>
                        <div>
                            <span>Always</span>
                            <p class="text-gray-400 text-sm">Always share your location at events</p>
                        </div>
                    </div>
                    ${state.userProfile.privacySettings.shareLocation === 'always' ? '<i class="fas fa-check text-primary"></i>' : ''}
                </div>
                
                <div class="settings-option" onclick="changeLocationSharing('events')">
                    <div class="settings-info">
                        <i class="fas fa-calendar"></i>
                        <div>
                            <span>Events Only</span>
                            <p class="text-gray-400 text-sm">Only share at events you attend</p>
                        </div>
                    </div>
                    ${state.userProfile.privacySettings.shareLocation === 'events' ? '<i class="fas fa-check text-primary"></i>' : ''}
                </div>
                
                <div class="settings-option" onclick="changeLocationSharing('never')">
                    <div class="settings-info">
                        <i class="fas fa-map-marked-alt"></i>
                        <div>
                            <span>Never</span>
                            <p class="text-gray-400 text-sm">Never share your location</p>
                        </div>
                    </div>
                    ${state.userProfile.privacySettings.shareLocation === 'never' ? '<i class="fas fa-check text-primary"></i>' : ''}
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Online Status</h3>
                <div class="settings-option">
                    <div class="settings-info">
                        <i class="fas fa-eye"></i>
                        <div>
                            <span>Show Online Status</span>
                            <p class="text-gray-400 text-sm">Let others see when you're online</p>
                        </div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" ${state.userProfile.privacySettings.showOnlineStatus ? 'checked' : ''} onchange="toggleOnlineStatus(this.checked)">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="settings-divider"></div>
            
            <div class="settings-section">
                <div class="settings-option text-red-400" onclick="showDataExportModal()">
                    <div class="settings-info">
                        <i class="fas fa-download"></i>
                        <span>Export Data</span>
                    </div>
                </div>
                
                <div class="settings-option text-red-400" onclick="showClearHistoryModal()">
                    <div class="settings-info">
                        <i class="fas fa-trash"></i>
                        <span>Clear History</span>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function renderEventManagementPage(container) {
    const organizerEvents = state.organizerEvents.length > 0 ? state.organizerEvents : state.events.filter(e => e.organizerId === 1);
    
    container.innerHTML = `
        <div class="event-management-page">
            <div class="event-management-header">
                <h2>Event Management</h2>
                <button class="btn btn-primary" onclick="showEventWizard()">
                    <i class="fas fa-plus"></i> Create Event
                </button>
            </div>
            
            ${organizerEvents.length > 0 ? `
                <div class="organizer-events">
                    ${organizerEvents.map(event => `
                        <div class="organizer-event-card">
                            <div class="organizer-event-header">
                                <div>
                                    <h4>${event.name}</h4>
                                    <p class="text-gray-400">${event.date}  ${event.time}</p>
                                </div>
                                <div class="live-badge">Live</div>
                            </div>
                            
                            <div class="organizer-event-stats">
                                <div class="organizer-stat">
                                    <div class="organizer-stat-value">${event.attendees}</div>
                                    <div class="organizer-stat-label">Attending</div>
                                </div>
                                <div class="organizer-stat">
                                    <div class="organizer-stat-value">${Math.round((event.attendees / event.maxAttendees) * 100)}%</div>
                                    <div class="organizer-stat-label">Capacity</div>
                                </div>
                                <div class="organizer-stat">
                                    <div class="organizer-stat-value">${event.comments?.length || 0}</div>
                                    <div class="organizer-stat-label">Comments</div>
                                </div>
                            </div>
                            
                            <div class="organizer-event-actions">
                                <button class="btn btn-outline btn-small" onclick="viewEventDetails(${event.id})">
                                    <i class="fas fa-eye"></i> View
                                </button>
                                <button class="btn btn-outline btn-small" onclick="editEvent(${event.id})">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="btn btn-outline btn-small" onclick="showEventAnalytics(${event.id})">
                                    <i class="fas fa-chart-line"></i> Analytics
                                </button>
                                <button class="btn btn-outline btn-small" onclick="shareEventQR(${event.id})">
                                    <i class="fas fa-qrcode"></i> QR Code
                                </button>
                            </div>
                        </div>
                    `).join('')}
                </div>
            ` : `
                <div class="empty-state">
                    <i class="fas fa-calendar-plus"></i>
                    <h3>No Events Created</h3>
                    <p>Create your first event to start managing</p>
                    <button class="btn btn-primary mt-4" onclick="showEventWizard()">
                        <i class="fas fa-plus"></i> Create Your First Event
                    </button>
                </div>
            `}
            
            <div class="card mt-6">
                <h4 class="mb-4">Event Management Tips</h4>
                <ul class="text-gray-400 space-y-2">
                    <li class="flex items-start gap-2">
                        <i class="fas fa-check text-primary mt-1"></i>
                        <span>Set up geofencing to ensure attendees are physically present</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <i class="fas fa-check text-primary mt-1"></i>
                        <span>Use community photos to build excitement</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <i class="fas fa-check text-primary mt-1"></i>
                        <span>Engage with comments to increase event visibility</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <i class="fas fa-check text-primary mt-1"></i>
                        <span>Share event QR codes for easy check-ins</span>
                    </li>
                </ul>
            </div>
        </div>
    `;
}

function renderEventsPage(container) {
    const filteredEvents = filterEventsBySearch();
    
    container.innerHTML = `
        <div class="events-container" id="eventsContainer">
            <div class="map-handle" id="mapHandle">
                <div class="map-handle-bar"></div>
            </div>
            <div class="events-header">
                <div class="search-container">
                    <div class="flex gap-3">
                        <div class="search-input-wrapper flex-1">
                            <i class="fas fa-search"></i>
                            <input type="text" 
                                   class="search-input" 
                                   id="eventSearchInput" 
                                   placeholder="Search events in Namibia..." 
                                   value="${state.eventSearchQuery}"
                                   oninput="handleEventSearchInput(event)">
                            ${state.eventSearchQuery ? `
                                <button type="button" class="clear-search" onclick="clearEventSearch()">
                                    <i class="fas fa-times"></i>
                                </button>
                            ` : ''}
                        </div>
                        <button class="btn btn-primary search-button" onclick="performEventSearch()">
                            <i class="fas fa-search"></i> Search
                        </button>
                    </div>
                    
                    <div class="search-suggestions ${state.searchSuggestions.length > 0 ? 'active' : ''}" id="searchSuggestions">
                        ${state.searchSuggestions.map(suggestion => `
                            <div class="suggestion-item" onclick="selectSearchSuggestion('${suggestion}')">
                                <i class="fas fa-search"></i>
                                <span>${suggestion}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                ${state.activeFilters.length > 0 ? `
                    <div class="filter-pills" id="filterPills">
                        ${state.activeFilters.map(filter => `
                            <div class="filter-pill active">
                                ${filter}
                                <span class="remove" onclick="removeFilter('${filter}')"></span>
                            </div>
                        `).join('')}
                        <div class="filter-pill" onclick="clearAllFilters()">
                            Clear All
                        </div>
                    </div>
                ` : ''}
                
                <div class="flex gap-3 mt-4">
                    <button class="btn btn-primary flex-1" onclick="showEventWizard()">
                        <i class="fas fa-plus"></i> ${state.isPro || state.isMax ? 'Create Event' : 'Upgrade to Create'}
                    </button>
                    <button class="btn btn-outline" onclick="showFiltersModal()">
                        <i class="fas fa-filter"></i>
                    </button>
                </div>
            </div>
            <div class="events-list" id="eventsList">
                ${filteredEvents.length > 0 ? filteredEvents.map(event => `
                    <div class="event-card-list" onclick="viewEventDetails(${event.id})">
                        <div class="event-card-image">
                            <img src="${event.coverImage}" alt="${event.name}">
                            <button class="bookmark-btn ${event.bookmarked ? 'active' : ''}" onclick="event.stopPropagation(); toggleBookmark(${event.id})">
                                <i class="fas fa-bookmark"></i>
                            </button>
                        </div>
                        <div class="event-card-content">
                            <h4 class="mb-2">${event.name}</h4>
                            <p class="text-gray-400 text-sm mb-2">
                                <i class="fas fa-map-marker-alt"></i> ${event.location}
                            </p>
                            <div class="flex items-center gap-4 text-sm">
                                <span class="text-gradient">
                                    <i class="fas fa-users"></i> ${event.attendees}
                                </span>
                                <span class="text-gray-400">${event.date}</span>
                                ${event.price > 0 ? `
                                    <span class="text-yellow-500">
                                        ${formatCurrency(event.price, event.currency)}
                                    </span>
                                ` : `
                                    <span class="text-green-500">Free</span>
                                `}
                            </div>
                        </div>
                    </div>
                `).join('') : `
                    <div class="text-center py-12">
                        <i class="fas fa-search" style="font-size: 48px; color: var(--gray-600); margin-bottom: 16px;"></i>
                        <h3 class="mb-2">No events found</h3>
                        <p class="text-gray-400">Try adjusting your search or filters</p>
                        <button class="btn btn-primary mt-4" onclick="clearEventSearch()">
                            Clear Search
                        </button>
                    </div>
                `}
            </div>
        </div>
        
        <div class="map-drawer">
            <div class="map-container">
                <div id="map"></div>
            </div>
        </div>
        
        <div class="snap-points">
            <div class="snap-dot ${state.mapDrawerPosition < 100 ? 'active' : ''}"></div>
            <div class="snap-dot ${state.mapDrawerPosition >= 100 && state.mapDrawerPosition < 300 ? 'active' : ''}"></div>
            <div class="snap-dot ${state.mapDrawerPosition >= 300 ? 'active' : ''}"></div>
        </div>
    `;
    
    // Initialize map
    setTimeout(() => {
        if (!state.map) {
            initMap();
        }
    }, 100);
}

function renderEventDetailsPage(container) {
    if (!state.currentEvent) {
        container.innerHTML = `
            <div class="text-center py-12">
                <i class="fas fa-calendar-times" style="font-size: 64px; color: var(--gray-600); margin-bottom: 16px;"></i>
                <h3 class="mb-2">Event Not Found</h3>
                <p class="text-gray-400 mb-6">The event you're looking for doesn't exist</p>
                <button class="btn btn-primary" onclick="navigateTo('events')">
                    <i class="fas fa-arrow-left"></i> Back to Events
                </button>
            </div>
        `;
        return;
    }
    
    const event = state.currentEvent;
    const photosToShow = event.communityPhotos ? event.communityPhotos.slice(0, 4) : [];
    const remainingPhotos = event.communityPhotos ? event.communityPhotos.length - 4 : 0;
    
    container.innerHTML = `
        <div class="event-details-page">
            <div class="event-details-header">
                <img src="${event.coverImage}" alt="${event.name}">
                <div class="event-details-header-overlay">
                    <h1 class="text-2xl font-bold mb-2">${event.name}</h1>
                    <p class="text-gray-300">${event.description}</p>
                </div>
            </div>
            
            <div class="event-details-content">
                <div class="event-details-section">
                    <h2 class="text-xl font-bold mb-4">Event Details</h2>
                    <div class="event-info-grid">
                        <div class="event-info-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <div>
                                <p class="font-medium">Location</p>
                                <p class="text-gray-400">${event.location}</p>
                            </div>
                        </div>
                        <div class="event-info-item">
                            <i class="fas fa-calendar"></i>
                            <div>
                                <p class="font-medium">Date & Time</p>
                                <p class="text-gray-400">${event.date}  ${event.time}</p>
                            </div>
                        </div>
                        <div class="event-info-item">
                            <i class="fas fa-users"></i>
                            <div>
                                <p class="font-medium">Attendees</p>
                                <p class="text-gradient font-bold">${event.attendees} / ${event.maxAttendees}</p>
                            </div>
                        </div>
                        <div class="event-info-item">
                            <i class="fas fa-tag"></i>
                            <div>
                                <p class="font-medium">Category</p>
                                <p class="text-gray-400">${event.category}</p>
                            </div>
                        </div>
                    </div>
                    
                    ${event.price > 0 ? `
                        <div class="mt-4">
                            <p class="font-medium">Price</p>
                            <p class="text-2xl text-gradient font-bold">${formatCurrency(event.price, event.currency)}</p>
                        </div>
                    ` : ''}
                    
                    <div class="event-tags">
                        ${event.tags.map(tag => `<span class="event-tag">${tag}</span>`).join('')}
                    </div>
                    
                    <div class="event-actions">
                        <button class="btn btn-primary flex-1" onclick="checkInToEvent(${event.id})">
                            <i class="fas fa-qrcode"></i> Check In
                        </button>
                        <button class="btn btn-outline" onclick="shareEventWithOptions(${event.id})">
                            <i class="fas fa-share"></i>
                        </button>
                        <button class="btn btn-outline ${event.bookmarked ? 'active' : ''}" onclick="toggleBookmark(${event.id})">
                            <i class="fas fa-bookmark"></i>
                        </button>
                    </div>
                </div>
                
                <div class="photo-dump-section">
                    <div class="photo-dump-header">
                        <h2 class="text-xl font-bold">Community Photos</h2>
                        ${(state.isPro || state.isMax) ? `
                            <button class="btn btn-outline btn-small" onclick="uploadCommunityPhoto(${event.id})">
                                <i class="fas fa-upload"></i> Add Photo
                            </button>
                        ` : ''}
                    </div>
                    
                    ${photosToShow.length > 0 ? `
                        <div class="photo-dump-grid">
                            ${photosToShow.map((photo, index) => `
                                <div class="photo-dump-item" onclick="viewPhoto('${photo}', ${index})">
                                    <img src="${photo}" alt="Community photo ${index + 1}">
                                    ${index === 3 && remainingPhotos > 0 ? `
                                        <div class="photo-dump-overlay">
                                            +${remainingPhotos}
                                        </div>
                                    ` : ''}
                                    <div class="photo-watermark">
                                        <span class="ampz-logo">AMPS</span>
                                        <span class="text-gray-300 text-xs">Community Photo</span>
                                    </div>
                                    <button class="download-photo-btn" onclick="event.stopPropagation(); downloadPhoto('${photo}', '${event.name}-${index + 1}')">
                                        <i class="fas fa-download"></i>
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                        ${remainingPhotos > 0 ? `
                            <button class="btn btn-outline btn-block mt-4" onclick="viewAllPhotos(${event.id})">
                                View All ${event.communityPhotos.length} Photos
                            </button>
                        ` : ''}
                    ` : `
                        <div class="text-center py-8 bg-gray-900/50 rounded-xl">
                            <i class="fas fa-images text-gray-600 text-4xl mb-4"></i>
                            <p class="text-gray-400">No community photos yet</p>
                            ${(state.isPro || state.isMax) ? `
                                <button class="btn btn-primary mt-4" onclick="uploadCommunityPhoto(${event.id})">
                                    <i class="fas fa-upload"></i> Be the first to upload
                                </button>
                            ` : ''}
                        </div>
                    `}
                    
                    ${!(state.isPro || state.isMax) ? `
                        <div class="mt-4 text-center text-sm text-gray-400">
                            <i class="fas fa-crown"></i> Upgrade to Pro to upload community photos
                        </div>
                    ` : ''}
                </div>
                
                <div class="comment-section">
                    <div class="comment-section-header">
                        <h2 class="text-xl font-bold">Comments</h2>
                        <span class="text-gray-400">${event.comments?.length || 0} comments</span>
                    </div>
                    
                    <div class="comments-list" id="commentsList">
                        ${event.comments && event.comments.length > 0 ? event.comments.map(comment => `
                            <div class="comment">
                                <div class="comment-avatar" style="background-image: url('${comment.userAvatar}');"></div>
                                <div class="comment-content">
                                    <div class="comment-header">
                                        <span class="comment-author">${comment.userName}</span>
                                        <span class="comment-time">${comment.timestamp}</span>
                                    </div>
                                    <p class="comment-text">${comment.text}</p>
                                    <div class="comment-actions">
                                        <button class="comment-action" onclick="likeComment(${event.id}, ${comment.id})">
                                            <i class="fas fa-heart"></i>
                                            <span>${comment.likes}</span>
                                        </button>
                                        <button class="comment-action" onclick="replyToComment(${event.id}, ${comment.id})">
                                            <i class="fas fa-reply"></i>
                                            <span>Reply</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `).join('') : `
                            <div class="text-center py-8">
                                <i class="fas fa-comments text-gray-600 text-4xl mb-4"></i>
                                <p class="text-gray-400">No comments yet. Be the first to comment!</p>
                            </div>
                        `}
                    </div>
                    
                    <form class="comment-form" onsubmit="addComment(event, ${event.id})">
                        <textarea class="comment-input" id="commentInput${event.id}" placeholder="Add a comment..." rows="1"></textarea>
                        <button type="submit" class="comment-submit">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    `;
}

function renderProfilePage(container) {
    const profileCompleteness = calculateProfileCompleteness();
    
    container.innerHTML = `
        <div class="profile-page">
            <div class="profile-header">
                <div class="avatar ${state.isPro ? 'pro' : state.isMax ? 'pro-plus' : ''}" style="background-image: url('${state.userProfile.profilePhoto}');">
                    <button class="upload-button" onclick="changeProfilePhoto()">
                        <i class="fas fa-camera"></i>
                    </button>
                </div>
                <h2>${state.userProfile.name}</h2>
                <p class="text-gray-400">${state.userProfile.occupation} at ${state.userProfile.company}</p>
                <p class="text-gray-400">${state.userProfile.location}</p>
                
                <div class="mt-4 w-full max-w-xs mx-auto">
                    <div class="flex justify-between text-sm mb-1">
                        <span>Profile Completeness</span>
                        <span>${profileCompleteness}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${profileCompleteness}%"></div>
                    </div>
                </div>
            </div>
            
            <div class="card mt-6">
                <h3 class="mb-4">About</h3>
                <p class="text-gray-300 mb-4">${state.userProfile.bio}</p>
                
                <div class="flex flex-wrap gap-2">
                    ${state.userProfile.interests.map(interest => `
                        <span class="event-tag">${interest}</span>
                    `).join('')}
                </div>
            </div>
            
            <div class="card mt-6">
                <h3 class="mb-4">Stats</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${state.matches.length}</div>
                        <div class="stat-label">Matches</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${state.events.filter(e => state.userProfile.bookmarkedEvents?.includes(e.id)).length}</div>
                        <div class="stat-label">Bookmarks</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${state.tickets.length}</div>
                        <div class="stat-label">Tickets</div>
                    </div>
                </div>
            </div>
            
            <div class="card mt-6">
                <h3 class="mb-4">Account Settings</h3>
                <div class="settings-option" onclick="navigateTo('edit-profile')">
                    <div class="settings-info">
                        <i class="fas fa-user-edit"></i>
                        <span>Edit Profile</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
                <div class="settings-option" onclick="navigateTo('privacy-settings')">
                    <div class="settings-info">
                        <i class="fas fa-shield-alt"></i>
                        <span>Privacy Settings</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
                <div class="settings-option" onclick="navigateTo('settings')">
                    <div class="settings-info">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
            </div>
            
            <div class="card mt-6">
                <h3 class="mb-4">Subscription</h3>
                <div class="settings-option" onclick="showSubscriptionPlans()">
                    <div class="settings-info">
                        <i class="fas fa-crown"></i>
                        <span>${state.isPro ? 'Pro Plan' : state.isMax ? 'Max Plan' : 'Free Plan'}</span>
                    </div>
                    <span class="settings-value ${state.isPro ? 'pro-gradient' : state.isMax ? 'pro-plus-gradient' : 'text-gray-400'}">
                        ${state.isPro ? 'PRO' : state.isMax ? 'MAX' : 'FREE'}
                    </span>
                </div>
                <button class="btn ${state.isPro ? 'btn-pro' : state.isMax ? 'btn-pro-plus' : 'btn-primary'} btn-block mt-4" onclick="showSubscriptionPlans()">
                    <i class="fas fa-${state.isPro || state.isMax ? 'crown' : 'arrow-up'}"></i>
                    ${state.isPro || state.isMax ? 'Manage Subscription' : 'Upgrade Now'}
                </button>
            </div>
        </div>
    `;
}

function renderMatchesPage(container) {
    container.innerHTML = `
        <div class="matches-page">
            <div class="matches-header">
                <h2>Messages</h2>
            </div>
            
            <div class="matches-search">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search messages..." oninput="searchMessages(this.value)">
            </div>
            
            ${state.matches.length > 0 ? `
                <div class="matches-list" id="matchesList">
                    ${state.matches.map(match => {
                        const profile = MOCK_PROFILES.find(p => p.id === match.matchId);
                        const chatId = `${state.currentUser?.id}_${match.matchId}`;
                        const messages = state.chatMessages[chatId] || [];
                        const lastMessage = messages.length > 0 ? messages[messages.length - 1] : null;
                        
                        return `
                            <div class="match-item" onclick="openChat(${match.matchId})">
                                <div class="match-avatar" style="background-image: url('${profile?.livePhoto || ''}');">
                                    ${profile?.online ? '<div class="match-status"></div>' : ''}
                                </div>
                                <div class="match-info">
                                    <div class="match-name">
                                        <span>${profile?.name || 'Unknown'}</span>
                                        <span class="match-time">${match.lastMessageTime}</span>
                                    </div>
                                    <div class="match-last-message">
                                        <span>${lastMessage?.text || match.lastMessage || 'Start a conversation!'}</span>
                                        ${match.unread ? `<span class="unread-badge">${match.unreadCount || 1}</span>` : ''}
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            ` : `
                <div class="empty-state">
                    <i class="fas fa-comments" style="font-size: 64px; color: var(--gray-600); margin-bottom: 16px;"></i>
                    <h3>No Messages Yet</h3>
                    <p>Match with people at events to start chatting</p>
                    <button class="btn btn-primary mt-4" onclick="navigateTo('events')">
                        <i class="fas fa-calendar"></i> Find Events
                    </button>
                </div>
            `}
        </div>
    `;
}

function renderConnectPage(container) {
    const currentProfile = state.swipeProfiles[state.currentProfileIndex];
    
    if (!currentProfile) {
        container.innerHTML = `
            <div class="swipe-interface">
                <div class="swipe-header">
                    <h2>Connect</h2>
                    <p class="text-gray-400">No more profiles to swipe</p>
                </div>
                
                <div class="card-stack">
                    <div class="text-center py-12">
                        <i class="fas fa-users text-4xl text-gray-600 mb-4"></i>
                        <h3 class="mb-2">No Profiles Available</h3>
                        <p class="text-gray-400 mb-6">Check into an event to see attendees</p>
                        <button class="btn btn-primary" onclick="navigateTo('events')">
                            <i class="fas fa-calendar"></i> Find Events
                        </button>
                    </div>
                </div>
                
                <div class="swipe-actions">
                    <button class="btn btn-outline flex-1" onclick="resetSwipes()">
                        <i class="fas fa-redo"></i> Reset Swipes
                    </button>
                </div>
            </div>
        `;
        return;
    }
    
    container.innerHTML = `
        <div class="connect-page">
            <div class="swipe-interface">
                <div class="swipe-header">
                    <h2>Connect</h2>
                    <p class="text-gray-400">Swipe right to like, left to pass</p>
                    <div class="stats-row">
                        <div class="stat">
                            <i class="fas fa-heart"></i>
                            <span>${state.swipeCount} swipes today</span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-undo"></i>
                            <span>${state.rewindCount} rewinds left</span>
                        </div>
                    </div>
                </div>
                
                <div class="card-stack">
                    <div class="card-container" id="cardContainer">
                        <div class="profile-card" id="profileCard" style="background: ${currentProfile.cardColor || 'var(--card-purple)'}">
                            <div class="card-frame"></div>
                            <div class="card-content">
                                <div class="profile-image" style="background-image: url('${currentProfile.livePhoto}');">
                                    <div class="live-badge">
                                        <i class="fas fa-camera"></i>
                                        <span>LIVE</span>
                                    </div>
                                </div>
                                <div class="profile-info">
                                    <h2>${currentProfile.name}, ${currentProfile.age}</h2>
                                    <p class="text-gray-600 mb-2">
                                        <i class="fas fa-map-marker-alt"></i> ${currentProfile.location}  ${currentProfile.distance}
                                    </p>
                                    ${currentProfile.verified ? `
                                        <div class="badge badge-success mb-3">
                                            <i class="fas fa-check-circle"></i> Verified
                                        </div>
                                    ` : ''}
                                    
                                    <p class="mb-4">${currentProfile.bio}</p>
                                    
                                    <div class="interests mb-6">
                                        ${currentProfile.interests.slice(0, 4).map(interest => `
                                            <span class="interest-tag">${interest}</span>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="swipe-actions">
                    <button class="action-button nope" onclick="swipeLeft()">
                        <i class="fas fa-times"></i>
                        <span>Nope</span>
                    </button>
                    
                    <button class="action-button rewind" onclick="undoSwipe()" ${state.rewindCount <= 0 ? 'disabled' : ''}>
                        <i class="fas fa-undo"></i>
                        <span>Rewind</span>
                    </button>
                    
                    <button class="action-button refresh" onclick="resetSwipes()">
                        <i class="fas fa-redo"></i>
                        <span>Refresh</span>
                    </button>
                    
                    <button class="action-button like" onclick="swipeRight()">
                        <i class="fas fa-heart"></i>
                        <span>Like</span>
                    </button>
                </div>
            </div>
        </div>
    `;
}

function renderChatPage(container) {
    if (!state.activeChatId) {
        container.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-comment" style="font-size: 64px; color: var(--gray-600); margin-bottom: 16px;"></i>
                <h3>Select a Conversation</h3>
                <p>Choose a match from your messages to start chatting</p>
                <button class="btn btn-primary mt-4" onclick="navigateTo('matches')">
                    <i class="fas fa-arrow-left"></i> Back to Messages
                </button>
            </div>
        `;
        return;
    }
    
    const match = state.matches.find(m => m.matchId === state.activeChatId);
    const profile = MOCK_PROFILES.find(p => p.id === state.activeChatId);
    const chatId = `${state.currentUser?.id}_${state.activeChatId}`;
    const messages = state.chatMessages[chatId] || [];
    
    // Mark as read
    if (match) {
        match.unread = false;
        match.unreadCount = 0;
    }
    
    container.innerHTML = `
        <div class="chat-interface">
            <div class="chat-header">
                <button class="back-btn" onclick="closeChat()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div class="chat-avatar" style="background-image: url('${profile?.livePhoto || ''}');"></div>
                <div class="chat-info">
                    <div class="chat-name">${profile?.name || 'Unknown'}</div>
                    <div class="chat-status">${profile?.online ? 'Online' : 'Offline'}</div>
                </div>
                <div class="chat-actions">
                    <button onclick="shareEventToChat(${state.activeChatId})">
                        <i class="fas fa-share"></i>
                    </button>
                    <button onclick="showChatSettings(${state.activeChatId})">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                ${messages.map(msg => `
                    <div class="message ${msg.sender === 'user' ? 'sent' : 'received'}">
                        ${msg.sender === 'received' ? `
                            <div class="message-avatar" style="background-image: url('${profile?.livePhoto || ''}');"></div>
                        ` : ''}
                        <div class="message-content">
                            <div class="message-bubble">${msg.text}</div>
                            <div class="message-time">${msg.time}</div>
                        </div>
                        ${msg.sender === 'user' ? `
                            <div class="message-avatar" style="background-image: url('${state.userProfile.profilePhoto}');"></div>
                        ` : ''}
                    </div>
                `).join('')}
            </div>
            
            <div class="chat-input-container">
                <textarea class="chat-input" id="chatInput" placeholder="Message..." rows="1" onkeypress="if(event.key === 'Enter' && !event.shiftKey) {event.preventDefault(); sendChatMessage();}"></textarea>
                <button class="chat-send-btn" onclick="sendChatMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    `;
    
    // Scroll to bottom
    setTimeout(() => {
        const messagesContainer = document.getElementById('chatMessages');
        if (messagesContainer) {
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
    }, 100);
}

// ===== EVENT CREATION WIZARD =====
function showEventWizard() {
    if (!state.isPro && !state.isMax) {
        showSubscriptionPlans();
        return;
    }
    
    const modal = document.createElement('div');
    modal.className = 'event-wizard-modal';
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create Event</h2>
                <button class="modal-close" onclick="closeEventWizard()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="wizard-progress" id="wizardProgress">
                <div class="progress-step ${state.eventWizardData.step >= 1 ? 'active' : ''} ${state.eventWizardData.step > 1 ? 'completed' : ''}">1</div>
                <div class="progress-step ${state.eventWizardData.step >= 2 ? 'active' : ''} ${state.eventWizardData.step > 2 ? 'completed' : ''}">2</div>
                <div class="progress-step ${state.eventWizardData.step >= 3 ? 'active' : ''} ${state.eventWizardData.step > 3 ? 'completed' : ''}">3</div>
                <div class="progress-step ${state.eventWizardData.step >= 4 ? 'active' : ''}">4</div>
            </div>
            
            <div class="wizard-step ${state.eventWizardData.step === 1 ? 'active' : ''}" id="wizardStep1">
                <div class="wizard-step-header">
                    <h3>Event Basics</h3>
                    <span class="step-indicator">Step 1/4</span>
                </div>
                <div class="step-content">
                    <div class="form-group">
                        <label class="form-label">Event Name *</label>
                        <input type="text" class="form-control" id="wizardEventName" value="${state.eventWizardData.data.name}" placeholder="Tech Mixer Afterparty" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Description *</label>
                        <textarea class="form-control" id="wizardEventDescription" rows="3" placeholder="Describe your event..." required>${state.eventWizardData.data.description}</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Category *</label>
                        <select class="form-control" id="wizardEventCategory" required>
                            <option value="" ${!state.eventWizardData.data.category ? 'selected' : ''}>Select Category</option>
                            <option value="Tech Networking" ${state.eventWizardData.data.category === 'Tech Networking' ? 'selected' : ''}>Technology</option>
                            <option value="Art & Culture" ${state.eventWizardData.data.category === 'Art & Culture' ? 'selected' : ''}>Art & Culture</option>
                            <option value="Music Festival" ${state.eventWizardData.data.category === 'Music Festival' ? 'selected' : ''}>Music</option>
                            <option value="Sports" ${state.eventWizardData.data.category === 'Sports' ? 'selected' : ''}>Sports</option>
                            <option value="Food & Drink" ${state.eventWizardData.data.category === 'Food & Drink' ? 'selected' : ''}>Food & Drink</option>
                        </select>
                    </div>
                </div>
                <div class="wizard-navigation">
                    <button type="button" class="btn btn-outline" onclick="closeEventWizard()">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="nextWizardStep()">Next</button>
                </div>
            </div>
            
            <div class="wizard-step ${state.eventWizardData.step === 2 ? 'active' : ''}" id="wizardStep2">
                <div class="wizard-step-header">
                    <h3>Location & Time</h3>
                    <span class="step-indicator">Step 2/4</span>
                </div>
                <div class="step-content">
                    <div class="form-group">
                        <label class="form-label">Location Name *</label>
                        <input type="text" class="form-control" id="wizardEventLocation" value="${state.eventWizardData.data.location}" placeholder="Windhoek Country Club" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Address *</label>
                        <input type="text" class="form-control" id="wizardEventAddress" value="${state.eventWizardData.data.address}" placeholder="123 Main St, Windhoek" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Date & Time *</label>
                        <div class="flex gap-3">
                            <input type="date" class="form-control flex-1" id="wizardEventDate" value="${state.eventWizardData.data.date}" required>
                            <input type="time" class="form-control flex-1" id="wizardEventTime" value="${state.eventWizardData.data.time}" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Capacity *</label>
                        <input type="number" class="form-control" id="wizardEventCapacity" value="${state.eventWizardData.data.capacity || 100}" min="1" max="1000" required>
                    </div>
                </div>
                <div class="wizard-navigation">
                    <button type="button" class="btn btn-outline" onclick="prevWizardStep()">Back</button>
                    <button type="button" class="btn btn-primary" onclick="nextWizardStep()">Next</button>
                </div>
            </div>
            
            <div class="wizard-step ${state.eventWizardData.step === 3 ? 'active' : ''}" id="wizardStep3">
                <div class="wizard-step-header">
                    <h3>Geofence Setup</h3>
                    <span class="step-indicator">Step 3/4</span>
                </div>
                <div class="step-content">
                    <div class="form-group">
                        <label class="form-label">Geofence Radius</label>
                        <div class="geofence-radius-control">
                            <div class="geofence-value">
                                <span>5m</span>
                                <span id="geofenceRadiusValue">${state.eventWizardData.data.geofenceRadius || 100}m</span>
                                <span>500m</span>
                            </div>
                            <input type="range" class="geofence-slider" id="geofenceRadiusSlider" min="5" max="500" value="${state.eventWizardData.data.geofenceRadius || 100}" oninput="updateGeofenceRadius(this.value)">
                        </div>
                        <p class="text-gray-400 text-sm mt-2">Attendees must be within this radius to connect</p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Select Location on Map</label>
                        <div class="geofence-map-container" id="geofenceMap">
                            <div class="loading-spinner"></div>
                        </div>
                        <button class="btn btn-outline btn-block mt-3" onclick="pickLocationOnMap()">
                            <i class="fas fa-map-marker-alt"></i> Pick Location
                        </button>
                    </div>
                </div>
                <div class="wizard-navigation">
                    <button type="button" class="btn btn-outline" onclick="prevWizardStep()">Back</button>
                    <button type="button" class="btn btn-primary" onclick="nextWizardStep()">Next</button>
                </div>
            </div>
            
            <div class="wizard-step ${state.eventWizardData.step === 4 ? 'active' : ''}" id="wizardStep4">
                <div class="wizard-step-header">
                    <h3>Tickets & Theme</h3>
                    <span class="step-indicator">Step 4/4</span>
                </div>
                <div class="step-content">
                    <div class="form-group">
                        <label class="form-label">Ticket Type *</label>
                        <select class="form-control" id="wizardTicketType" onchange="toggleTicketPrice()" required>
                            <option value="free" ${state.eventWizardData.data.ticketType === 'free' ? 'selected' : ''}>Free</option>
                            <option value="paid" ${state.eventWizardData.data.ticketType === 'paid' ? 'selected' : ''}>Paid</option>
                        </select>
                    </div>
                    <div class="form-group" id="wizardPriceGroup" style="display: ${state.eventWizardData.data.ticketType === 'paid' ? 'block' : 'none'}">
                        <label class="form-label">Price (NAD) *</label>
                        <input type="number" class="form-control" id="wizardTicketPrice" value="${state.eventWizardData.data.price || 0}" min="0" step="0.01" placeholder="25.00">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Available Tickets *</label>
                        <input type="number" class="form-control" id="wizardAvailableTickets" value="${state.eventWizardData.data.availableTickets || 100}" min="1" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Event Theme Color</label>
                        <div class="color-grid">
                            ${['#8B5CF6', '#EC4899', '#3B82F6', '#10B981', '#F59E0B', '#F97316', '#EF4444', '#14B8A6', '#6366F1', '#000000'].map(color => `
                                <div class="color-option ${state.eventWizardData.data.themeColor === color ? 'active' : ''}" style="background: ${color};" onclick="selectEventColor('${color}')"></div>
                            `).join('')}
                        </div>
                    </div>
                </div>
                <div class="wizard-navigation">
                    <button type="button" class="btn btn-outline" onclick="prevWizardStep()">Back</button>
                    <button type="button" class="btn btn-primary" onclick="createEvent()">Create Event</button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    modal.style.display = 'flex';
    
    // Initialize geofence map
    setTimeout(() => {
        initGeofenceMap();
    }, 100);
}

// ===== CHECK-IN FLOW =====
function startCheckInFlow() {
    const modal = document.createElement('div');
    modal.className = 'checkin-modal';
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <h2>Check In to Event</h2>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="text-center py-6">
                <div class="qr-frame mb-6">
                    <div class="qr-frame-inner"></div>
                </div>
                <p class="qr-instruction">Scan event QR code or enter code manually</p>
                
                <div class="form-group mb-4 mt-6">
                    <label class="form-label">Or enter event code manually</label>
                    <input type="text" class="form-control" id="eventCodeInput" placeholder="e.g., AMPS_TECH_2024_001">
                </div>
                
                <div class="flex gap-3">
                    <button class="btn btn-outline flex-1" onclick="simulateQRScan()">
                        <i class="fas fa-camera"></i> Scan QR
                    </button>
                    <button class="btn btn-primary flex-1" onclick="checkInWithCode()">
                        <i class="fas fa-check"></i> Check In
                    </button>
                </div>
                
                <div class="mt-6">
                    <h4 class="mb-3">Recent Events</h4>
                    <div class="space-y-2">
                        ${state.events.slice(0, 3).map(event => `
                            <div class="event-item flex items-center gap-3 p-3 bg-gray-900/50 rounded-lg cursor-pointer" onclick="quickCheckIn(${event.id})">
                                <div class="w-12 h-12 rounded-lg bg-cover bg-center" style="background-image: url('${event.coverImage}');"></div>
                                <div class="flex-1">
                                    <h5 class="font-medium">${event.name}</h5>
                                    <p class="text-gray-400 text-sm">${event.date}  ${event.location}</p>
                                </div>
                                <i class="fas fa-arrow-right text-gray-400"></i>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    modal.style.display = 'flex';
}

function simulateQRScan() {
    // Simulate scanning a QR code
    const simulatedEvent = state.events[0];
    showNotification(`Scanned QR for ${simulatedEvent.name}`, 'success');
    closeModal();
    
    // Show privacy choice modal
    setTimeout(() => {
        showPrivacyChoice(simulatedEvent.id);
    }, 500);
}

function checkInWithCode() {
    const codeInput = document.getElementById('eventCodeInput');
    if (!codeInput || !codeInput.value.trim()) {
        showNotification('Please enter an event code', 'error');
        return;
    }
    
    const event = state.events.find(e => e.qrCode === codeInput.value.trim());
    if (event) {
        showNotification(`Found event: ${event.name}`, 'success');
        closeModal();
        showPrivacyChoice(event.id);
    } else {
        showNotification('Event not found. Please check the code.', 'error');
    }
}

function quickCheckIn(eventId) {
    const event = state.events.find(e => e.id === eventId);
    if (event) {
        closeModal();
        showPrivacyChoice(eventId);
    }
}

function showPrivacyChoice(eventId) {
    const event = state.events.find(e => e.id === eventId);
    if (!event) return;
    
    const modal = document.createElement('div');
    modal.className = 'privacy-choice-modal';
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <h2>Privacy Settings for ${event.name}</h2>
                <p class="text-gray-400">How would you like to appear to others?</p>
            </div>
            
            <div class="privacy-options">
                <div class="privacy-option public" onclick="selectPrivacy('public', ${eventId})">
                    <div class="privacy-icon">
                        <i class="fas fa-globe"></i>
                    </div>
                    <div class="privacy-info">
                        <h4>Public</h4>
                        <p class="text-gray-400">Everyone at the event can see your profile</p>
                    </div>
                    <div class="privacy-badge">
                        <i class="fas fa-check"></i>
                    </div>
                </div>
                
                <div class="privacy-option private" onclick="selectPrivacy('private', ${eventId})">
                    <div class="privacy-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <div class="privacy-info">
                        <h4>Private</h4>
                        <p class="text-gray-400">Only your matches can see your profile</p>
                    </div>
                    <div class="privacy-badge">
                        <i class="fas fa-check"></i>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 text-center">
                <button class="btn btn-outline" onclick="closeModal()">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    modal.style.display = 'flex';
}

function selectPrivacy(privacy, eventId) {
    state.checkInFlow = {
        active: true,
        step: 'privacy',
        eventId: eventId,
        privacyChoice: privacy,
        livePhoto: null
    };
    
    closeModal();
    
    // Show camera for live photo
    setTimeout(() => {
        showCameraModal(eventId, privacy);
    }, 500);
}

function showCameraModal(eventId, privacy) {
    const modal = document.createElement('div');
    modal.className = 'camera-modal';
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <h2>Take a Live Photo</h2>
                <p class="text-gray-400">Show others you're really at the event</p>
            </div>
            
            <div class="camera-container">
                <div class="camera-preview" id="cameraPreview">
                    <div class="camera-overlay"></div>
                    <div class="qr-frame">
                        <div class="qr-frame-inner"></div>
                    </div>
                    <p class="qr-instruction">Position your face in the frame</p>
                </div>
                
                <div class="camera-controls">
                    <button class="camera-btn" onclick="captureLivePhoto(${eventId}, '${privacy}')">
                        <i class="fas fa-camera"></i>
                    </button>
                    <button class="btn btn-outline" onclick="skipLivePhoto(${eventId}, '${privacy}')">
                        <i class="fas fa-forward"></i> Skip
                    </button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    modal.style.display = 'flex';
}

function captureLivePhoto(eventId, privacy) {
    const livePhoto = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%238B5CF6"/><text x="100" y="120" font-size="24" text-anchor="middle" fill="white">Live Photo</text></svg>';
    state.checkInFlow.livePhoto = livePhoto;
    completeCheckIn(eventId, privacy);
}

function skipLivePhoto(eventId, privacy) {
    completeCheckIn(eventId, privacy);
}

function completeCheckIn(eventId, privacy) {
    const event = state.events.find(e => e.id === eventId);
    if (!event) return;
    
    event.attendees = Math.min(event.attendees + 1, event.maxAttendees);
    state.currentEvent = event;
    
    if (!state.userProfile.eventPrivacy) {
        state.userProfile.eventPrivacy = {};
    }
    state.userProfile.eventPrivacy[eventId] = privacy;
    
    closeModal();
    
    showNotification(` Successfully checked into ${event.name}!`, 'success');
    
    // Navigate to connect page
    setTimeout(() => {
        navigateTo('connect');
    }, 1000);
    
    saveState();
}

// ===== SWIPE FUNCTIONS =====
function swipeLeft() {
    const card = document.getElementById('profileCard');
    if (!card) return;
    
    card.classList.add('swipe-left');
    state.swipeCount++;
    state.swipeHistory.push({
        profileIndex: state.currentProfileIndex,
        direction: 'left',
        profile: state.swipeProfiles[state.currentProfileIndex]
    });
    
    setTimeout(() => {
        state.currentProfileIndex++;
        if (state.currentProfileIndex >= state.swipeProfiles.length) {
            state.currentProfileIndex = 0;
        }
        renderPage();
    }, 500);
    
    saveState();
}

function swipeRight() {
    if (state.swipeCount >= state.dailyLikes && !(state.isPro || state.isMax)) {
        showNotification('Daily like limit reached. Upgrade to Pro for unlimited likes.', 'error');
        return;
    }
    
    const card = document.getElementById('profileCard');
    if (!card) return;
    
    card.classList.add('swipe-right');
    state.swipeCount++;
    
    const currentProfile = state.swipeProfiles[state.currentProfileIndex];
    state.swipeHistory.push({
        profileIndex: state.currentProfileIndex,
        direction: 'right',
        profile: currentProfile
    });
    
    // Simulate match (50% chance)
    if (Math.random() > 0.5) {
        const matchId = currentProfile.id;
        const existingMatch = state.matches.find(m => m.matchId === matchId);
        
        if (!existingMatch) {
            state.matches.push({
                id: Date.now(),
                userId: state.currentUser?.id || 'demo_user',
                matchId: matchId,
                timestamp: new Date().toISOString(),
                eventId: currentProfile.eventId,
                lastMessage: 'You matched! Say hello!',
                lastMessageTime: 'Just now',
                unread: true,
                unreadCount: 1
            });
            
            showNotification(` You matched with ${currentProfile.name}!`, 'success');
        }
    } else {
        showNotification('Liked!', 'success');
    }
    
    setTimeout(() => {
        state.currentProfileIndex++;
        if (state.currentProfileIndex >= state.swipeProfiles.length) {
            state.currentProfileIndex = 0;
        }
        renderPage();
    }, 500);
    
    saveState();
}

function undoSwipe() {
    if (state.rewindCount <= 0) {
        showNotification('No rewinds left', 'error');
        return;
    }
    
    if (state.swipeHistory.length === 0) {
        showNotification('No swipes to undo', 'info');
        return;
    }
    
    state.rewindCount--;
    const lastSwipe = state.swipeHistory.pop();
    state.currentProfileIndex = lastSwipe.profileIndex;
    
    if (lastSwipe.direction === 'right') {
        state.swipeCount = Math.max(0, state.swipeCount - 1);
    }
    
    showNotification('Undid last swipe', 'info');
    renderPage();
    saveState();
}

function resetSwipes() {
    state.currentProfileIndex = 0;
    showNotification('Swipes reset', 'info');
    renderPage();
}

// ===== CHAT FUNCTIONS =====
function sendChatMessage() {
    const input = document.getElementById('chatInput');
    if (!input || !input.value.trim() || !state.activeChatId) return;
    
    const chatId = `${state.currentUser?.id}_${state.activeChatId}`;
    if (!state.chatMessages[chatId]) {
        state.chatMessages[chatId] = [];
    }
    
    const newMessage = {
        id: Date.now(),
        sender: 'user',
        text: input.value,
        time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
        read: true
    };
    
    state.chatMessages[chatId].push(newMessage);
    
    const match = state.matches.find(m => m.matchId === state.activeChatId);
    if (match) {
        match.lastMessage = input.value;
        match.lastMessageTime = 'Just now';
        match.unread = false;
    }
    
    input.value = '';
    
    // Simulate reply after 1-3 seconds
    setTimeout(() => {
        const replies = [
            "Sounds great!",
            "I agree!",
            "Let's meet up!",
            "What's your favorite part of the event?",
            "Nice to connect with you!"
        ];
        const replyMessage = {
            id: Date.now(),
            sender: 'received',
            text: replies[Math.floor(Math.random() * replies.length)],
            time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
            read: true
        };
        
        state.chatMessages[chatId].push(replyMessage);
        
        if (state.currentPage === 'chat') {
            renderPage();
        }
        
        saveState();
    }, 1000 + Math.random() * 2000);
    
    saveState();
}

// ===== EVENT WIZARD FUNCTIONS =====
function nextWizardStep() {
    if (!validateWizardStep(state.eventWizardData.step)) {
        return;
    }
    
    saveWizardStepData(state.eventWizardData.step);
    state.eventWizardData.step++;
    updateWizardUI();
}

function prevWizardStep() {
    if (state.eventWizardData.step > 1) {
        state.eventWizardData.step--;
        updateWizardUI();
    }
}

function validateWizardStep(step) {
    switch(step) {
        case 1:
            const name = document.getElementById('wizardEventName')?.value;
            const description = document.getElementById('wizardEventDescription')?.value;
            const category = document.getElementById('wizardEventCategory')?.value;
            
            if (!name || !description || !category) {
                showNotification('Please fill in all required fields', 'error');
                return false;
            }
            return true;
            
        case 2:
            const location = document.getElementById('wizardEventLocation')?.value;
            const address = document.getElementById('wizardEventAddress')?.value;
            const date = document.getElementById('wizardEventDate')?.value;
            const time = document.getElementById('wizardEventTime')?.value;
            
            if (!location || !address || !date || !time) {
                showNotification('Please fill in all required fields', 'error');
                return false;
            }
            return true;
            
        default:
            return true;
    }
}

function saveWizardStepData(step) {
    try {
        switch(step) {
            case 1:
                state.eventWizardData.data.name = document.getElementById('wizardEventName')?.value || '';
                state.eventWizardData.data.description = document.getElementById('wizardEventDescription')?.value || '';
                state.eventWizardData.data.category = document.getElementById('wizardEventCategory')?.value || '';
                break;
                
            case 2:
                state.eventWizardData.data.location = document.getElementById('wizardEventLocation')?.value || '';
                state.eventWizardData.data.address = document.getElementById('wizardEventAddress')?.value || '';
                state.eventWizardData.data.date = document.getElementById('wizardEventDate')?.value || '';
                state.eventWizardData.data.time = document.getElementById('wizardEventTime')?.value || '';
                state.eventWizardData.data.capacity = parseInt(document.getElementById('wizardEventCapacity')?.value) || 100;
                break;
                
            case 4:
                state.eventWizardData.data.ticketType = document.getElementById('wizardTicketType')?.value || 'free';
                state.eventWizardData.data.price = parseFloat(document.getElementById('wizardTicketPrice')?.value) || 0;
                state.eventWizardData.data.availableTickets = parseInt(document.getElementById('wizardAvailableTickets')?.value) || 100;
                break;
        }
    } catch (error) {
        console.error('Error saving wizard step data:', error);
    }
}

function updateWizardUI() {
    document.querySelectorAll('.progress-step').forEach((step, index) => {
        const stepNum = index + 1;
        step.classList.remove('active', 'completed');
        
        if (stepNum === state.eventWizardData.step) {
            step.classList.add('active');
        } else if (stepNum < state.eventWizardData.step) {
            step.classList.add('completed');
        }
    });
    
    document.querySelectorAll('.wizard-step').forEach((step, index) => {
        const stepNum = index + 1;
        if (stepNum === state.eventWizardData.step) {
            step.classList.add('active');
        } else {
            step.classList.remove('active');
        }
    });
}

function createEvent() {
    if (!validateWizardStep(4)) {
        return;
    }
    
    saveWizardStepData(4);
    
    const eventData = {
        id: Date.now(),
        name: state.eventWizardData.data.name,
        location: state.eventWizardData.data.location,
        address: state.eventWizardData.data.address,
        date: state.eventWizardData.data.date || 'Tonight',
        time: state.eventWizardData.data.time || '6:00 PM - 11:00 PM',
        attendees: 0,
        maxAttendees: state.eventWizardData.data.capacity,
        description: state.eventWizardData.data.description,
        category: state.eventWizardData.data.category,
        coverImage: `https://images.unsplash.com/photo-${Date.now()}?w=600&h=300&fit=crop`,
        qrCode: `AMPS_${state.eventWizardData.data.category?.replace(/\s+/g, '_').toUpperCase()}_${Date.now()}`,
        radius: state.eventWizardData.data.geofenceRadius,
        organizerId: state.currentUser?.id || 1,
        coordinates: state.eventWizardData.data.coordinates || state.currentLocation,
        price: state.eventWizardData.data.price,
        currency: 'NAD',
        ageRange: '18+',
        genderPreference: 'Everyone',
        tags: [state.eventWizardData.data.category],
        bookmarked: false,
        rsvp: 'none',
        geoFencing: true,
        customTheme: state.eventWizardData.data.themeColor,
        isFeatured: state.organizerEvents.length === 0,
        geofenceRadius: state.eventWizardData.data.geofenceRadius,
        communityPhotos: [],
        comments: []
    };
    
    state.events.push(eventData);
    state.organizerEvents.push(eventData);
    
    // Reset wizard
    state.eventWizardData = {
        step: 1,
        data: {
            name: '',
            description: '',
            category: '',
            location: '',
            address: '',
            date: '',
            time: '',
            capacity: 100,
            ticketType: 'free',
            price: 0,
            availableTickets: 100,
            themeColor: '#8B5CF6',
            geofenceRadius: 100,
            coordinates: null,
            tags: []
        }
    };
    
    closeEventWizard();
    showNotification('Event created successfully! ', 'success');
    
    setTimeout(() => {
        navigateTo('event-management');
    }, 1000);
    
    saveState();
}

function closeEventWizard() {
    const modal = document.querySelector('.event-wizard-modal');
    if (modal) {
        modal.remove();
    }
}

// ===== SUBSCRIPTION PLANS =====
function showSubscriptionPlans() {
    const modal = document.createElement('div');
    modal.className = 'pro-modal';
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <h2>Upgrade Your Experience</h2>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="pricing-grid" style="display: grid; gap: 20px; margin: 30px 0;">
                <!-- FREE PLAN -->
                <div class="pricing-card">
                    <div class="text-center mb-4">
                        <h3 class="text-xl font-bold">Free</h3>
                        <div class="text-3xl font-bold mt-2">$0</div>
                        <p class="text-gray-400 text-sm">per month</p>
                    </div>
                    
                    <ul class="space-y-2 mb-6">
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>10 daily likes</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>3 rewinds per day</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Basic matching</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-times text-gray-500"></i>
                            <span class="text-gray-400">No event creation</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-times text-gray-500"></i>
                            <span class="text-gray-400">No photo uploads</span>
                        </li>
                    </ul>
                    
                    <button class="btn btn-outline btn-block ${!state.isPro && !state.isMax ? 'active' : ''}" onclick="selectPlan('free')">
                        ${!state.isPro && !state.isMax ? 'Current Plan' : 'Select Free'}
                    </button>
                </div>
                
                <!-- PRO PLAN -->
                <div class="pricing-card featured">
                    <div class="text-center mb-4">
                        <div class="pro-badge inline-block mb-2">MOST POPULAR</div>
                        <h3 class="text-xl font-bold">Pro</h3>
                        <div class="text-3xl font-bold mt-2">$9.99</div>
                        <p class="text-gray-400 text-sm">per month</p>
                    </div>
                    
                    <ul class="space-y-2 mb-6">
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Unlimited likes</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Unlimited rewinds</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Advanced filters</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Create events</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Upload photos</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Priority support</span>
                        </li>
                    </ul>
                    
                    <button class="btn btn-pro btn-block" onclick="selectPlan('pro')">
                        ${state.isPro ? 'Current Plan' : 'Upgrade to Pro'}
                    </button>
                </div>
                
                <!-- MAX PLAN -->
                <div class="pricing-card">
                    <div class="text-center mb-4">
                        <div class="pro-plus-badge inline-block mb-2">PREMIUM</div>
                        <h3 class="text-xl font-bold">Max</h3>
                        <div class="text-3xl font-bold mt-2">$19.99</div>
                        <p class="text-gray-400 text-sm">per month</p>
                    </div>
                    
                    <ul class="space-y-2 mb-6">
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Everything in Pro</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>5 super likes per day</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Profile boost</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Advanced analytics</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Dedicated account manager</span>
                        </li>
                        <li class="flex items-center gap-2">
                            <i class="fas fa-check text-green-500"></i>
                            <span>Event promotion credits</span>
                        </li>
                    </ul>
                    
                    <button class="btn btn-pro-plus btn-block" onclick="selectPlan('max')">
                        ${state.isMax ? 'Current Plan' : 'Upgrade to Max'}
                    </button>
                </div>
            </div>
            
            <div class="text-center text-gray-400 text-sm mt-6">
                <p>All plans include basic features. Cancel anytime.</p>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    modal.style.display = 'flex';
}

function selectPlan(plan) {
    if (plan === 'free') {
        state.isPro = false;
        state.isMax = false;
        state.dailyLikes = 10;
        state.rewindCount = 3;
        state.superLikes = 0;
        showNotification('Switched to Free plan', 'info');
    } else if (plan === 'pro') {
        state.isPro = true;
        state.isMax = false;
        state.dailyLikes = Infinity;
        state.rewindCount = Infinity;
        state.superLikes = 1;
        showNotification('Upgraded to Pro plan! ', 'success');
    } else if (plan === 'max') {
        state.isPro = false;
        state.isMax = true;
        state.dailyLikes = Infinity;
        state.rewindCount = Infinity;
        state.superLikes = 5;
        showNotification('Upgraded to Max plan! ', 'success');
    }
    
    if (state.isPro || state.isMax) {
        state.organizerEvents = state.events.filter(e => e.organizerId === (state.currentUser?.id || 1));
    } else {
        state.organizerEvents = [];
    }
    
    saveState();
    closeModal();
    
    if (state.currentPage === 'home') {
        renderPage();
    }
}

// ===== UTILITY FUNCTIONS =====
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    
    const icon = type === 'success' ? 'fa-check-circle' : 
                type === 'error' ? 'fa-exclamation-circle' : 
                type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle';
    
    notification.innerHTML = `
        <i class="fas ${icon}"></i>
        <span>${message}</span>
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        if (notification.parentNode) {
            notification.style.opacity = '0';
            setTimeout(() => {
                if (notification.parentNode) {
                    document.body.removeChild(notification);
                }
            }, 300);
        }
    }, 3000);
}

function formatCurrency(amount, currency) {
    const currencyObj = CURRENCIES.find(c => c.code === currency) || CURRENCIES[0];
    const convertedAmount = amount * currencyObj.conversionRate;
    
    switch(currency) {
        case 'NAD':
            return `N$${convertedAmount.toFixed(2)}`;
        case 'USD':
            return `$${convertedAmount.toFixed(2)}`;
        case 'EUR':
            return `${convertedAmount.toFixed(2)}`;
        case 'GBP':
            return `${convertedAmount.toFixed(2)}`;
        case 'ZAR':
            return `R${convertedAmount.toFixed(2)}`;
        default:
            return `N$${convertedAmount.toFixed(2)}`;
    }
}

function switchTicketTab(tab) {
    document.querySelectorAll('.ticket-tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
    
    document.querySelector(`.ticket-tab[onclick*="${tab}"]`)?.classList.add('active');
    document.getElementById(`${tab}TicketsTab`)?.classList.add('active');
}

function closeModal() {
    document.querySelectorAll('.modal, .event-wizard-modal, .share-modal, .photo-viewer-modal, .checkin-modal, .privacy-choice-modal, .camera-modal, .pro-modal').forEach(modal => {
        if (modal.parentNode) {
            modal.remove();
        }
    });
}

// ===== EVENT HANDLERS =====
function toggleBookmark(eventId) {
    const event = state.events.find(e => e.id === eventId);
    if (event) {
        event.bookmarked = !event.bookmarked;
        if (event.bookmarked) {
            if (!state.userProfile.bookmarkedEvents) {
                state.userProfile.bookmarkedEvents = [];
            }
            if (!state.userProfile.bookmarkedEvents.includes(eventId)) {
                state.userProfile.bookmarkedEvents.push(eventId);
            }
            showNotification('Event bookmarked', 'success');
        } else {
            if (state.userProfile.bookmarkedEvents) {
                state.userProfile.bookmarkedEvents = state.userProfile.bookmarkedEvents.filter(id => id !== eventId);
            }
            showNotification('Event removed from bookmarks', 'info');
        }
        saveState();
        
        if (state.currentPage === 'events' || state.currentPage === 'home') {
            renderPage();
        }
    }
}

function viewEventDetails(eventId) {
    state.currentEvent = state.events.find(e => e.id === eventId);
    navigateTo('event-details');
}

function checkInToEvent(eventId) {
    state.currentEvent = state.events.find(e => e.id === eventId);
    if (state.currentEvent) {
        showNotification(`Checked into ${state.currentEvent.name}`, 'success');
        navigateTo('connect');
    }
}

function openChat(matchId) {
    state.activeChatId = matchId;
    state.chatActive = true;
    navigateTo('chat');
}

function closeChat() {
    state.activeChatId = null;
    state.chatActive = false;
    navigateTo('matches');
}

function openMapFromHome() {
    navigateTo('events');
}

function demoLogin() {
    state.currentUser = {
        id: 'demo_user',
        email: 'demo@amps.com',
        createdAt: new Date().toISOString()
    };
    
    state.matches = [
        {
            id: 1,
            userId: 'demo_user',
            matchId: 2,
            timestamp: new Date().toISOString(),
            eventId: 1,
            lastMessage: 'Hey! How\'s the event?',
            lastMessageTime: '2:15 PM',
            unread: true,
            unreadCount: 1
        },
        {
            id: 2,
            userId: 'demo_user',
            matchId: 5,
            timestamp: new Date(Date.now() - 86400000).toISOString(),
            eventId: 1,
            lastMessage: 'Great meeting you!',
            lastMessageTime: 'Yesterday',
            unread: false,
            unreadCount: 0
        }
    ];
    
    state.chatMessages = {
        'demo_user_2': [
            {
                id: 1,
                sender: 'received',
                text: 'Hey! Loved your profile. Are you enjoying the event?',
                time: '7:45 PM',
                read: true
            },
            {
                id: 2,
                sender: 'user',
                text: 'Yes, it\'s amazing! The speakers are incredible.',
                time: '7:46 PM',
                read: true
            },
            {
                id: 3,
                sender: 'received',
                text: 'We should meet up at the networking session!',
                time: '7:47 PM',
                read: true
            }
        ]
    };
    
    state.isPro = true;
    state.dailyLikes = Infinity;
    state.superLikes = 5;
    state.rewindCount = Infinity;
    
    state.organizerEvents = state.events.filter(e => e.organizerId === 1);
    
    showNotification('Demo mode activated! Explore all features.', 'success');
    navigateTo('home');
    saveState();
}

function logout() {
    state.currentUser = null;
    state.currentPage = 'landing';
    showNotification('Successfully signed out', 'info');
    renderPage();
    updateNavigation();
    saveState();
}

function switchAuthTab(tab) {
    const loginTab = document.getElementById('loginTab');
    const signupTab = document.getElementById('signupTab');
    const signupFields = document.getElementById('signupFields');
    const authSubmit = document.getElementById('authSubmit');
    
    if (tab === 'login') {
        loginTab.classList.add('active');
        signupTab.classList.remove('active');
        signupFields.classList.add('hidden');
        authSubmit.innerHTML = '<i class="fas fa-sign-in-alt"></i> Sign In';
    } else {
        loginTab.classList.remove('active');
        signupTab.classList.add('active');
        signupFields.classList.remove('hidden');
        authSubmit.innerHTML = '<i class="fas fa-user-plus"></i> Sign Up';
    }
}

function handleAuth(event) {
    event.preventDefault();
    
    const email = document.getElementById('authEmail').value;
    const password = document.getElementById('authPassword').value;
    
    if (!email || !password) {
        showNotification('Please fill in all fields', 'error');
        return;
    }
    
    state.currentUser = {
        id: 'user_' + Date.now(),
        email: email,
        createdAt: new Date().toISOString()
    };
    
    showNotification('Successfully signed in!', 'success');
    navigateTo('home');
    saveState();
}

// ===== SEARCH FUNCTIONS =====
function handleEventSearchInput(event) {
    const query = event.target.value;
    state.eventSearchQuery = query;
    
    if (state.searchTimer) {
        clearTimeout(state.searchTimer);
    }
    
    if (query.length > 2) {
        state.searchSuggestions = getSearchSuggestions(query);
        updateSearchSuggestions();
    } else {
        state.searchSuggestions = [];
        updateSearchSuggestions();
    }
}

function performEventSearch() {
    const query = state.eventSearchQuery.trim();
    if (!query) return;
    
    const input = document.getElementById('eventSearchInput');
    if (input) input.blur();
    
    const matchingEvent = state.events.find(e => 
        e.name.toLowerCase().includes(query.toLowerCase()) ||
        e.location.toLowerCase().includes(query.toLowerCase()) ||
        e.tags.some(tag => tag.toLowerCase().includes(query.toLowerCase()))
    );
    
    if (matchingEvent) {
        showNotification(`Found: ${matchingEvent.name}`, 'success');
    } else {
        showNotification('No events found for your search', 'info');
    }
    
    state.searchSuggestions = [];
    updateSearchSuggestions();
}

function getSearchSuggestions(query) {
    const suggestions = new Set();
    const lowerQuery = query.toLowerCase();
    
    state.events.forEach(event => {
        if (event.name.toLowerCase().includes(lowerQuery)) {
            suggestions.add(event.name);
        }
        if (event.location.toLowerCase().includes(lowerQuery)) {
            suggestions.add(event.location);
        }
    });
    
    const allTags = new Set();
    state.events.forEach(event => {
        event.tags.forEach(tag => {
            if (tag.toLowerCase().includes(lowerQuery)) {
                allTags.add(tag);
            }
        });
    });
    
    return Array.from(suggestions).slice(0, 5);
}

function updateSearchSuggestions() {
    const suggestionsContainer = document.getElementById('searchSuggestions');
    if (suggestionsContainer) {
        if (state.searchSuggestions.length > 0) {
            suggestionsContainer.classList.add('active');
        } else {
            suggestionsContainer.classList.remove('active');
        }
    }
}

function selectSearchSuggestion(suggestion) {
    state.eventSearchQuery = suggestion;
    const input = document.getElementById('eventSearchInput');
    if (input) {
        input.value = suggestion;
        input.blur();
    }
    performEventSearch();
}

function clearEventSearch() {
    state.eventSearchQuery = '';
    state.searchSuggestions = [];
    if (state.currentPage === 'events') {
        renderPage();
    }
}

function filterEventsBySearch() {
    if (!state.eventSearchQuery) return state.events;
    
    const query = state.eventSearchQuery.toLowerCase();
    return state.events.filter(event => 
        event.name.toLowerCase().includes(query) ||
        event.location.toLowerCase().includes(query) ||
        event.tags.some(tag => tag.toLowerCase().includes(query)) ||
        event.category.toLowerCase().includes(query)
    );
}

// ===== NAVIGATION =====
function updateNavigation() {
    let navbar = document.querySelector('.navbar');
    
    if (!navbar) {
        navbar = document.createElement('nav');
        navbar.className = 'navbar';
        document.getElementById('app').insertBefore(navbar, document.getElementById('content'));
    }
    
    let navHTML = `
        <div class="nav-brand" onclick="${state.currentUser ? 'navigateTo(\'home\')' : 'navigateTo(\'landing\')'}">
            <i class="fas fa-bolt"></i>
            <span class="amp">Amps</span>
        </div>
        <div class="nav-actions">
    `;
    
    if (state.currentPage === 'landing') {
        navHTML += `
            <button class="btn btn-outline btn-small" onclick="navigateTo('auth')">
                <i class="fas fa-sign-in-alt"></i> Sign In
            </button>
        `;
    } else if (state.currentPage === 'home') {
        navHTML += `
            <button class="btn btn-outline btn-small" onclick="showNotifications()">
                <i class="fas fa-bell"></i>
                ${state.notifications.filter(n => !n.read).length > 0 ? 
                    `<span class="notification-badge">${state.notifications.filter(n => !n.read).length}</span>` : ''}
            </button>
        `;
    } else if (state.currentPage === 'event-details' || state.currentPage === 'chat') {
        navHTML += `
            <button class="back-btn" onclick="goBack()">
                <i class="fas fa-arrow-left"></i>
            </button>
        `;
    } else if (state.currentPage !== 'events' && state.currentPage !== 'landing' && state.currentPage !== 'auth') {
        navHTML += `
            <button class="back-btn" onclick="goBack()">
                <i class="fas fa-arrow-left"></i>
            </button>
        `;
    }
    
    navHTML += `</div>`;
    
    navbar.innerHTML = navHTML;
    
    // Update bottom nav
    const bottomNav = document.getElementById('bottomNav');
    if (state.currentUser && ['home', 'events', 'connect', 'matches', 'profile'].includes(state.currentPage)) {
        const unreadCount = state.matches.filter(m => m.unread).length;
        bottomNav.innerHTML = `
            <div class="bottom-nav">
                <button class="nav-item ${state.currentPage === 'home' ? 'active' : ''}" onclick="navigateTo('home')">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </button>
                <button class="nav-item ${state.currentPage === 'events' ? 'active' : ''}" onclick="navigateTo('events')">
                    <i class="fas fa-calendar"></i>
                    <span>Events</span>
                </button>
                <button class="nav-item ${state.currentPage === 'connect' ? 'active' : ''}" onclick="navigateTo('connect')">
                    <i class="fas fa-users"></i>
                    <span>Connect</span>
                </button>
                <button class="nav-item ${state.currentPage === 'matches' ? 'active' : ''}" onclick="navigateTo('matches')">
                    <i class="fas fa-heart"></i>
                    <span>Matches${unreadCount > 0 ? `<span class="notification-badge">${unreadCount}</span>` : ''}</span>
                </button>
                <button class="nav-item ${state.currentPage === 'profile' ? 'active' : ''}" onclick="navigateTo('profile')">
                    <i class="fas fa-user"></i>
                    <span>Profile</span>
                </button>
            </div>
        `;
    } else {
        bottomNav.innerHTML = '';
    }
}

// ===== MAP FUNCTIONS =====
function initMap() {
    if (!mapboxgl || !MAPBOX_TOKEN) {
        console.error('Mapbox not loaded or token missing');
        return;
    }
    
    try {
        mapboxgl.accessToken = MAPBOX_TOKEN;
        
        state.map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/dark-v11',
            center: [state.currentLocation.lng, state.currentLocation.lat],
            zoom: 12
        });
        
        // Add user location marker
        new mapboxgl.Marker({ color: '#10B981' })
            .setLngLat([state.currentLocation.lng, state.currentLocation.lat])
            .addTo(state.map);
        
        // Add event markers
        state.events.forEach(event => {
            const el = document.createElement('div');
            el.className = 'event-marker';
            el.innerHTML = `<i class="fas fa-map-marker-alt"></i>`;
            el.style.color = event.customTheme || '#8B5CF6';
            el.style.cursor = 'pointer';
            el.style.fontSize = '24px';
            
            el.addEventListener('click', () => {
                viewEventDetails(event.id);
            });
            
            new mapboxgl.Marker(el)
                .setLngLat([event.coordinates.lng, event.coordinates.lat])
                .addTo(state.map);
        });
        
    } catch (error) {
        console.error('Failed to initialize map:', error);
    }
}

// ===== HELPER FUNCTIONS =====
function calculateProfileCompleteness() {
    let completeness = 0;
    const fields = [
        state.userProfile.name,
        state.userProfile.bio,
        state.userProfile.occupation,
        state.userProfile.location,
        state.userProfile.interests.length > 0
    ];
    
    fields.forEach(field => {
        if (field && (typeof field !== 'boolean' || field === true)) {
            completeness += 20;
        }
    });
    
    return Math.min(100, completeness);
}

function toggleTicketQR(ticketId) {
    const ticket = state.tickets.find(t => t.id === ticketId);
    if (ticket) {
        ticket.showQr = !ticket.showQr;
        saveState();
        if (state.currentPage === 'ticket-box') {
            renderPage();
        }
    }
}

// ===== INITIALIZE APP =====
document.addEventListener('DOMContentLoaded', init);

// Handle resize
window.addEventListener('resize', () => {
    if (state.map) {
        state.map.resize();
    }
});

// Global error handler
window.addEventListener('error', function(e) {
    console.error('Global error:', e.error);
});

// Export for debugging
window.appState = state;
</script>
    </body>
</html>
