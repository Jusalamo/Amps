<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <title>SparkPlug | Meet People at Events in Real Time</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" id="manifest">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SparkPlug">
    
    <style>
        /* ===== BASE STYLES ===== */
        :root {
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-tertiary: #161616;
            --bg-card: rgba(30, 30, 30, 0.9);
            --bg-glass: rgba(255, 255, 255, 0.05);
            --primary: #871af4;
            --primary-light: #a855f7;
            --primary-dark: #6a0dad;
            --primary-glow: rgba(135, 26, 244, 0.3);
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --accent-yellow: #f59e0b;
            --accent-pink: #ffc0d9;
            --accent-gold: #f5deb3;
            --pro-gradient: linear-gradient(135deg, #871af4, #ff6b6b);
            
            --white: #ffffff;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #8E8E93;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1C1C1E;
            --gray-900: #2C2C2E;
            
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.5);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.6), 0 10px 10px -5px rgba(0, 0, 0, 0.4);
            --shadow-glow: 0 0 30px rgba(135, 26, 244, 0.4);
            --shadow-card: 0 20px 60px rgba(0, 0, 0, 0.4), 0 8px 24px rgba(0, 0, 0, 0.3);
            
            --radius-sm: 8px;
            --radius: 12px;
            --radius-md: 16px;
            --radius-lg: 20px;
            --radius-xl: 24px;
            --radius-2xl: 28px;
            --radius-full: 9999px;
            
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
            
            --header-height: 64px;
            --bottom-nav-height: 65px;
            --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg-primary);
            color: var(--white);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
            min-height: 100vh;
            padding-bottom: calc(var(--bottom-nav-height) + var(--safe-area-inset-bottom));
        }
        
        .app {
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--bg-primary);
            position: relative;
            overflow: hidden;
        }
        
        /* ===== DECORATIVE BACKGROUNDS ===== */
        .hero-bg {
            position: absolute;
            inset: 0;
            opacity: 0.08;
            pointer-events: none;
            z-index: 0;
        }
        
        .for-you-bg {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%) translateY(-40px);
            font-size: clamp(80px, 15vw, 180px);
            font-weight: 700;
            color: #3A3A3C;
            opacity: 0.08;
            letter-spacing: 0.05em;
            white-space: nowrap;
            pointer-events: none;
            z-index: 0;
        }
        
        /* ===== TYPOGRAPHY ===== */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
        }
        
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--white) 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        h2 {
            font-size: 1.875rem;
        }
        
        h3 {
            font-size: 1.25rem;
        }
        
        .text-gradient {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .pro-gradient {
            background: var(--pro-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* ===== BUTTONS ===== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border-radius: var(--radius-xl);
            font-weight: 600;
            font-size: 14px;
            text-decoration: none;
            cursor: pointer;
            border: none;
            transition: all var(--transition);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .btn-primary {
            background: var(--primary);
            color: var(--white);
            box-shadow: var(--shadow-glow);
        }
        
        .btn-primary:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow), 0 8px 25px rgba(135, 26, 244, 0.3);
        }
        
        .btn-pro {
            background: var(--pro-gradient);
            color: var(--white);
            box-shadow: 0 0 30px rgba(255, 107, 107, 0.3);
        }
        
        .btn-pro:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 40px rgba(255, 107, 107, 0.4);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--white);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .btn-glass {
            background: var(--bg-glass);
            color: var(--white);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
        }
        
        .btn-glass:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .btn-large {
            padding: 16px 32px;
            font-size: 16px;
        }
        
        .btn-small {
            padding: 8px 16px;
            font-size: 12px;
        }
        
        .btn-block {
            width: 100%;
        }
        
        .btn-icon {
            width: 48px;
            height: 48px;
            padding: 0;
            border-radius: var(--radius-full);
            font-size: 20px;
        }
        
        /* ===== NAVIGATION ===== */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            height: var(--header-height);
            background: rgba(0, 0, 0, 0.9);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            backdrop-filter: blur(20px);
            max-width: 480px;
            margin: 0 auto;
        }
        
        .nav-brand {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 24px;
            font-weight: 800;
            cursor: pointer;
        }
        
        .nav-brand .spark {
            color: var(--primary-light);
        }
        
        .nav-brand .plug {
            color: var(--white);
        }
        
        .nav-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .back-btn {
            background: none;
            border: none;
            color: var(--white);
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: var(--radius-full);
            transition: background var(--transition-fast);
        }
        
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* ===== BOTTOM NAVIGATION ===== */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: calc(var(--bottom-nav-height) + var(--safe-area-inset-bottom));
            background: rgba(0, 0, 0, 0.98);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding-bottom: var(--safe-area-inset-bottom);
            z-index: 999;
            max-width: 480px;
            margin: 0 auto;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            padding: 12px;
            background: none;
            border: none;
            color: var(--gray-400);
            font-size: 12px;
            transition: all var(--transition-fast);
            flex: 1;
            height: 100%;
        }
        
        .nav-item.active {
            color: var(--primary);
        }
        
        .nav-item i {
            font-size: 20px;
        }
        
        /* ===== CONTENT CONTAINER ===== */
        .content {
            padding: calc(var(--header-height) + 20px) 20px 20px;
            min-height: 100vh;
        }
        
        /* ===== CARD COMPONENTS ===== */
        .card {
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-2xl);
            padding: 24px;
            backdrop-filter: blur(20px);
            transition: all var(--transition);
        }
        
        .card:hover {
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .card-glass {
            background: var(--bg-glass);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-2xl);
            padding: 24px;
            backdrop-filter: blur(20px);
        }
        
        /* ===== PRO BADGES ===== */
        .pro-badge {
            background: var(--pro-gradient);
            color: white;
            padding: 6px 16px;
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .free-badge {
            background: var(--bg-tertiary);
            color: var(--gray-400);
            padding: 6px 16px;
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        /* ===== LANDING PAGE ===== */
        .hero {
            text-align: center;
            padding: 40px 0;
            position: relative;
            z-index: 1;
        }
        
        .hero h1 {
            font-size: 3rem;
            margin-bottom: 20px;
            line-height: 1.1;
        }
        
        .hero-subtitle {
            font-size: 1.25rem;
            margin-bottom: 40px;
            color: var(--gray-400);
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 60px 0;
        }
        
        .feature {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-2xl);
            padding: 24px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all var(--transition);
        }
        
        .feature:hover {
            border-color: var(--primary);
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow);
        }
        
        .feature-icon {
            width: 56px;
            height: 56px;
            background: rgba(135, 26, 244, 0.2);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 24px;
            color: var(--primary-light);
        }
        
        .cta-grid {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin: 40px 0;
        }
        
        /* ===== EVENTS SECTION ===== */
        .events-section {
            padding: 60px 0;
        }
        
        .events-grid {
            display: grid;
            gap: 16px;
            margin-top: 24px;
        }
        
        .event-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-2xl);
            padding: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all var(--transition);
        }
        
        .event-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }
        
        .event-info {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--gray-400);
            font-size: 14px;
            margin: 8px 0;
        }
        
        /* ===== AUTH PAGE ===== */
        .auth-container {
            max-width: 400px;
            margin: 0 auto;
            padding: 40px 0;
        }
        
        .auth-tabs {
            display: flex;
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            padding: 4px;
            margin-bottom: 32px;
        }
        
        .auth-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: none;
            border: none;
            color: var(--gray-400);
            font-weight: 600;
            cursor: pointer;
            border-radius: var(--radius-sm);
            transition: all var(--transition-fast);
        }
        
        .auth-tab.active {
            background: var(--primary);
            color: var(--white);
        }
        
        .form-group {
            margin-bottom: 24px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--gray-300);
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 14px 16px;
            background: var(--bg-tertiary);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-xl);
            color: var(--white);
            font-size: 16px;
            transition: all var(--transition-fast);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-glow);
        }
        
        /* ===== DASHBOARD ===== */
        .profile-header {
            text-align: center;
            margin-bottom: 32px;
        }
        
        .avatar {
            width: 100px;
            height: 100px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            margin: 0 auto 16px;
            position: relative;
            overflow: hidden;
            border: 3px solid var(--bg-primary);
        }
        
        .avatar.pro {
            border: 3px solid transparent;
            border-image: var(--pro-gradient) 1;
        }
        
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin: 32px 0;
        }
        
        .action-card {
            background: var(--bg-card);
            border-radius: var(--radius-2xl);
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: all var(--transition);
        }
        
        .action-card:hover {
            border-color: var(--primary);
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow);
        }
        
        .action-card i {
            font-size: 32px;
            color: var(--primary);
            margin-bottom: 12px;
        }
        
        /* ===== SWIPE INTERFACE ===== */
        .swipe-interface {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }
        
        .swipe-header {
            padding: 20px;
            text-align: center;
            z-index: 50;
        }
        
        .event-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: var(--radius-full);
            font-size: 14px;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .card-stack {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }
        
        .card-container {
            width: 100%;
            max-width: 280px;
            aspect-ratio: 3/4;
            position: relative;
        }
        
        .profile-card {
            position: absolute;
            width: 100%;
            height: 100%;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s;
            cursor: grab;
            z-index: 1;
        }
        
        .profile-card:active {
            cursor: grabbing;
        }
        
        .live-photo-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            background: var(--accent-green);
            color: white;
            padding: 8px 16px;
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
            z-index: 10;
        }
        
        .card-content {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: var(--radius-2xl);
            overflow: hidden;
            box-shadow: var(--shadow-card);
        }
        
        .profile-image {
            width: 85%;
            aspect-ratio: 1/1;
            margin: 24px auto 0;
            border-radius: var(--radius-xl);
            background: linear-gradient(45deg, var(--bg-secondary), var(--bg-tertiary));
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            background-size: cover;
            background-position: center;
        }
        
        .profile-info {
            padding: 24px;
            text-align: center;
        }
        
        .profile-info h2 {
            font-size: 1.5rem;
            margin-bottom: 4px;
            color: var(--white);
        }
        
        .profile-info p {
            font-size: 14px;
            color: var(--gray-300);
            margin-bottom: 16px;
            line-height: 1.4;
        }
        
        .interests {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
        }
        
        .interest-tag {
            font-size: 12px;
            padding: 6px 12px;
            border-radius: var(--radius-full);
            background: rgba(255, 255, 255, 0.08);
            color: var(--gray-300);
        }
        
        .swipe-actions {
            padding: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
            z-index: 50;
        }
        
        .action-button {
            width: 72px;
            height: 72px;
            border-radius: var(--radius-full);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.2s;
            background: var(--gray-900);
            color: var(--white);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }
        
        .action-button:hover {
            transform: scale(1.05);
        }
        
        .action-button:active {
            transform: scale(0.95);
        }
        
        .action-button.undo {
            width: 64px;
            height: 64px;
            font-size: 20px;
            background: var(--gray-400);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
        }
        
        .action-button.like {
            width: 80px;
            height: 80px;
            background: var(--accent-pink);
            color: var(--gray-800);
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(255, 192, 217, 0.5);
        }
        
        .action-button.like:hover {
            transform: scale(1.1);
        }
        
        /* ===== MATCH MODAL ===== */
        .match-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
        }
        
        .match-content {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            border-radius: var(--radius-2xl);
            padding: 48px 32px;
            text-align: center;
            max-width: 320px;
            width: 90%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: modalAppear 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .match-images {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .match-avatar {
            width: 96px;
            height: 96px;
            border-radius: var(--radius-full);
            border: 4px solid var(--primary);
            box-shadow: var(--shadow-lg);
        }
        
        /* ===== SCANNER PAGE ===== */
        .scanner-container {
            text-align: center;
            padding: 20px 0;
        }
        
        .qr-scanner {
            width: 100%;
            height: 300px;
            background: var(--bg-secondary);
            border-radius: var(--radius-2xl);
            margin: 24px 0;
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .scanner-overlay {
            position: absolute;
            inset: 20px;
            border: 2px solid var(--primary);
            border-radius: var(--radius);
            animation: pulse 2s infinite;
        }
        
        .scanner-line {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            height: 2px;
            background: var(--primary);
            box-shadow: 0 0 10px var(--primary);
            animation: scan 3s infinite linear;
        }
        
        /* ===== CAMERA MODAL ===== */
        .camera-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
        }
        
        .camera-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            background: #000;
        }
        
        .camera-preview {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        .camera-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .camera-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 250px;
            height: 250px;
            border: 3px solid white;
            border-radius: var(--radius-lg);
            box-shadow: 0 0 0 1000px rgba(0, 0, 0, 0.7);
        }
        
        .camera-controls {
            padding: 20px;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
        }
        
        .camera-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            color: black;
        }
        
        /* ===== CHAT PAGE ===== */
        .chat-container {
            height: calc(100vh - var(--header-height) - var(--bottom-nav-height));
            display: flex;
            flex-direction: column;
        }
        
        .chat-header {
            padding: 16px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--bg-secondary);
        }
        
        .chat-avatar {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .message {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            position: relative;
            animation: messageAppear 0.3s ease;
        }
        
        .message.sent {
            background: var(--primary);
            color: var(--white);
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }
        
        .message.received {
            background: var(--bg-tertiary);
            color: var(--white);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }
        
        .message-time {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 4px;
            text-align: right;
        }
        
        .chat-input {
            padding: 16px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            gap: 12px;
            background: var(--bg-secondary);
        }
        
        /* ===== CREATE EVENT ===== */
        .create-form {
            max-width: 400px;
            margin: 0 auto;
        }
        
        .qr-code-display {
            width: 200px;
            height: 200px;
            background: var(--white);
            border-radius: var(--radius);
            margin: 24px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: var(--bg-primary);
            font-weight: bold;
            text-align: center;
            padding: 20px;
        }
        
        /* ===== PRO UPGRADE MODAL ===== */
        .pro-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(10px);
        }
        
        .pro-content {
            background: var(--bg-card);
            border-radius: var(--radius-2xl);
            padding: 32px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: modalAppear 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* ===== ATTENDEE LIST ===== */
        .attendee-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }
        
        .attendee-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .attendee-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-size: cover;
            background-position: center;
            border: 2px solid var(--primary);
        }
        
        .attendee-info {
            flex: 1;
        }
        
        .attendee-status {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
        }
        
        .status-online {
            color: var(--accent-green);
        }
        
        .status-away {
            color: var(--accent-yellow);
        }
        
        /* ===== NOTIFICATION ===== */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 12px 20px;
            border-radius: var(--radius-lg);
            background: var(--primary);
            color: var(--white);
            font-weight: 500;
            z-index: 3000;
            animation: slideIn 0.3s ease-out;
            max-width: 300px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* ===== ANIMATIONS ===== */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes scan {
            0% { top: 20px; }
            50% { top: calc(100% - 22px); }
            100% { top: 20px; }
        }
        
        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        @keyframes messageAppear {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* ===== UTILITY CLASSES ===== */
        .text-center { text-align: center; }
        .mt-1 { margin-top: 4px; }
        .mt-2 { margin-top: 8px; }
        .mt-3 { margin-top: 16px; }
        .mt-4 { margin-top: 24px; }
        .mt-5 { margin-top: 32px; }
        .mb-1 { margin-bottom: 4px; }
        .mb-2 { margin-bottom: 8px; }
        .mb-3 { margin-bottom: 16px; }
        .mb-4 { margin-bottom: 24px; }
        .mb-5 { margin-bottom: 32px; }
        .hidden { display: none !important; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 8px; }
        .gap-3 { gap: 12px; }
        .gap-4 { gap: 16px; }
        .gap-5 { gap: 20px; }
        .w-full { width: 100%; }
        .cursor-pointer { cursor: pointer; }
        .relative { position: relative; }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 480px) {
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .content {
                padding: calc(var(--header-height) + 16px) 16px 16px;
            }
            
            .navbar {
                padding: 0 16px;
            }
        }
        
        @supports (padding: max(0px)) {
            .bottom-nav {
                padding-bottom: max(var(--safe-area-inset-bottom), 20px);
            }
        }
    </style>
</head>
<body>
    <div class="app" id="app">
        <!-- Navigation will be injected here -->
        <div class="content" id="content">
            <!-- Content will be dynamically loaded here -->
        </div>
        
        <!-- Bottom Navigation will be injected here -->
        <div id="bottomNav"></div>
    </div>

    <!-- Camera Modal -->
    <div class="camera-modal" id="cameraModal">
        <div class="camera-container">
            <div class="camera-preview">
                <video class="camera-video" id="cameraVideo" autoplay playsinline></video>
                <div class="camera-overlay"></div>
                <div class="live-photo-badge">
                    <i class="fas fa-camera"></i>
                    <span>LIVE PHOTO</span>
                </div>
            </div>
            <div class="camera-controls">
                <button class="btn btn-danger" onclick="closeCamera()">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="camera-btn" onclick="takePhoto()">
                    <i class="fas fa-camera"></i>
                </button>
                <button class="btn btn-glass" onclick="switchCamera()">
                    <i class="fas fa-sync-alt"></i> Flip
                </button>
            </div>
        </div>
    </div>

    <!-- Pro Upgrade Modal -->
    <div class="pro-modal" id="proModal">
        <div class="pro-content">
            <div class="text-center mb-6">
                <div class="pro-badge mb-4" style="font-size: 14px; padding: 8px 16px;">
                    <i class="fas fa-crown"></i>
                    <span>PRO UPGRADE</span>
                </div>
                <h2 class="pro-gradient">Unlock Premium Features</h2>
                <p class="mt-2">Get unlimited swipes, create events, and more!</p>
            </div>

            <div class="flex flex-col gap-4 mb-6">
                <div class="card-glass">
                    <h4 class="mb-2">Unlimited Daily Swipes</h4>
                    <p class="text-gray-400">Free users limited to 10 swipes/day</p>
                </div>
                
                <div class="card-glass">
                    <h4 class="mb-2">Create Unlimited Events</h4>
                    <p class="text-gray-400">Free users cannot create events</p>
                </div>
                
                <div class="card-glass">
                    <h4 class="mb-2">Advanced Analytics</h4>
                    <p class="text-gray-400">Track event performance in real-time</p>
                </div>
                
                <div class="card-glass">
                    <h4 class="mb-2">Priority Support</h4>
                    <p class="text-gray-400">Get help faster with priority support</p>
                </div>
            </div>

            <!-- Namibia-friendly payment options -->
            <div class="mb-6">
                <h4 class="mb-4 text-center">Choose Payment Method</h4>
                <div class="flex flex-col gap-3">
                    <button class="btn btn-outline" onclick="initiatePayPalPayment()">
                        <i class="fab fa-paypal"></i> PayPal
                    </button>
                    <button class="btn btn-outline" onclick="showMobileMoneyOptions()">
                        <i class="fas fa-mobile-alt"></i> Mobile Money
                    </button>
                    <button class="btn btn-outline" onclick="showBankTransfer()">
                        <i class="fas fa-university"></i> Bank Transfer
                    </button>
                    <button class="btn btn-outline" onclick="showCryptoOptions()">
                        <i class="fas fa-coins"></i> Cryptocurrency
                    </button>
                </div>
            </div>

            <div class="text-center text-gray-400 text-sm">
                <p>All payments are secure and encrypted</p>
                <p class="mt-1">30-day money back guarantee</p>
            </div>
            
            <button class="btn btn-glass btn-block mt-4" onclick="closeProModal()">
                Maybe Later
            </button>
        </div>
    </div>

    <!-- Match Modal -->
    <div class="match-modal" id="matchModal">
        <div class="match-content">
            <div class="match-images">
                <div class="match-avatar" id="userAvatar"></div>
                <div class="flex items-center">
                    <i class="fas fa-bolt" style="font-size: 32px; color: var(--primary);"></i>
                </div>
                <div class="match-avatar" id="matchAvatar"></div>
            </div>
            <h2>It's a Match! âš¡</h2>
            <p class="mt-2" id="matchMessage"></p>
            <div class="flex flex-col gap-3 mt-4">
                <button class="btn btn-primary" onclick="startChat()">
                    <i class="fas fa-comment"></i> Say Hi
                </button>
                <button class="btn btn-outline" onclick="closeMatchModal()">
                    Keep Swiping
                </button>
            </div>
        </div>
    </div>

    <script>
        // ===== MOCK DATA =====
        const MOCK_PROFILES = [
            {
                id: 1,
                name: 'Katrin',
                age: 23,
                bio: 'Live, Trained As A Dance, Teacher, Gymnast And Acrobat',
                interests: ['Dance', 'Fitness', 'Art', 'Music'],
                eventId: 1,
                location: 'Main Stage',
                online: true,
                verified: true,
                livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23C4B5FD"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">Live Photo</text></svg>'
            },
            {
                id: 2,
                name: 'Alex',
                age: 25,
                bio: 'Product Designer Who Loves Coffee And Indie Music',
                interests: ['Design', 'Music', 'Coffee', 'Art'],
                eventId: 1,
                location: 'Bar Area',
                online: true,
                verified: true,
                livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23FFC0D9"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">Live Photo</text></svg>'
            },
            {
                id: 3,
                name: 'Jordan',
                age: 27,
                bio: 'Startup Founder, Always Down For Deep Conversations',
                interests: ['Tech', 'Philosophy', 'Hiking', 'Sustainability'],
                eventId: 1,
                location: 'Lounge',
                online: false,
                verified: true,
                livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23BAE6FD"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">Live Photo</text></svg>'
            },
            {
                id: 4,
                name: 'Sam',
                age: 26,
                bio: 'Marketing Manager Who Travels Frequently. Foodie Always Looking For The Next Great Restaurant',
                interests: ['Travel', 'Food', 'Photography', 'Wine'],
                eventId: 1,
                location: 'Food Court',
                online: true,
                verified: false,
                livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23BBF7D0"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">Live Photo</text></svg>'
            },
            {
                id: 5,
                name: 'Taylor',
                age: 24,
                bio: 'Software Engineer By Day, DJ By Night. Loves Electronic Music',
                interests: ['Music', 'Tech', 'Dancing', 'Festivals'],
                eventId: 1,
                location: 'DJ Booth',
                online: true,
                verified: true,
                livePhoto: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><rect width="200" height="200" fill="%23FECACA"/><text x="100" y="110" font-size="24" text-anchor="middle" fill="white">Live Photo</text></svg>'
            }
        ];

        const MOCK_EVENTS = [
            {
                id: 1,
                name: 'Tech Mixer 2024',
                location: 'The Mill, San Francisco',
                date: 'Tonight',
                time: '7:00 PM - 11:00 PM',
                attendees: 23,
                maxAttendees: 50,
                description: 'Tech networking event',
                qrCode: 'EVENT_TECH_2024',
                radius: 100,
                organizerId: 1,
                coordinates: { lat: 37.7749, lng: -122.4194 }
            },
            {
                id: 2,
                name: 'Art Gallery Opening',
                location: 'Modern Art Space',
                date: 'Tomorrow',
                time: '6:00 PM - 10:00 PM',
                attendees: 15,
                maxAttendees: 40,
                description: 'Contemporary art exhibition',
                qrCode: 'EVENT_ART_2024',
                radius: 80,
                organizerId: 2,
                coordinates: { lat: 37.7833, lng: -122.4167 }
            }
        ];

        // ===== APP STATE =====
        let state = {
            currentUser: null,
            currentPage: 'home',
            currentEvent: null,
            swipeCount: 0,
            lastSwipeReset: new Date().toDateString(),
            isPro: false,
            matches: [],
            events: [...MOCK_EVENTS],
            attendees: [...MOCK_PROFILES],
            cameraStream: null,
            facingMode: 'user',
            history: ['home'],
            currentProfileIndex: 0,
            swipeHistory: [],
            lastMatch: null,
            notification: null,
            chatMessages: {},
            userLivePhoto: null
        };

        // ===== ROUTER =====
        function navigateTo(page) {
            state.history.push(state.currentPage);
            state.currentPage = page;
            renderPage();
            updateNavigation();
            window.scrollTo(0, 0);
        }

        function goBack() {
            if (state.history.length > 1) {
                const previousPage = state.history.pop();
                state.currentPage = state.history.pop() || 'home';
                renderPage();
                updateNavigation();
            }
        }

        // ===== PAGE RENDERERS =====
        function renderPage() {
            const content = document.getElementById('content');
            
            switch(state.currentPage) {
                case 'home':
                    renderHomePage(content);
                    break;
                case 'auth':
                    renderAuthPage(content);
                    break;
                case 'dashboard':
                    renderDashboardPage(content);
                    break;
                case 'scanner':
                    renderScannerPage(content);
                    break;
                case 'swipe':
                    renderSwipePage(content);
                    break;
                case 'chat':
                    renderChatPage(content);
                    break;
                case 'events':
                    renderEventsPage(content);
                    break;
                case 'matches':
                    renderMatchesPage(content);
                    break;
                case 'profile':
                    renderProfilePage(content);
                    break;
                case 'create-event':
                    renderCreateEventPage(content);
                    break;
                case 'manage-event':
                    renderManageEventPage(content);
                    break;
                case 'event-detail':
                    renderEventDetailPage(content);
                    break;
                default:
                    renderHomePage(content);
            }
        }

        function updateNavigation() {
            const navbar = document.querySelector('.navbar') || document.createElement('nav');
            navbar.className = 'navbar';
            
            let navHTML = `
                <div class="nav-brand" onclick="navigateTo('home')">
                    <i class="fas fa-bolt"></i>
                    <span class="spark">Spark</span><span class="plug">Plug</span>
                </div>
                <div class="nav-actions">
            `;
            
            if (state.currentPage === 'home') {
                if (state.currentUser) {
                    navHTML += `
                        <button class="btn btn-outline btn-small" onclick="showMenuModal()">
                            Menu
                        </button>
                    `;
                } else {
                    navHTML += `
                        <button class="btn btn-outline btn-small" onclick="navigateTo('auth')">
                            Log In
                        </button>
                    `;
                }
            } else if (['dashboard', 'scanner', 'swipe', 'chat', 'create-event', 'auth', 'events', 'matches', 'profile', 'manage-event', 'event-detail'].includes(state.currentPage)) {
                navHTML += `
                    <button class="back-btn" onclick="goBack()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                `;
            }
            
            navHTML += `</div>`;
            
            if (!document.querySelector('.navbar')) {
                document.getElementById('app').insertBefore(navbar, document.getElementById('content'));
            }
            navbar.innerHTML = navHTML;
            
            // Update bottom nav
            const bottomNav = document.getElementById('bottomNav');
            if (state.currentUser && ['home', 'events', 'swipe', 'matches', 'profile'].includes(state.currentPage)) {
                bottomNav.innerHTML = `
                    <div class="bottom-nav">
                        <button class="nav-item ${state.currentPage === 'home' ? 'active' : ''}" onclick="navigateTo('home')">
                            <i class="fas fa-home"></i>
                            <span>Home</span>
                        </button>
                        <button class="nav-item ${state.currentPage === 'events' ? 'active' : ''}" onclick="navigateTo('events')">
                            <i class="fas fa-calendar"></i>
                            <span>Events</span>
                        </button>
                        <button class="nav-item ${state.currentPage === 'swipe' ? 'active' : ''}" onclick="navigateTo('swipe')">
                            <i class="fas fa-users"></i>
                            <span>Connect</span>
                        </button>
                        <button class="nav-item ${state.currentPage === 'matches' ? 'active' : ''}" onclick="navigateTo('matches')">
                            <i class="fas fa-heart"></i>
                            <span>Matches</span>
                        </button>
                        <button class="nav-item ${state.currentPage === 'profile' ? 'active' : ''}" onclick="navigateTo('profile')">
                            <i class="fas fa-user"></i>
                            <span>Profile</span>
                        </button>
                    </div>
                `;
            } else {
                bottomNav.innerHTML = '';
            }
        }

        // ===== PAGE COMPONENTS =====
        function renderHomePage(container) {
            container.innerHTML = `
                <div class="hero-bg">
                    <svg>
                        <path d="M-100,150 Q200,100 600,250 Q800,300 1000,200" stroke="white" stroke-width="2" fill="none" />
                        <path d="M-50,400 Q300,350 700,450 Q900,500 1100,400" stroke="white" stroke-width="2" fill="none" />
                    </svg>
                </div>
                
                <div class="hero">
                    <h1>Meet people at events.<br><span class="text-gradient">In real time.</span></h1>
                    <p class="hero-subtitle">Scan the QR code at any event to see who's there and connect instantly. No more guessing, no more missed connections.</p>
                    
                    <div class="cta-grid">
                        ${state.currentUser ? 
                            `<button class="btn btn-primary btn-large" onclick="joinEvent(${state.events[0].id})">
                                <i class="fas fa-qrcode"></i> Join Event Demo
                            </button>
                            ${!state.isPro ? `
                                <button class="btn btn-pro btn-large" onclick="showProModal()">
                                    <i class="fas fa-crown"></i> Upgrade to Pro
                                </button>
                            ` : ''}` :
                            `<button class="btn btn-primary btn-large" onclick="navigateTo('auth')">
                                <i class="fas fa-user-plus"></i> Get Started Free
                            </button>
                            <button class="btn btn-glass btn-large" onclick="demoLogin()">
                                <i class="fas fa-play-circle"></i> Try Demo
                            </button>`
                        }
                    </div>
                </div>
                
                <div class="features-grid">
                    ${[
                        { icon: 'fa-qrcode', title: 'Scan & Check In', desc: 'Scan the event QR code to check in' },
                        { icon: 'fa-camera', title: 'Live Photo', desc: 'Verify you\'re really there with a live selfie' },
                        { icon: 'fa-heart', title: 'Swipe & Match', desc: 'Swipe right on people you like' },
                        { icon: 'fa-comments', title: 'Chat & Connect', desc: 'Message matches and meet in person' }
                    ].map(feature => `
                        <div class="feature">
                            <div class="feature-icon">
                                <i class="fas ${feature.icon}"></i>
                            </div>
                            <h3>${feature.title}</h3>
                            <p>${feature.desc}</p>
                        </div>
                    `).join('')}
                </div>
                
                <div class="events-section">
                    <h2 class="text-center mb-4">Upcoming Events</h2>
                    <p class="text-center text-gray-400 mb-12">Join an event near you</p>
                    
                    <div class="events-grid">
                        ${state.events.map(event => `
                            <div class="event-card" onclick="viewEvent(${event.id})" style="cursor: pointer;">
                                <h3 class="mb-3">${event.name}</h3>
                                <div class="event-info">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>${event.location}</span>
                                </div>
                                <div class="event-info">
                                    <i class="fas fa-calendar"></i>
                                    <span>${event.date} â€¢ ${event.time}</span>
                                </div>
                                <div class="event-info">
                                    <i class="fas fa-users"></i>
                                    <span>${event.attendees} / ${event.maxAttendees} attending</span>
                                </div>
                                <button class="btn btn-primary btn-block mt-4">
                                    Join Event
                                </button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderAuthPage(container) {
            container.innerHTML = `
                <div class="auth-container">
                    <h2 class="text-center mb-5">Welcome to SparkPlug</h2>
                    
                    <div class="card">
                        <div class="auth-tabs">
                            <button class="auth-tab active" onclick="switchAuthTab('login')">Sign In</button>
                            <button class="auth-tab" onclick="switchAuthTab('signup')">Sign Up</button>
                        </div>
                        
                        <form id="authForm" onsubmit="handleAuth(event)">
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" placeholder="you@example.com" value="demo@sparkplug.app" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Password</label>
                                <input type="password" class="form-control" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" value="password" required minlength="6">
                            </div>
                            
                            <div id="signupFields" class="hidden">
                                <div class="form-group">
                                    <label class="form-label">Full Name</label>
                                    <input type="text" class="form-control" placeholder="Alex Johnson">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Age</label>
                                    <input type="number" class="form-control" placeholder="24" min="18" max="100">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Phone Number</label>
                                    <input type="tel" class="form-control" placeholder="+264 81 123 4567">
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-primary btn-block mt-4">
                                <i class="fas fa-sign-in-alt"></i> Continue
                            </button>
                        </form>
                        
                        <div class="text-center mt-4">
                            <button class="btn btn-outline btn-block" onclick="demoLogin()">
                                <i class="fas fa-rocket"></i> Continue as Demo User
                            </button>
                        </div>
                        
                        <div class="text-xs text-gray-400 text-center mt-4 p-3 bg-gray-900/50 rounded-lg">
                            Demo credentials pre-filled. Just click "Continue"!
                        </div>
                    </div>
                </div>
            `;
        }

        function renderDashboardPage(container) {
            container.innerHTML = `
                <div class="profile-header">
                    <div class="avatar ${state.isPro ? 'pro' : ''}"></div>
                    <h2>${state.currentUser?.name || 'Demo User'}</h2>
                    <p class="text-gradient">${state.currentUser?.email || 'demo@sparkplug.app'}</p>
                    ${state.isPro ? 
                        '<div class="pro-badge mt-2"><i class="fas fa-crown"></i> PRO MEMBER</div>' : 
                        '<div class="free-badge mt-2"><i class="fas fa-user"></i> FREE MEMBER</div>'
                    }
                </div>
                
                <h3 class="mb-3">Quick Actions</h3>
                <div class="quick-actions">
                    <div class="action-card" onclick="${state.isPro ? "navigateTo('create-event')" : "showProModal()"}">
                        <i class="fas fa-plus-circle"></i>
                        <h4>Create Event</h4>
                        <p>${state.isPro ? 'Set up a new event' : 'Upgrade to Pro to create events'}</p>
                        ${!state.isPro ? '<div class="pro-badge mt-2">PRO</div>' : ''}
                    </div>
                    
                    <div class="action-card" onclick="navigateTo('scanner')">
                        <i class="fas fa-qrcode"></i>
                        <h4>Scan QR</h4>
                        <p>Join an event</p>
                    </div>
                    
                    <div class="action-card" onclick="navigateTo('events')">
                        <i class="fas fa-calendar"></i>
                        <h4>My Events</h4>
                        <p>View your events</p>
                    </div>
                    
                    <div class="action-card" onclick="navigateTo('matches')">
                        <i class="fas fa-heart"></i>
                        <h4>Matches</h4>
                        <p>${state.matches.length} matches</p>
                    </div>
                </div>
                
                <h3 class="mt-5 mb-3">Active Events Nearby</h3>
                <div id="activeEvents">
                    ${state.events.slice(0, 2).map(event => `
                        <div class="card mb-3" onclick="viewEvent(${event.id})" style="cursor: pointer;">
                            <div class="flex justify-between items-center">
                                <div>
                                    <h4>${event.name}</h4>
                                    <p><i class="fas fa-map-marker-alt"></i> ${event.location}</p>
                                </div>
                                <div class="text-right">
                                    <div class="text-gradient font-bold">${event.attendees} people</div>
                                    <p class="text-sm">${event.date}</p>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function renderScannerPage(container) {
            container.innerHTML = `
                <div class="scanner-container">
                    <h2 class="text-center">Scan Event QR Code</h2>
                    <p class="text-center mt-2">Point your camera at the event QR code to join</p>
                    
                    <div class="qr-scanner" id="qrScanner">
                        <div class="scanner-overlay"></div>
                        <div class="scanner-line"></div>
                    </div>
                    
                    <button class="btn btn-primary btn-block mt-4" onclick="startCameraScanning()">
                        <i class="fas fa-camera"></i> Start Scanner
                    </button>
                    
                    <button class="btn btn-outline btn-block mt-2" onclick="enterCodeManually()">
                        <i class="fas fa-keyboard"></i> Enter Code Manually
                    </button>
                    
                    <div class="card-glass mt-4">
                        <div class="flex items-center gap-3">
                            <i class="fas fa-info-circle text-gradient"></i>
                            <p>Camera and location access required. You must be at the event location to join.</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderSwipePage(container) {
            if (!state.currentEvent) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-calendar-times" style="font-size: 64px; color: var(--gray-600); margin-bottom: 16px;"></i>
                        <h3 class="mb-2">No Active Event</h3>
                        <p class="text-gray-400 mb-6">Join an event first to start connecting with people</p>
                        <button class="btn btn-primary" onclick="navigateTo('events')">
                            <i class="fas fa-calendar"></i> Browse Events
                        </button>
                    </div>
                `;
                return;
            }
            
            const availableProfiles = MOCK_PROFILES.filter(p => 
                !state.swipeHistory.some(s => s.profile.id === p.id)
            );
            
            const currentProfile = availableProfiles[0];
            
            if (!currentProfile) {
                container.innerHTML = `
                    <div class="swipe-interface">
                        <div class="swipe-header">
                            <div class="event-badge">
                                ${state.currentEvent.name} â€¢ No more profiles
                            </div>
                        </div>
                        
                        <div class="card-stack">
                            <div class="text-center text-white">
                                <i class="fas fa-users" style="font-size: 64px; color: var(--gray-600); margin-bottom: 16px;"></i>
                                <h3 class="text-2xl font-bold mb-2">No more profiles</h3>
                                <p class="text-gray-400 mb-6">Check back soon for new arrivals!</p>
                                <button class="btn btn-primary" onclick="resetSwipes()">
                                    <i class="fas fa-redo"></i> Refresh
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                return;
            }
            
            const swipeCountText = state.isPro ? 'Unlimited swipes' : `${10 - state.swipeCount} swipes remaining today`;
            
            container.innerHTML = `
                <div class="swipe-interface">
                    <div class="for-you-bg">FOR YOU</div>
                    
                    <div class="swipe-header">
                        <div class="event-badge">
                            ${state.currentEvent.name} â€¢ ${availableProfiles.length} left
                        </div>
                    </div>
                    
                    <div class="card-stack">
                        <div class="card-container">
                            <div class="profile-card" id="profileCard${currentProfile.id}">
                                <div class="card-content">
                                    <div class="profile-image" style="background-image: url('${currentProfile.livePhoto}');">
                                        <div class="live-photo-badge">
                                            <i class="fas fa-camera"></i>
                                            <span>LIVE PHOTO</span>
                                        </div>
                                    </div>
                                    <div class="profile-info">
                                        <div class="flex justify-between items-start mb-4">
                                            <div>
                                                <h2>${currentProfile.name}, ${currentProfile.age}</h2>
                                                <p class="text-gray-400">
                                                    <i class="fas fa-map-marker-alt"></i> ${currentProfile.location}
                                                </p>
                                            </div>
                                            ${currentProfile.online ? `
                                                <span class="status-online flex items-center gap-1">
                                                    <i class="fas fa-circle" style="font-size: 10px;"></i>
                                                    <span>Online</span>
                                                </span>
                                            ` : ''}
                                        </div>
                                        
                                        <p class="mb-4">${currentProfile.bio}</p>
                                        
                                        <div class="interests mb-6">
                                            ${currentProfile.interests.map(interest => `
                                                <span class="interest-tag">${interest}</span>
                                            `).join('')}
                                        </div>
                                        
                                        <div class="text-center text-gray-400 text-sm">
                                            <i class="fas fa-shield-alt"></i>
                                            <span>Verified attendee at ${state.currentEvent.name}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="swipe-actions">
                        <button class="action-button" onclick="swipeLeft()" ${!state.isPro && state.swipeCount >= 10 ? 'disabled' : ''}>
                            <i class="fas fa-times"></i>
                        </button>
                        
                        <button class="action-button undo" onclick="undoSwipe()" ${state.swipeHistory.length === 0 ? 'disabled' : ''}>
                            <i class="fas fa-redo"></i>
                        </button>
                        
                        <button class="action-button like" onclick="swipeRight()" ${!state.isPro && state.swipeCount >= 10 ? 'disabled' : ''}>
                            <i class="fas fa-heart"></i>
                        </button>
                    </div>
                    
                    <div class="text-center text-gray-400 px-4 pb-4">
                        <p>${swipeCountText}</p>
                        ${!state.isPro && state.swipeCount >= 9 ? `
                            <button class="btn btn-pro btn-small mt-2" onclick="showProModal()">
                                <i class="fas fa-crown"></i> Upgrade for unlimited
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
            
            // Initialize drag
            initializeSwipeGestures();
        }

        function renderEventsPage(container) {
            container.innerHTML = `
                <h2 class="mb-4">Events</h2>
                
                ${state.currentUser && state.isPro ? `
                    <div class="card mb-4">
                        <div class="flex justify-between items-center">
                            <div>
                                <h3>Create New Event</h3>
                                <p class="text-gray-400">Set up a new event with QR code</p>
                            </div>
                            <button class="btn btn-primary" onclick="navigateTo('create-event')">
                                <i class="fas fa-plus"></i> Create
                            </button>
                        </div>
                    </div>
                ` : ''}
                
                <h3 class="mb-3">Active Events</h3>
                <div class="events-grid">
                    ${state.events.map(event => `
                        <div class="event-card" onclick="viewEvent(${event.id})" style="cursor: pointer;">
                            <h3 class="mb-3">${event.name}</h3>
                            <div class="event-info">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${event.location}</span>
                            </div>
                            <div class="event-info">
                                <i class="fas fa-calendar"></i>
                                <span>${event.date} â€¢ ${event.time}</span>
                            </div>
                            <div class="event-info">
                                <i class="fas fa-users"></i>
                                <span>${event.attendees} / ${event.maxAttendees} attending</span>
                            </div>
                            <button class="btn btn-primary btn-block mt-4">
                                View Details
                            </button>
                        </div>
                    `).join('')}
                </div>
                
                <h3 class="mt-6 mb-3">Your Events</h3>
                ${state.currentUser && state.events.filter(e => e.organizerId === state.currentUser.id).length > 0 ? 
                    state.events.filter(e => e.organizerId === state.currentUser.id).map(event => `
                        <div class="card mb-3">
                            <div class="flex justify-between items-center">
                                <div>
                                    <h4>${event.name}</h4>
                                    <p class="text-gray-400">
                                        <i class="fas fa-map-marker-alt"></i> ${event.location}
                                    </p>
                                </div>
                                <button class="btn btn-outline" onclick="navigateTo('manage-event')">
                                    Manage
                                </button>
                            </div>
                        </div>
                    `).join('') :
                    '<p class="text-gray-400 text-center py-4">You haven\'t created any events yet.</p>'
                }
            `;
        }

        function renderMatchesPage(container) {
            container.innerHTML = `
                <h2 class="mb-4">Your Matches</h2>
                
                ${state.matches.length > 0 ? `
                    <div class="attendee-list">
                        ${state.matches.map(match => `
                            <div class="attendee-item" onclick="openChat('${match.id}')" style="cursor: pointer;">
                                <div class="attendee-avatar" style="background-image: url('${match.livePhoto}');"></div>
                                <div class="attendee-info">
                                    <h4>${match.name}, ${match.age}</h4>
                                    <p class="text-gray-400">Matched at ${state.currentEvent?.name || 'Event'}</p>
                                </div>
                                <div class="attendee-status status-online">
                                    <i class="fas fa-circle" style="font-size: 8px;"></i>
                                    <span>Online</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : `
                    <div class="text-center py-12">
                        <i class="fas fa-heart" style="font-size: 64px; color: var(--gray-600); margin-bottom: 16px;"></i>
                        <h3 class="mb-2">No Matches Yet</h3>
                        <p class="text-gray-400 mb-6">Start swiping at an event to get matches!</p>
                        <button class="btn btn-primary" onclick="navigateTo('events')">
                            <i class="fas fa-calendar"></i> Find Events
                        </button>
                    </div>
                `}
            `;
        }

        function renderProfilePage(container) {
            const remainingSwipes = state.isPro ? 'âˆž' : Math.max(0, 10 - state.swipeCount);
            
            container.innerHTML = `
                <div class="profile-header">
                    <div class="avatar ${state.isPro ? 'pro' : ''}">
                        ${state.userLivePhoto ? 
                            `<img src="${state.userLivePhoto}" style="width: 100%; height: 100%; object-fit: cover;">` : 
                            ''
                        }
                    </div>
                    <h2>${state.currentUser?.name || 'Demo User'}</h2>
                    <p class="text-gradient">${state.currentUser?.email || 'demo@sparkplug.app'}</p>
                    
                    <div class="flex gap-3 mt-4">
                        ${state.isPro ? 
                            '<div class="pro-badge"><i class="fas fa-crown"></i> PRO MEMBER</div>' : 
                            '<div class="free-badge"><i class="fas fa-user"></i> FREE MEMBER</div>'
                        }
                        <div class="pro-badge" style="background: var(--bg-tertiary); color: var(--gray-300);">
                            <i class="fas fa-heart"></i>
                            <span>${remainingSwipes} swipes today</span>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <h3 class="mb-4">Account Settings</h3>
                    <div class="flex flex-col gap-3">
                        <button class="btn btn-outline" onclick="editProfile()">
                            <i class="fas fa-edit"></i> Edit Profile
                        </button>
                        <button class="btn btn-outline" onclick="showNotificationSettings()">
                            <i class="fas fa-bell"></i> Notifications
                        </button>
                        <button class="btn btn-outline" onclick="showPrivacySettings()">
                            <i class="fas fa-shield-alt"></i> Privacy & Security
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <h3 class="mb-4">Subscription</h3>
                    ${state.isPro ? `
                        <div class="mb-4">
                            <div class="pro-badge mb-2"><i class="fas fa-crown"></i> PRO PLAN ACTIVE</div>
                            <p class="text-gray-400">Your Pro subscription includes unlimited swipes, event creation, and premium features.</p>
                        </div>
                        <button class="btn btn-outline btn-block" onclick="manageSubscription()">
                            <i class="fas fa-cog"></i> Manage Subscription
                        </button>
                    ` : `
                        <div class="mb-4">
                            <div class="free-badge mb-2"><i class="fas fa-user"></i> FREE PLAN</div>
                            <p class="text-gray-400 mb-4">Upgrade to Pro for unlimited swipes, event creation, and premium features.</p>
                            <button class="btn btn-pro btn-block" onclick="showProModal()">
                                <i class="fas fa-crown"></i> Upgrade to Pro
                            </button>
                        </div>
                    `}
                </div>
                
                <div class="card mt-4">
                    <button class="btn btn-outline btn-block text-red-400" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Log Out
                    </button>
                </div>
            `;
        }

        function renderCreateEventPage(container) {
            if (!state.isPro) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-crown" style="font-size: 64px; color: var(--gray-600); margin-bottom: 16px;"></i>
                        <h3 class="mb-2">Pro Feature Required</h3>
                        <p class="text-gray-400 mb-6">Upgrade to Pro to create events</p>
                        <button class="btn btn-pro" onclick="showProModal()">
                            <i class="fas fa-crown"></i> Upgrade to Pro
                        </button>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = `
                <div class="create-form">
                    <h2 class="text-center mb-4">Create New Event</h2>
                    
                    <div class="card">
                        <form id="createEventForm" onsubmit="createEvent(event)">
                            <div class="form-group">
                                <label class="form-label">Event Name</label>
                                <input type="text" class="form-control" placeholder="Tech Meetup Afterparty" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" rows="3" placeholder="Describe your event..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Location Name</label>
                                <input type="text" class="form-control" placeholder="Downtown Bar & Grill" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Event Duration (hours)</label>
                                <input type="number" class="form-control" min="1" max="24" value="4" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Max Attendees</label>
                                <input type="number" class="form-control" min="10" max="1000" value="50" required>
                            </div>
                            
                            <div class="card-glass mb-4">
                                <div class="flex items-center gap-3">
                                    <i class="fas fa-info-circle text-gradient"></i>
                                    <p>QR code will be generated after event creation. Print and display it at your event.</p>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-primary btn-block">
                                <i class="fas fa-plus"></i> Create Event
                            </button>
                        </form>
                    </div>
                    
                    <div class="card mt-4" id="qrDisplay" style="display: none;">
                        <h3 class="text-center mb-3">Your Event QR Code</h3>
                        <div class="qr-code-display" id="qrCodeDisplay">
                            Loading QR...
                        </div>
                        <p class="text-center mt-3">Print and display this QR code at your event venue</p>
                        <button class="btn btn-outline btn-block mt-3" onclick="printQR()">
                            <i class="fas fa-print"></i> Print QR Code
                        </button>
                    </div>
                </div>
            `;
        }

        function renderManageEventPage(container) {
            if (!state.currentEvent) {
                navigateTo('events');
                return;
            }
            
            container.innerHTML = `
                <div class="mb-6">
                    <div class="card mb-4">
                        <div class="flex justify-between items-center mb-4">
                            <h2>Manage Event</h2>
                            <span class="pro-badge">${state.currentEvent.attendees} Active</span>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="card-glass text-center">
                                <div class="text-2xl font-bold mb-1">${state.currentEvent.attendees}</div>
                                <div class="text-gray-400 text-sm">Total Attendees</div>
                            </div>
                            <div class="card-glass text-center">
                                <div class="text-2xl font-bold mb-1">${state.matches.length}</div>
                                <div class="text-gray-400 text-sm">Matches Made</div>
                            </div>
                            <div class="card-glass text-center">
                                <div class="text-2xl font-bold mb-1">${Object.values(state.chatMessages).flat().length}</div>
                                <div class="text-gray-400 text-sm">Messages Sent</div>
                            </div>
                            <div class="card-glass text-center">
                                <div class="text-2xl font-bold mb-1">${state.currentEvent.radius}m</div>
                                <div class="text-gray-400 text-sm">Geofence Radius</div>
                            </div>
                        </div>
                        
                        <div class="flex gap-3">
                            <button class="btn btn-primary flex-1" onclick="refreshAttendees()">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                            <button class="btn btn-secondary" onclick="exportAttendeeData()">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                    </div>
                    
                    <h3 class="mb-4">Active Attendees</h3>
                    <div class="attendee-list" id="attendeeList">
                        ${state.attendees.map(profile => `
                            <div class="attendee-item">
                                <div class="attendee-avatar" style="background-image: url('${profile.livePhoto}');"></div>
                                <div class="attendee-info">
                                    <h4>${profile.name}, ${profile.age}</h4>
                                    <p class="text-gray-400 text-sm">${profile.location}</p>
                                </div>
                                <div class="attendee-status ${profile.online ? 'status-online' : 'status-away'}">
                                    <i class="fas fa-circle" style="font-size: 8px;"></i>
                                    <span>${profile.online ? 'Online' : 'Away'}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderEventDetailPage(container) {
            if (!state.currentEvent) {
                navigateTo('events');
                return;
            }
            
            container.innerHTML = `
                <div class="mb-6">
                    <div class="card mb-4">
                        <h2 class="mb-2">${state.currentEvent.name}</h2>
                        <div class="flex flex-col gap-2 mb-4">
                            <div class="flex items-center gap-2 text-gray-400">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${state.currentEvent.location}</span>
                            </div>
                            <div class="flex items-center gap-2 text-gray-400">
                                <i class="fas fa-clock"></i>
                                <span>${state.currentEvent.date} â€¢ ${state.currentEvent.time}</span>
                            </div>
                            <div class="flex items-center gap-2 text-gray-400">
                                <i class="fas fa-users"></i>
                                <span>${state.currentEvent.attendees} / ${state.currentEvent.maxAttendees} attendees</span>
                            </div>
                        </div>
                        
                        <p class="mb-6">${state.currentEvent.description}</p>
                        
                        <div class="flex gap-3">
                            <button class="btn btn-primary flex-1" onclick="joinEvent()">
                                <i class="fas fa-qrcode"></i> Join Event
                            </button>
                            ${state.currentUser?.id === state.currentEvent.organizerId ? `
                                <button class="btn btn-outline" onclick="navigateTo('manage-event')">
                                    <i class="fas fa-chart-line"></i> Manage
                                </button>
                            ` : ''}
                        </div>
                    </div>
                    
                    ${state.currentUser?.id === state.currentEvent.organizerId ? `
                        <div class="card">
                            <h3 class="mb-4">Event QR Code</h3>
                            <div class="text-center mb-4">
                                <div class="qr-code-display" style="margin: 0 auto;">
                                    ${state.currentEvent.qrCode}
                                </div>
                            </div>
                            <p class="text-center text-gray-400">Display this code at your event for attendees to scan</p>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function renderChatPage(container) {
            const matchId = state.currentPage.split('-')[1];
            const match = state.matches.find(m => m.id === parseInt(matchId));
            
            if (!match) {
                navigateTo('matches');
                return;
            }
            
            const messages = state.chatMessages[matchId] || [];
            
            container.innerHTML = `
                <div class="chat-container">
                    <div class="chat-header">
                        <button class="back-btn" onclick="navigateTo('matches')">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <div class="chat-avatar" style="background-image: url('${match.livePhoto}'); background-size: cover;"></div>
                        <div>
                            <h3>${match.name}</h3>
                            <p class="text-sm text-gradient">Active now at ${state.currentEvent?.name || 'Event'}</p>
                        </div>
                    </div>
                    
                    <div class="chat-messages" id="chatMessages">
                        ${messages.length > 0 ? messages.map(msg => `
                            <div class="message ${msg.sender === 'user' ? 'sent' : 'received'}">
                                ${msg.text}
                                <div class="message-time">${msg.time}</div>
                            </div>
                        `).join('') : `
                            <div class="message received">
                                Hey there! Saw you at the event ðŸ‘‹
                                <div class="message-time">2:30 PM</div>
                            </div>
                            <div class="message sent">
                                Hi! Yeah, it's been great so far!
                                <div class="message-time">2:31 PM</div>
                            </div>
                        `}
                    </div>
                    
                    <div class="chat-input">
                        <input type="text" id="messageInput" placeholder="Type a message..." onkeypress="handleMessageKeypress(event)" class="form-control">
                        <button class="btn btn-primary btn-icon" onclick="sendMessage('${matchId}')">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            `;
        }

        // ===== DRAG & SWIPE FUNCTIONALITY =====
        function initializeSwipeGestures() {
            const availableProfiles = MOCK_PROFILES.filter(p => 
                !state.swipeHistory.some(s => s.profile.id === p.id)
            );
            
            if (availableProfiles.length === 0) return;
            
            const currentProfile = availableProfiles[0];
            const card = document.getElementById(`profileCard${currentProfile.id}`);
            if (!card) return;
            
            let startX, startY, moveX, moveY;
            
            card.addEventListener('touchstart', e => {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
            }, { passive: true });
            
            card.addEventListener('touchmove', e => {
                if (!startX || !startY) return;
                
                moveX = e.touches[0].clientX;
                moveY = e.touches[0].clientY;
                
                const diffX = moveX - startX;
                const diffY = moveY - startY;
                
                if (Math.abs(diffX) > Math.abs(diffY)) {
                    e.preventDefault();
                    card.style.transform = `translateX(${diffX}px) rotate(${diffX * 0.1}deg)`;
                    card.style.opacity = 1 - Math.abs(diffX) / 300;
                }
            }, { passive: false });
            
            card.addEventListener('touchend', () => {
                if (!startX || !moveX) return;
                
                const diffX = moveX - startX;
                const threshold = 100;
                
                if (Math.abs(diffX) > threshold) {
                    if (diffX > 0) {
                        swipeRight();
                    } else {
                        swipeLeft();
                    }
                } else {
                    card.style.transform = '';
                    card.style.opacity = '';
                }
                
                startX = startY = moveX = moveY = null;
            });
            
            // Mouse events for desktop
            card.addEventListener('mousedown', e => {
                startX = e.clientX;
                startY = e.clientY;
                card.style.cursor = 'grabbing';
            });
            
            document.addEventListener('mousemove', e => {
                if (!startX || !startY) return;
                
                moveX = e.clientX;
                moveY = e.clientY;
                const diffX = moveX - startX;
                
                if (Math.abs(diffX) > 10) {
                    card.style.transform = `translateX(${diffX}px) rotate(${diffX * 0.1}deg)`;
                    card.style.opacity = 1 - Math.abs(diffX) / 300;
                }
            });
            
            document.addEventListener('mouseup', () => {
                if (!startX || !moveX) return;
                
                const diffX = moveX - startX;
                const threshold = 100;
                
                if (Math.abs(diffX) > threshold) {
                    if (diffX > 0) {
                        swipeRight();
                    } else {
                        swipeLeft();
                    }
                } else {
                    card.style.transform = '';
                    card.style.opacity = '';
                }
                
                startX = startY = moveX = moveY = null;
                card.style.cursor = 'grab';
            });
        }

        // ===== EVENT HANDLERS =====
        function switchAuthTab(tab) {
            const tabs = document.querySelectorAll('.auth-tab');
            const signupFields = document.getElementById('signupFields');
            const formButton = document.querySelector('#authForm button[type="submit"]');
            
            tabs.forEach(t => t.classList.remove('active'));
            tabs[tab === 'login' ? 0 : 1].classList.add('active');
            
            if (tab === 'signup') {
                signupFields.classList.remove('hidden');
                formButton.innerHTML = '<i class="fas fa-user-plus"></i> Create Account';
            } else {
                signupFields.classList.add('hidden');
                formButton.innerHTML = '<i class="fas fa-sign-in-alt"></i> Sign In';
            }
        }

        function handleAuth(event) {
            event.preventDefault();
            const form = event.target;
            const email = form.querySelector('input[type="email"]').value;
            const password = form.querySelector('input[type="password"]').value;
            
            const isSignup = form.querySelector('#signupFields').classList.contains('hidden') === false;
            
            state.currentUser = {
                id: 'user_' + Date.now(),
                name: isSignup ? (form.querySelector('input[type="text"]')?.value || email.split('@')[0]) : email.split('@')[0],
                email: email,
                isPro: false
            };
            
            if (isSignup) {
                const age = form.querySelector('input[type="number"]')?.value;
                const phone = form.querySelector('input[type="tel"]')?.value;
                
                if (age) state.currentUser.age = parseInt(age);
                if (phone) state.currentUser.phone = phone;
            }
            
            localStorage.setItem('sparkplug_user', JSON.stringify(state.currentUser));
            localStorage.setItem('sparkplug_isPro', state.isPro);
            localStorage.setItem('sparkplug_swipeCount', state.swipeCount);
            localStorage.setItem('sparkplug_lastSwipeReset', state.lastSwipeReset);
            
            showNotification('Welcome to SparkPlug! âš¡', 'success');
            setTimeout(() => navigateTo('home'), 1000);
        }

        function demoLogin() {
            state.currentUser = {
                id: 'demo_user',
                name: 'Demo User',
                email: 'demo@sparkplug.app',
                isPro: false
            };
            
            state.isPro = false;
            
            localStorage.setItem('sparkplug_user', JSON.stringify(state.currentUser));
            localStorage.setItem('sparkplug_isPro', state.isPro);
            
            showNotification('Welcome to SparkPlug Demo! âš¡', 'success');
            navigateTo('home');
        }

        function joinEvent(eventId) {
            if (!state.currentUser) {
                navigateTo('auth');
                return;
            }
            
            const event = eventId ? state.events.find(e => e.id === eventId) : state.currentEvent;
            if (event) {
                state.currentEvent = event;
                showNotification(`Joining ${event.name}... ðŸŽ‰`, 'success');
                
                state.currentProfileIndex = 0;
                state.swipeHistory = [];
                
                setTimeout(() => {
                    navigateTo('scanner');
                }, 1000);
            }
        }

        function viewEvent(eventId) {
            const event = state.events.find(e => e.id === eventId);
            if (event) {
                state.currentEvent = event;
                navigateTo('event-detail');
            }
        }

        async function startCameraScanning() {
            showNotification('Starting camera... Please allow camera access', 'info');
            
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: { facingMode: 'environment' }
                });
                
                state.cameraStream = stream;
                const scannerView = document.getElementById('qrScanner');
                scannerView.innerHTML = `
                    <video style="width: 100%; height: 100%; object-fit: cover;" autoplay playsinline></video>
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 200px; height: 200px; border: 2px solid var(--primary); border-radius: var(--radius);"></div>
                `;
                
                const video = scannerView.querySelector('video');
                video.srcObject = stream;
                
                setTimeout(() => {
                    showNotification('QR Code scanned successfully!', 'success');
                    stopCamera();
                    
                    setTimeout(() => openCameraForSelfie(), 1000);
                }, 2000);
                
            } catch (error) {
                showNotification('Camera access denied. Please enable camera permissions.', 'error');
                setTimeout(() => {
                    showNotification('Simulating QR scan for demo...', 'info');
                    setTimeout(() => openCameraForSelfie(), 1000);
                }, 2000);
            }
        }

        function stopCamera() {
            if (state.cameraStream) {
                state.cameraStream.getTracks().forEach(track => track.stop());
                state.cameraStream = null;
            }
        }

        async function openCameraForSelfie() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: { 
                        facingMode: state.facingMode,
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    }
                });
                
                state.cameraStream = stream;
                const cameraModal = document.getElementById('cameraModal');
                const video = document.getElementById('cameraVideo');
                
                video.srcObject = stream;
                cameraModal.style.display = 'flex';
                
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        position => {
                            console.log('Location captured:', position.coords);
                        },
                        error => {
                            showNotification('Location access required for verification', 'warning');
                        }
                    );
                }
                
            } catch (error) {
                showNotification('Camera access denied. Please enable camera permissions.', 'error');
            }
        }

        function closeCamera() {
            stopCamera();
            document.getElementById('cameraModal').style.display = 'none';
        }

        function switchCamera() {
            state.facingMode = state.facingMode === 'user' ? 'environment' : 'user';
            closeCamera();
            setTimeout(() => openCameraForSelfie(), 100);
        }

        function takePhoto() {
            const video = document.getElementById('cameraVideo');
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            const photoData = canvas.toDataURL('image/jpeg', 0.8);
            state.userLivePhoto = photoData;
            
            verifyLocationAndProceed(photoData);
        }

        function verifyLocationAndProceed(photoData) {
            showNotification('Verifying your location...', 'info');
            
            setTimeout(() => {
                closeCamera();
                showNotification('Verified! Welcome to the event.', 'success');
                
                setTimeout(() => navigateTo('swipe'), 1000);
            }, 1500);
        }

        function swipeLeft() {
            if (!state.isPro && state.swipeCount >= 10) {
                showProModal();
                return;
            }
            
            const availableProfiles = MOCK_PROFILES.filter(p => 
                !state.swipeHistory.some(s => s.profile.id === p.id)
            );
            
            if (availableProfiles.length === 0) return;
            
            const profile = availableProfiles[0];
            state.swipeHistory.push({ profile, action: 'reject' });
            state.swipeCount++;
            
            showNotification(`Passed on ${profile.name}`);
            
            localStorage.setItem('sparkplug_swipeCount', state.swipeCount);
            localStorage.setItem('sparkplug_swipeHistory', JSON.stringify(state.swipeHistory));
            
            setTimeout(() => renderSwipePage(document.getElementById('content')), 300);
        }

        function swipeRight() {
            if (!state.isPro && state.swipeCount >= 10) {
                showProModal();
                return;
            }
            
            const availableProfiles = MOCK_PROFILES.filter(p => 
                !state.swipeHistory.some(s => s.profile.id === p.id)
            );
            
            if (availableProfiles.length === 0) return;
            
            const profile = availableProfiles[0];
            state.swipeHistory.push({ profile, action: 'like' });
            state.swipeCount++;
            
            if (Math.random() < 0.4) {
                state.matches.push({...profile, matchId: Date.now()});
                state.lastMatch = profile;
                setTimeout(() => showMatchModal(), 400);
                showNotification(`It's a match with ${profile.name}! ðŸ’«`, 'success');
            } else {
                showNotification(`Liked ${profile.name} â¤ï¸`);
            }
            
            localStorage.setItem('sparkplug_swipeCount', state.swipeCount);
            localStorage.setItem('sparkplug_swipeHistory', JSON.stringify(state.swipeHistory));
            localStorage.setItem('sparkplug_matches', JSON.stringify(state.matches));
            
            setTimeout(() => renderSwipePage(document.getElementById('content')), 300);
        }

        function undoSwipe() {
            if (state.swipeHistory.length === 0) return;
            
            state.swipeHistory.pop();
            state.swipeCount = Math.max(0, state.swipeCount - 1);
            showNotification('Undid last swipe', 'info');
            
            localStorage.setItem('sparkplug_swipeCount', state.swipeCount);
            localStorage.setItem('sparkplug_swipeHistory', JSON.stringify(state.swipeHistory));
            
            renderSwipePage(document.getElementById('content'));
        }

        function resetSwipes() {
            state.currentProfileIndex = 0;
            state.swipeHistory = [];
            renderSwipePage(document.getElementById('content'));
        }

        function showMatchModal() {
            const modal = document.getElementById('matchModal');
            const matchAvatar = document.getElementById('matchAvatar');
            const userAvatar = document.getElementById('userAvatar');
            const matchMessage = document.getElementById('matchMessage');
            
            if (modal && state.lastMatch) {
                matchAvatar.style.backgroundImage = `url('${state.lastMatch.livePhoto}')`;
                matchAvatar.style.backgroundSize = 'cover';
                userAvatar.style.background = 'linear-gradient(135deg, var(--primary), var(--primary-light))';
                matchMessage.textContent = `You and ${state.lastMatch.name} liked each other`;
                modal.style.display = 'flex';
                createConfetti();
            }
        }

        function closeMatchModal() {
            document.getElementById('matchModal').style.display = 'none';
        }

        function startChat() {
            closeMatchModal();
            if (state.lastMatch) {
                const matchId = state.lastMatch.id;
                navigateTo('chat-' + matchId);
            }
        }

        function openChat(matchId) {
            navigateTo('chat-' + matchId);
        }

        function sendMessage(matchId) {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message) {
                if (!state.chatMessages[matchId]) {
                    state.chatMessages[matchId] = [];
                }
                
                const now = new Date();
                const time = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
                
                state.chatMessages[matchId].push({
                    text: message,
                    time: time,
                    sender: 'user'
                });
                
                localStorage.setItem('sparkplug_chatMessages', JSON.stringify(state.chatMessages));
                
                input.value = '';
                renderChatPage(document.getElementById('content'));
                
                const chatMessages = document.getElementById('chatMessages');
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                setTimeout(() => {
                    const replies = [
                        'Sounds good!',
                        'Meet by the bar?',
                        'On my way!',
                        'Love that idea!',
                        'See you there! ðŸ‘‹'
                    ];
                    const reply = replies[Math.floor(Math.random() * replies.length)];
                    
                    state.chatMessages[matchId].push({
                        text: reply,
                        time: 'Just now',
                        sender: 'match'
                    });
                    
                    localStorage.setItem('sparkplug_chatMessages', JSON.stringify(state.chatMessages));
                    renderChatPage(document.getElementById('content'));
                    
                    const updatedChatMessages = document.getElementById('chatMessages');
                    updatedChatMessages.scrollTop = updatedChatMessages.scrollHeight;
                }, 1000 + Math.random() * 1000);
            }
        }

        function handleMessageKeypress(event) {
            if (event.key === 'Enter') {
                const matchId = state.currentPage.split('-')[1];
                sendMessage(matchId);
            }
        }

        function createEvent(event) {
            event.preventDefault();
            const form = event.target;
            const eventName = form.querySelector('input[type="text"]').value;
            const description = form.querySelector('textarea').value;
            const location = form.querySelectorAll('input[type="text"]')[1].value;
            const duration = form.querySelector('input[type="number"]').value;
            const maxAttendees = form.querySelectorAll('input[type="number"]')[1].value;
            
            const newEvent = {
                id: state.events.length + 1,
                name: eventName,
                description: description,
                location: location,
                date: 'Tomorrow',
                time: '7:00 PM - 11:00 PM',
                attendees: 0,
                maxAttendees: parseInt(maxAttendees),
                qrCode: 'EVENT_' + Math.random().toString(36).substr(2, 9).toUpperCase(),
                radius: 100,
                organizerId: state.currentUser.id
            };
            
            state.events.push(newEvent);
            
            showNotification(`Event "${eventName}" created successfully!`, 'success');
            
            setTimeout(() => {
                const qrDisplay = document.getElementById('qrDisplay');
                const qrCodeDisplay = document.getElementById('qrCodeDisplay');
                
                if (qrDisplay && qrCodeDisplay) {
                    qrDisplay.style.display = 'block';
                    qrCodeDisplay.textContent = newEvent.qrCode;
                    
                    qrDisplay.scrollIntoView({ behavior: 'smooth' });
                }
            }, 500);
        }

        function showProModal() {
            document.getElementById('proModal').style.display = 'flex';
        }

        function closeProModal() {
            document.getElementById('proModal').style.display = 'none';
        }

        function initiatePayPalPayment() {
            showNotification('Redirecting to PayPal...', 'info');
            setTimeout(() => {
                state.isPro = true;
                localStorage.setItem('sparkplug_isPro', true);
                showNotification('Pro upgrade successful! ðŸŽ‰', 'success');
                closeProModal();
                renderPage();
                updateNavigation();
            }, 1500);
        }

        function showMobileMoneyOptions() {
            showNotification('Mobile Money options: 1. MTC Mobile Money 2. TN Mobile 3. EcoCash', 'info');
        }

        function showBankTransfer() {
            showNotification('Bank transfer details: SparkPlug Ltd, Account: 123456789, Bank: Bank of Namibia', 'info');
        }

        function showCryptoOptions() {
            showNotification('Crypto payments accepted: BTC, ETH, USDT. Send to: 0x742d35Cc6634C0532925a3b844Bc9e...', 'info');
        }

        function refreshAttendees() {
            showNotification('Refreshing attendee list...', 'info');
            setTimeout(() => {
                showNotification('Attendee list updated', 'success');
            }, 1000);
        }

        function exportAttendeeData() {
            showNotification('Exporting attendee data...', 'info');
            setTimeout(() => {
                showNotification('Data exported successfully', 'success');
            }, 1500);
        }

        function enterCodeManually() {
            const code = prompt('Enter event code:');
            if (code) {
                showNotification('Code accepted! Opening camera for verification...', 'success');
                setTimeout(() => openCameraForSelfie(), 1000);
            }
        }

        function showMenuModal() {
            const modal = document.createElement('div');
            modal.className = 'menu-modal';
            modal.style.cssText = `
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 2000;
                backdrop-filter: blur(10px);
            `;
            
            modal.innerHTML = `
                <div class="card" style="max-width: 320px; width: 90%;">
                    <h2 class="mb-2">Menu</h2>
                    <p class="text-gray-400 mb-4">Hi, ${state.currentUser?.name || 'Guest'}!</p>
                    <div class="flex flex-col gap-3">
                        <button class="btn btn-outline" onclick="navigateTo('home'); this.closest('.menu-modal').remove()">
                            <i class="fas fa-calendar"></i> Browse Events
                        </button>
                        <button class="btn btn-outline" onclick="navigateTo('matches'); this.closest('.menu-modal').remove()">
                            <i class="fas fa-heart"></i> My Matches (${state.matches.length})
                        </button>
                        <button class="btn btn-outline" onclick="navigateTo('profile'); this.closest('.menu-modal').remove()">
                            <i class="fas fa-user"></i> Profile
                        </button>
                        <button class="btn btn-outline text-red-400" onclick="logout(); this.closest('.menu-modal').remove()">
                            <i class="fas fa-sign-out-alt"></i> Log Out
                        </button>
                    </div>
                </div>
            `;
            
            modal.onclick = (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            };
            
            document.body.appendChild(modal);
        }

        function logout() {
            state.currentUser = null;
            state.isPro = false;
            state.swipeCount = 0;
            state.matches = [];
            state.chatMessages = {};
            
            localStorage.removeItem('sparkplug_user');
            localStorage.removeItem('sparkplug_isPro');
            localStorage.removeItem('sparkplug_swipeCount');
            localStorage.removeItem('sparkplug_matches');
            localStorage.removeItem('sparkplug_chatMessages');
            
            showNotification('Successfully logged out', 'info');
            navigateTo('home');
        }

        function editProfile() {
            showNotification('Edit profile feature coming soon!', 'info');
        }

        function showNotificationSettings() {
            showNotification('Notification settings coming soon!', 'info');
        }

        function showPrivacySettings() {
            showNotification('Privacy settings coming soon!', 'info');
        }

        function manageSubscription() {
            showNotification('Subscription management coming soon!', 'info');
        }

        // ===== UTILITY FUNCTIONS =====
        function showNotification(message, type = 'info') {
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            
            const icon = type === 'success' ? 'fa-check-circle' : 
                        type === 'error' ? 'fa-exclamation-circle' : 
                        type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle';
            
            notification.innerHTML = `
                <i class="fas ${icon}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(100px)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }
            }, 3000);
        }

        function createConfetti() {
            const modal = document.getElementById('matchModal');
            if (!modal) return;
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.cssText = `
                    position: absolute;
                    width: ${Math.random() * 10 + 5}px;
                    height: ${Math.random() * 10 + 5}px;
                    background: hsl(${Math.random() * 360}, 100%, 70%);
                    border-radius: 50%;
                    top: 50%;
                    left: ${Math.random() * 100}%;
                    animation: confettiFall ${Math.random() * 2 + 1}s linear forwards;
                `;
                
                modal.appendChild(confetti);
                
                setTimeout(() => confetti.remove(), 3000);
            }
        }

        // ===== INITIALIZATION =====
        function init() {
            const savedUser = localStorage.getItem('sparkplug_user');
            const savedPro = localStorage.getItem('sparkplug_isPro');
            const savedSwipeCount = localStorage.getItem('sparkplug_swipeCount');
            const savedMatches = localStorage.getItem('sparkplug_matches');
            const savedChatMessages = localStorage.getItem('sparkplug_chatMessages');
            const savedSwipeHistory = localStorage.getItem('sparkplug_swipeHistory');
            
            if (savedUser) {
                state.currentUser = JSON.parse(savedUser);
            }
            
            if (savedPro) {
                state.isPro = savedPro === 'true';
            }
            
            if (savedSwipeCount) {
                state.swipeCount = parseInt(savedSwipeCount);
            }
            
            if (savedMatches) {
                state.matches = JSON.parse(savedMatches);
            }
            
            if (savedChatMessages) {
                state.chatMessages = JSON.parse(savedChatMessages);
            }
            
            if (savedSwipeHistory) {
                state.swipeHistory = JSON.parse(savedSwipeHistory);
            }
            
            const today = new Date().toDateString();
            if (localStorage.getItem('lastSwipeDate') !== today) {
                state.swipeCount = 0;
                localStorage.setItem('lastSwipeDate', today);
            }
            
            renderPage();
            updateNavigation();
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
